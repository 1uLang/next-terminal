(this["webpackJsonpnext-terminal"]=this["webpackJsonpnext-terminal"]||[]).push([[0],{1180:function(e,t,a){},1225:function(e,t,a){},1226:function(e,t,a){},1227:function(e,t,a){},1228:function(e,t,a){},1229:function(e,t,a){},1230:function(e,t,a){},1232:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(86),c=a.n(r),i=(a(700),a(11)),o=a(24),l=a(3),d=a(4),u=a(12),j=a(13),h=(a(701),a(702),a(1249)),b=a(405),p=a(1267),m=a(409),O=a(101),x=a(73),f=a(97),g=a(6),v=a(1245),y=a(1246),w=a(1261),k=a(1259),S=a(1270),C=a(1271),I=a(1272),T=a(1273),P=a(188),R=a.n(P);function F(){return{server:"",wsServer:("https:"===window.location.protocol?"wss:":"ws:")+window.location.host,prefix:window.location.protocol+"//"+window.location.host}}F();var q=F().server,D=F().wsServer,z=(F().prefix,a(672)),N=a(1),L=function(e){localStorage.setItem("X-Auth-Token",e)},V=function(){return localStorage.getItem("X-Auth-Token")},B=function(){return{"X-Auth-Token":V()}},M=function(e){return e%4===0&&e%100!==0||e%100===0&&e%400===0},K=function e(t,a){var n,s=t.constructor===Array?[]:{};if("object"===typeof t){if(window.JSON)n=JSON.stringify(t),s=JSON.parse(n);else for(var r in t)s[r]="object"===typeof t[r]?e(t[r]):t[r];return s}};function A(e){var t=document.createElement("a");t.setAttribute("download",""),t.setAttribute("href",e),t.click()}function W(e,t){for(var a=Math.floor((t.getTime()-e.getTime())/1e3),n=Math.floor(a/86400),s=e.getFullYear(),r=t.getFullYear(),c=0,i=s;i<r;i++)M(i)&&c++;var o,l=Math.floor((n-366*c)/365+c);o=n>366?(n-366*c)%365:n;var d=a%86400,u=Math.floor(d/3600),j=Math.floor(d%3600/60),h=d-60*u*60-60*j,b="";return l>0&&(b+=l+"\u5e74"),o>0&&(b+=o+"\u5929"),u>0&&(b+=u+"\u5c0f\u65f6"),j>0&&(b+=j+"\u5206\u949f"),h>0&&(b+=h+"\u79d2"),b}var E=function(e){return void 0===e||null==e||0===e.length},U=function(){var e=a(726);return{name:e.name,version:e.version}};function H(e){var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if("undefined"!==typeof window.ActiveXObject){var a=new window.ActiveXObject("WScript.Shell");null!==a&&a.SendKeys("{F11}")}}function G(){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.webkitExitFullscreen;if(e)e.call(document);else if("undefined"!==typeof window.ActiveXObject){var t=new window.ActiveXObject("WScript.Shell");null!==t&&t.SendKeys("{F11}")}}function J(e){if(null==e||""===e||0===e)return"0 Bytes";var t=parseFloat(e),a=Math.floor(Math.log(t)/Math.log(1024)),n=t/Math.pow(1024,a);return(n=n.toFixed(2))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}R.a.defaults.baseURL=q;var X=function(e){return"Network Error"===e.toString()?(z.b.error("\u7f51\u7edc\u5f02\u5e38"),!1):void 0!==e.response&&401===e.response.status?(window.location.href="#/login",!1):void 0===e.response||(z.b.error(e.response.data.message),!1)},$=function(e){return 401!==e.code||(window.location.href="#/login",!1)},Y={get:function(e){var t=B();return new Promise((function(a,n){R.a.get(e,{headers:t}).then((function(e){$(e.data)&&a(e.data)})).catch((function(e){X(e)&&n(e)}))}))},post:function(e,t){var a=B();return new Promise((function(n,s){R.a.post(e,t,{headers:a}).then((function(e){$(e.data)&&n(e.data)})).catch((function(e){X(e)&&s(e)}))}))},put:function(e,t){var a=B();return new Promise((function(n,s){R.a.put(e,t,{headers:a}).then((function(e){$(e.data)&&n(e.data)})).catch((function(e){X(e)&&s(e)}))}))},delete:function(e){var t=B();return new Promise((function(a,n){R.a.delete(e,{headers:t}).then((function(e){$(e.data)&&a(e.data)})).catch((function(e){X(e)&&n(e)}))}))},patch:function(e,t){var a=B();return new Promise((function(n,s){R.a.patch(e,t,{headers:a}).then((function(e){$(e.data)&&n(e.data)})).catch((function(e){X(e)&&s(e)}))}))}},_=(a(727),a(1247)),Z=a(1248),Q=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={counter:{},asset:{ssh:0,rdp:0,vnc:0,telnet:0,kubernetes:0},access:[]},e.getCounter=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/overview/counter");case 2:1===(a=t.sent).code&&e.setState({counter:a.data});case 4:case"end":return t.stop()}}),t)}))),e.getAsset=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/overview/asset");case 2:1===(a=t.sent).code&&e.setState({asset:a.data});case 4:case"end":return t.stop()}}),t)}))),e.getAccess=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/overview/access");case 2:1===(a=t.sent).code&&e.setState({access:a.data});case 4:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.getCounter(),this.getAsset(),this.getAccess()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e={appendPadding:10,data:[{type:"RDP",value:this.state.asset.rdp},{type:"SSH",value:this.state.asset.ssh},{type:"TELNET",value:this.state.asset.telnet},{type:"VNC",value:this.state.asset.vnc},{type:"Kubernetes",value:this.state.asset.kubernetes}],angleField:"value",colorField:"type",radius:1,innerRadius:.6,label:{type:"inner",offset:"-50%",content:"{value}",style:{textAlign:"center",fontSize:14}},interactions:[{type:"element-selected"},{type:"element-active"}],statistic:{title:!1,content:{formatter:function(){return"\u8d44\u4ea7\u7c7b\u578b"}}}},t={data:this.state.access.map((function(e){return{title:"".concat(e.username,"@").concat(e.ip,":").concat(e.port),value:e.accessCount,protocol:e.protocol}})),xField:"value",yField:"title",seriesField:"protocol",legend:{position:"top-left"}};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{style:{margin:16,marginBottom:0},children:Object(N.jsxs)(v.a,{gutter:16,children:[Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(w.a,{bordered:!0,hoverable:!0,children:Object(N.jsx)(x.b,{to:"/user",children:Object(N.jsx)(k.a,{title:"\u5728\u7ebf\u7528\u6237",value:this.state.counter.user,prefix:Object(N.jsx)(S.a,{})})})})}),Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(w.a,{bordered:!0,hoverable:!0,children:Object(N.jsx)(x.b,{to:"/asset",children:Object(N.jsx)(k.a,{title:"\u8d44\u4ea7\u6570\u91cf",value:this.state.counter.asset,prefix:Object(N.jsx)(C.a,{})})})})}),Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(w.a,{bordered:!0,hoverable:!0,children:Object(N.jsx)(x.b,{to:"/credential",hoverable:!0,children:Object(N.jsx)(k.a,{title:"\u6388\u6743\u51ed\u8bc1",value:this.state.counter.credential,prefix:Object(N.jsx)(I.a,{})})})})}),Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(w.a,{bordered:!0,hoverable:!0,children:Object(N.jsx)(x.b,{to:"/online-session",children:Object(N.jsx)(k.a,{title:"\u5728\u7ebf\u4f1a\u8bdd",value:this.state.counter.onlineSession,prefix:Object(N.jsx)(T.a,{})})})})})]})}),Object(N.jsx)("div",{className:"page-card",children:Object(N.jsxs)(v.a,{gutter:16,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(w.a,{bordered:!0,title:"\u8d44\u4ea7\u7c7b\u578b",children:Object(N.jsx)(_.a,Object(g.a)({},e))})}),Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(w.a,{bordered:!0,title:"\u4f7f\u7528\u6b21\u6570Top10 \u8d44\u4ea7",children:Object(N.jsx)(Z.a,Object(g.a)({},t))})})]})})]})}}]),a}(n.Component),ee=Q,te=a(1256),ae=a(671),ne=a(1254),se=a(108),re=a(1264),ce=a(1260),ie=a(1265),oe=a(302),le=a(1250),de=a(1253),ue=a(673),je=a(1255),he=a(1266),be=a(56),pe=a.n(be),me=a(10),Oe=a(19),xe=Oe.Input.TextArea,fe=Oe.Select.Option,ge=Oe.Typography.Text,ve=Oe.Collapse.Panel,ye={ssh:[{text:"\u5bc6\u7801",value:"custom"},{text:"\u5bc6\u94a5",value:"private-key"},{text:"\u6388\u6743\u51ed\u8bc1",value:"credential"}],rdp:[{text:"\u5bc6\u7801",value:"custom"},{text:"\u6388\u6743\u51ed\u8bc1",value:"credential"}],vnc:[{text:"\u5bc6\u7801",value:"custom"},{text:"\u6388\u6743\u51ed\u8bc1",value:"credential"}],telnet:[{text:"\u5bc6\u7801",value:"custom"},{text:"\u6388\u6743\u51ed\u8bc1",value:"credential"}]},we={labelCol:{span:6},wrapperCol:{span:18}},ke={labelCol:{span:8},wrapperCol:{span:16}},Se=function(e){var t=e.title,a=e.visible,s=e.handleOk,r=e.handleCancel,c=e.confirmLoading,l=e.credentials,d=e.tags,u=e.model,j=Oe.Form.useForm(),h=Object(me.a)(j,1)[0];void 0===u.accountType&&(u.accountType="rdp");var b=Object(n.useState)(u.accountType),p=Object(me.a)(b,2),m=p[0],O=p[1],x=Object(n.useState)(u.protocol),f=Object(me.a)(x,2),v=f[0],y=f[1],w=Object(n.useState)(u["ssh-mode"]),k=Object(me.a)(w,2),S=k[0],C=k[1],I=[];u.protocol&&(I=ye[u.protocol]);var T=Object(n.useState)(I),P=Object(me.a)(T,2),R=P[0],F=P[1],q=Object(n.useState)(u["use-ssl"]),D=Object(me.a)(q,2),z=D[0],L=D[1];for(var V in u)u.hasOwnProperty(V)&&"-"===u[V]&&(u[V]="");var B=function(e){O(e),u.accountType=e},M=Object(n.useState)(u["enable-drive"]),K=Object(me.a)(M,2),A=K[0],W=K[1],U=Object(n.useState)(u["socks-proxy-enable"]),H=Object(me.a)(U,2),G=H[0],J=H[1],X=Object(n.useState)([]),$=Object(me.a)(X,2),_=$[0],Z=$[1];Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/storages/shares");case 2:1===(t=e.sent).code&&Z(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var Q=Object(n.useState)([]),ee=Object(me.a)(Q,2),te=ee[0],ae=ee[1];return Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/access-gateways");case 2:1===(t=e.sent).code&&ae(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){h.validateFields().then((function(e){h.resetFields(),s(e)})).catch((function(e){}))},centered:!0,width:1040,onCancel:r,confirmLoading:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsx)(Oe.Form,Object(g.a)(Object(g.a)({form:h},we),{},{initialValues:u,children:Object(N.jsxs)(Oe.Row,{children:[Object(N.jsxs)(Oe.Col,{span:13,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u8d44\u4ea7\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u4ea7\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8d44\u4ea7\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4e3b\u673a",name:"ip",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u4ea7\u7684\u4e3b\u673a\u540d\u79f0\u6216\u8005IP\u5730\u5740"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8d44\u4ea7\u7684\u4e3b\u673a\u540d\u79f0\u6216\u8005IP\u5730\u5740"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u534f\u8bae",name:"protocol",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u5165\u534f\u8bae"}],children:Object(N.jsxs)(Oe.Radio.Group,{onChange:function(e){var t;switch(y(e.target.value),e.target.value){case"ssh":t=22,F(ye.ssh),h.setFieldsValue({accountType:"custom"}),B("custom");break;case"rdp":t=3389,F(ye.rdp),h.setFieldsValue({accountType:"custom"}),B("custom");break;case"vnc":t=5900,F(ye.vnc),h.setFieldsValue({accountType:"custom"}),B("custom");break;case"telnet":t=23,F(ye.telnet),h.setFieldsValue({accountType:"custom"}),B("custom");break;case"kubernetes":t=6443;break;default:t=65535}h.setFieldsValue({port:t})},children:[Object(N.jsx)(Oe.Radio,{value:"rdp",children:"RDP"}),Object(N.jsx)(Oe.Radio,{value:"ssh",children:"SSH"}),Object(N.jsx)(Oe.Radio,{value:"vnc",children:"VNC"}),Object(N.jsx)(Oe.Radio,{value:"telnet",children:"Telnet"}),Object(N.jsx)(Oe.Radio,{value:"kubernetes",children:"Kubernetes"})]})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7aef\u53e3\u53f7",name:"port",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u4ea7\u7aef\u53e3"}],children:Object(N.jsx)(Oe.InputNumber,{min:1,max:65535,placeholder:"TCP\u7aef\u53e3"})}),"kubernetes"===v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{name:"namespace",label:"\u547d\u540d\u7a7a\u95f4",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u4e3a\u7a7a\u65f6\u9ed8\u8ba4\u4f7f\u7528default\u547d\u540d\u7a7a\u95f4"})}),Object(N.jsx)(Oe.Form.Item,{name:"pod",label:"pod",rules:[{required:!0,message:"\u8bf7\u8f93\u5165Pod\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"Kubernetes Pod\u7684\u540d\u79f0\uff0c\u5176\u4e2d\u5305\u542b\u4e0e\u4e4b\u76f8\u8fde\u7684\u5bb9\u5668\u3002"})}),Object(N.jsx)(Oe.Form.Item,{name:"container",label:"\u5bb9\u5668",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u4e3a\u7a7a\u65f6\u9ed8\u8ba4\u4f7f\u7528\u7b2c\u4e00\u4e2a\u5bb9\u5668"})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{label:"\u8d26\u6237\u7c7b\u578b",name:"accountType",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u8d26\u6237\u7c7b\u578b"}],children:Object(N.jsx)(Oe.Select,{onChange:B,children:R.map((function(e){return Object(N.jsx)(fe,{value:e.value,children:e.text},e.value)}))})}),"credential"===m?Object(N.jsxs)(N.Fragment,{children:["ssh"===v?Object(N.jsx)(Oe.Form.Item,{wrapperCol:{offset:6},children:Object(N.jsx)(Oe.Alert,{message:"GUACD \u5bf9ED25519\u3001RSA\u7b49\u5bc6\u94a5\u7c7b\u578b\u652f\u6301\u4e0d\u5b8c\u5584\uff0c\u8bf7\u9009\u62e9\u539f\u751f\u6a21\u5f0f\u8fdb\u884c\u8fde\u63a5\u3002",type:"info"})}):null,Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u51ed\u8bc1",name:"credentialId",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6388\u6743\u51ed\u8bc1"}],children:Object(N.jsx)(Oe.Select,{onChange:function(){return null},children:l.map((function(e){return Object(N.jsx)(fe,{value:e.id,children:Object(N.jsx)(Oe.Tooltip,{placement:"topLeft",title:e.name,children:e.name})},e.id)}))})})]}):null,"custom"===m?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u8f93\u5165\u6388\u6743\u8d26\u6237"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u5bc6\u7801",name:"password",children:Object(N.jsx)(Oe.Input.Password,{autoComplete:"off",placeholder:"\u8f93\u5165\u6388\u6743\u5bc6\u7801"})})]}):null,"private-key"===m?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{wrapperCol:{offset:6},children:Object(N.jsx)(Oe.Alert,{message:"GUACD \u5bf9ED25519\u3001RSA\u7b49\u5bc6\u94a5\u7c7b\u578b\u652f\u6301\u4e0d\u5b8c\u5584\uff0c\u8bf7\u9009\u62e9\u539f\u751f\u6a21\u5f0f\u8fdb\u884c\u8fde\u63a5\u3002",type:"info"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",children:Object(N.jsx)(Oe.Input,{placeholder:"\u8f93\u5165\u6388\u6743\u8d26\u6237"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u79c1\u94a5",name:"privateKey",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u79c1\u94a5"}],children:Object(N.jsx)(xe,{rows:4})}),Object(N.jsx)(Oe.Form.Item,{label:"\u79c1\u94a5\u5bc6\u7801",name:"passphrase",children:Object(N.jsx)(xe,{rows:1})})]}):null]}),Object(N.jsx)(Oe.Form.Item,{label:"\u63a5\u5165\u7f51\u5173",name:"accessGatewayId",tooltip:"\u9700\u8981\u4ece\u63a5\u5165\u7f51\u5173\u624d\u80fd\u8bbf\u95ee\u7684\u76ee\u6807\u673a\u5668\u5fc5\u9009",children:Object(N.jsx)(Oe.Select,{onChange:function(){return null},allowClear:!0,children:te.map((function(e){return Object(N.jsx)(fe,{value:e.id,placeholder:"\u9700\u8981\u4ece\u63a5\u5165\u7f51\u5173\u624d\u80fd\u8bbf\u95ee\u7684\u76ee\u6807\u673a\u5668\u5fc5\u9009",children:Object(N.jsx)(Oe.Tooltip,{placement:"topLeft",title:e.name,children:e.name})},e.id)}))})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6807\u7b7e",name:"tags",children:Object(N.jsx)(Oe.Select,{mode:"tags",placeholder:"\u6807\u7b7e\u53ef\u4ee5\u66f4\u52a0\u65b9\u4fbf\u7684\u68c0\u7d22\u8d44\u4ea7",children:d.map((function(e){if("-"!==e)return Object(N.jsx)(fe,{children:e},e)}))})}),Object(N.jsx)(Oe.Form.Item,{label:"\u5907\u6ce8",name:"description",children:Object(N.jsx)(xe,{rows:4,placeholder:"\u5173\u4e8e\u8d44\u4ea7\u7684\u4e00\u4e9b\u4fe1\u606f\u60a8\u53ef\u4ee5\u5199\u5728\u8fd9\u91cc"})})]}),Object(N.jsx)(Oe.Col,{span:11,children:Object(N.jsxs)(Oe.Collapse,{defaultActiveKey:["VNC\u4e2d\u7ee7","storage","\u6a21\u5f0f\u8bbe\u7f6e","\u663e\u793a\u8bbe\u7f6e","\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a","socks"],ghost:!0,children:["rdp"===v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u663e\u793a\u8bbe\u7f6e"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"color-depth",label:"\u8272\u5f69\u6df1\u5ea6",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"16",children:"\u4f4e\u8272\uff0816\u4f4d\uff09"}),Object(N.jsx)(fe,{value:"24",children:"\u771f\u5f69\uff0824\u4f4d\uff09"}),Object(N.jsx)(fe,{value:"32",children:"\u771f\u5f69\uff0832\u4f4d\uff09"}),Object(N.jsx)(fe,{value:"8",children:"256\u8272"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"force-lossless",label:"\u65e0\u635f\u538b\u7f29",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})]},"\u663e\u793a\u8bbe\u7f6e"),Object(N.jsx)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u8ba4\u8bc1"}),children:Object(N.jsx)(Oe.Form.Item,{name:"domain",label:"\u57df",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u8eab\u4efd\u9a8c\u8bc1\u65f6\u4f7f\u7528\u7684\u57df"})})},"\u8ba4\u8bc1"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u9884\u8fde\u63a5 PDU (Hyper-V / VMConnect)"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"preconnection-id",label:"\u9884\u8fde\u63a5ID",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"RDP \u6e90\u7684\u6570\u5b57 ID"})}),Object(N.jsx)(Oe.Form.Item,{name:"preconnection-blob",label:"\u9884\u8fde\u63a5\u5b57\u7b26",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u6807\u8bc6 RDP \u6e90\u7684\u4efb\u610f\u5b57\u7b26\u4e32"})})]},"PDU"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"Remote App"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"remote-app",label:"\u7a0b\u5e8f",tooltip:"\u6307\u5b9a\u5728\u8fdc\u7a0b\u684c\u9762\u4e0a\u542f\u52a8\u7684RemoteApp\u3002\n\u5982\u679c\u60a8\u7684\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u5668\u652f\u6301\u8be5\u5e94\u7528\u7a0b\u5e8f\uff0c\u5219\u8be5\u5e94\u7528\u7a0b\u5e8f(\u4e14\u4ec5\u8be5\u5e94\u7528\u7a0b\u5e8f)\u5bf9\u7528\u6237\u53ef\u89c1\u3002 Windows\u9700\u8981\u5bf9\u8fdc\u7a0b\u5e94\u7528\u7a0b\u5e8f\u7684\u540d\u79f0\u4f7f\u7528\u7279\u6b8a\u7684\u7b26\u53f7\u3002\n\u8fdc\u7a0b\u5e94\u7528\u7a0b\u5e8f\u7684\u540d\u79f0\u5fc5\u987b\u4ee5\u4e24\u4e2a\u7ad6\u6761\u4f5c\u4e3a\u524d\u7f00\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5df2\u7ecf\u5728\u60a8\u7684\u670d\u52a1\u5668\u4e0a\u4e3anotepad.exe\u521b\u5efa\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u5c06\u5176\u547d\u540d\u4e3a\u201cnotepad\u201d\uff0c\u5219\u60a8\u5c06\u8be5\u53c2\u6570\u8bbe\u7f6e\u4e3a:\u201c||notepad\u201d\u3002",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"remote app"})}),Object(N.jsx)(Oe.Form.Item,{name:"remote-app-dir",label:"\u5de5\u4f5c\u76ee\u5f55",tooltip:"remote app\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u5982\u679c\u672a\u914d\u7f6eremote app\uff0c\u6b64\u53c2\u6570\u65e0\u6548\u3002",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"remote app\u7684\u5de5\u4f5c\u76ee\u5f55"})}),Object(N.jsx)(Oe.Form.Item,{name:"remote-app-args",label:"\u53c2\u6570",tooltip:"remote app\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5982\u679c\u672a\u914d\u7f6eremote app\uff0c\u6b64\u53c2\u6570\u65e0\u6548\u3002",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"remote app\u7684\u547d\u4ee4\u884c\u53c2\u6570"})})]},"remote-app"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"enable-drive",label:"\u542f\u7528",valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed",onChange:function(e,t){W(e)}})}),A?Object(N.jsx)(Oe.Form.Item,{name:"drive-path",label:"\u6620\u5c04\u7a7a\u95f4",tooltip:"\u7528\u4e8e\u6587\u4ef6\u4f20\u8f93\u7684\u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668\uff0c\u4e3a\u7a7a\u65f6\u4f7f\u7528\u64cd\u4f5c\u4eba\u7684\u9ed8\u8ba4\u7a7a\u95f4",children:Object(N.jsx)(Oe.Select,{onChange:null,allowClear:!0,placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u64cd\u4f5c\u4eba\u7684\u9ed8\u8ba4\u7a7a\u95f4",children:_.map((function(e){return Object(N.jsx)(fe,{value:e.id,children:e.name})}))})}):void 0]},"storage")]}):void 0,"ssh"===v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u6a21\u5f0f\u8bbe\u7f6e"}),children:Object(N.jsx)(Oe.Form.Item,{name:"ssh-mode",label:"\u8fde\u63a5\u6a21\u5f0f",initialValue:"",tooltip:"guacd\u5bf9\u90e8\u5206SSH\u5bc6\u94a5\u652f\u6301\u4e0d\u5b8c\u5584\uff0c\u5f53\u5bc6\u94a5\u7c7b\u578b\u4e3aED25519\u65f6\u8bf7\u9009\u62e9\u539f\u751f\u6a21\u5f0f\u3002",children:Object(N.jsxs)(Oe.Select,{onChange:function(e){C(e)},children:[Object(N.jsx)(fe,{value:"",children:"guacd"}),Object(N.jsx)(fe,{value:"naive",children:"\u539f\u751f"})]})})},"\u6a21\u5f0f\u8bbe\u7f6e"),E(S)||"guacd"===S?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u663e\u793a\u8bbe\u7f6e"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"color-scheme",label:"\u914d\u8272\u65b9\u6848",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"gray-black",children:"\u9ed1\u5e95\u7070\u5b57"}),Object(N.jsx)(fe,{value:"green-black",children:"\u9ed1\u5e95\u7eff\u5b57"}),Object(N.jsx)(fe,{value:"white-black",children:"\u9ed1\u5e95\u767d\u5b57"}),Object(N.jsx)(fe,{value:"black-white",children:"\u767d\u5e95\u9ed1\u5b57"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"font-name",label:"\u5b57\u4f53\u540d\u79f0",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u4f53"})}),Object(N.jsx)(Oe.Form.Item,{name:"font-size",label:"\u5b57\u4f53\u5927\u5c0f",children:Object(N.jsx)(Oe.Input,{type:"number",placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u4f53\u5927\u5c0f",min:8,max:96})})]},"\u663e\u793a\u8bbe\u7f6e"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"backspace",label:"\u9000\u683c\u952e\u6620\u5c04",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"127",children:"\u5220\u9664\u952e(Ctrl-?)"}),Object(N.jsx)(fe,{value:"8",children:"\u9000\u683c\u952e(Ctrl-H)"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"terminal-type",label:"\u7ec8\u7aef\u7c7b\u578b",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"ansi",children:"ansi"}),Object(N.jsx)(fe,{value:"linux",children:"linux"}),Object(N.jsx)(fe,{value:"vt100",children:"vt100"}),Object(N.jsx)(fe,{value:"vt220",children:"vt220"}),Object(N.jsx)(fe,{value:"xterm",children:"xterm"}),Object(N.jsx)(fe,{value:"xterm-256color",children:"xterm-256color"})]})})]},"\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a")]}):Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"Socks \u4ee3\u7406"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"socks-proxy-enable",label:"\u4f7f\u7528Socks\u4ee3\u7406",valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u662f",unCheckedChildren:"\u5426",onChange:function(e,t){J(e)}})}),G?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{label:"\u4ee3\u7406\u5730\u5740",name:"socks-proxy-host",rules:[{required:!0}],children:Object(N.jsx)(Oe.Input,{placeholder:"Socks \u4ee3\u7406\u7684\u4e3b\u673a\u5730\u5740"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4ee3\u7406\u7aef\u53e3",name:"socks-proxy-port",rules:[{required:!0}],children:Object(N.jsx)(Oe.InputNumber,{min:1,max:65535,placeholder:"Socks \u4ee3\u7406\u7684\u4e3b\u673a\u7aef\u53e3"})}),Object(N.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),Object(N.jsx)(Oe.Form.Item,{label:"\u4ee3\u7406\u8d26\u53f7",name:"socks-proxy-username",children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u4ee3\u7406\u8d26\u53f7\uff0c\u6ca1\u6709\u53ef\u4ee5\u4e0d\u586b"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4ee3\u7406\u5bc6\u7801",name:"socks-proxy-password",children:Object(N.jsx)(Oe.Input.Password,{autoComplete:"off",placeholder:"\u4ee3\u7406\u5bc6\u7801\uff0c\u6ca1\u6709\u53ef\u4ee5\u4e0d\u586b"})})]}):void 0]},"socks")})]}):void 0,"vnc"===v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u663e\u793a\u8bbe\u7f6e"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"color-depth",label:"\u8272\u5f69\u6df1\u5ea6",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"16",children:"\u4f4e\u8272\uff0816\u4f4d\uff09"}),Object(N.jsx)(fe,{value:"24",children:"\u771f\u5f69\uff0824\u4f4d\uff09"}),Object(N.jsx)(fe,{value:"32",children:"\u771f\u5f69\uff0832\u4f4d\uff09"}),Object(N.jsx)(fe,{value:"8",children:"256\u8272"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"cursor",label:"\u5149\u6807",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"local",children:"\u672c\u5730"}),Object(N.jsx)(fe,{value:"remote",children:"\u8fdc\u7a0b"})]})})]},"\u663e\u793a\u8bbe\u7f6e"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"VNC\u4e2d\u7ee7"}),children:[Object(N.jsx)(Oe.Form.Item,{label:"\u76ee\u6807\u4e3b\u673a",tooltip:"\u8fde\u63a5\u5230VNC\u4ee3\u7406\uff08\u4f8b\u5982UltraVNC Repeater\uff09\u65f6\u8981\u8bf7\u6c42\u7684\u76ee\u6807\u4e3b\u673a\u3002",name:"dest-host",children:Object(N.jsx)(Oe.Input,{placeholder:"\u76ee\u6807\u4e3b\u673a"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u76ee\u6807\u7aef\u53e3",tooltip:"\u8fde\u63a5\u5230VNC\u4ee3\u7406\uff08\u4f8b\u5982UltraVNC Repeater\uff09\u65f6\u8981\u8bf7\u6c42\u7684\u76ee\u6807\u7aef\u53e3\u3002",name:"dest-port",children:Object(N.jsx)(Oe.Input,{type:"number",min:1,max:65535,placeholder:"\u76ee\u6807\u7aef\u53e3"})})]},"VNC\u4e2d\u7ee7")]}):void 0,"telnet"===v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u8ba4\u8bc1"}),children:[Object(N.jsx)(Oe.Form.Item,Object(g.a)(Object(g.a)({},ke),{},{name:"username-regex",label:"\u7528\u6237\u540d\u6b63\u5219\u8868\u8fbe\u5f0f",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})})),Object(N.jsx)(Oe.Form.Item,Object(g.a)(Object(g.a)({},ke),{},{name:"password-regex",label:"\u5bc6\u7801\u6b63\u5219\u8868\u8fbe\u5f0f",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})})),Object(N.jsx)(Oe.Form.Item,Object(g.a)(Object(g.a)({},ke),{},{name:"login-success-regex",label:"\u767b\u5f55\u6210\u529f\u6b63\u5219\u8868\u8fbe\u5f0f",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})})),Object(N.jsx)(Oe.Form.Item,Object(g.a)(Object(g.a)({},ke),{},{name:"login-failure-regex",label:"\u767b\u5f55\u5931\u8d25\u6b63\u5219\u8868\u8fbe\u5f0f",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})}))]},"\u8ba4\u8bc1"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u663e\u793a\u8bbe\u7f6e"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"color-scheme",label:"\u914d\u8272\u65b9\u6848",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"gray-black",children:"\u9ed1\u5e95\u7070\u5b57"}),Object(N.jsx)(fe,{value:"green-black",children:"\u9ed1\u5e95\u7eff\u5b57"}),Object(N.jsx)(fe,{value:"white-black",children:"\u9ed1\u5e95\u767d\u5b57"}),Object(N.jsx)(fe,{value:"black-white",children:"\u767d\u5e95\u9ed1\u5b57"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"font-name",label:"\u5b57\u4f53\u540d\u79f0",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u4f53"})}),Object(N.jsx)(Oe.Form.Item,{name:"font-size",label:"\u5b57\u4f53\u5927\u5c0f",children:Object(N.jsx)(Oe.Input,{type:"number",placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u4f53\u5927\u5c0f",min:8,max:96})})]},"\u663e\u793a\u8bbe\u7f6e"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"backspace",label:"\u9000\u683c\u952e\u6620\u5c04",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"127",children:"\u5220\u9664\u952e(Ctrl-?)"}),Object(N.jsx)(fe,{value:"8",children:"\u9000\u683c\u952e(Ctrl-H)"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"terminal-type",label:"\u7ec8\u7aef\u7c7b\u578b",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"ansi",children:"ansi"}),Object(N.jsx)(fe,{value:"linux",children:"linux"}),Object(N.jsx)(fe,{value:"vt100",children:"vt100"}),Object(N.jsx)(fe,{value:"vt220",children:"vt220"}),Object(N.jsx)(fe,{value:"xterm",children:"xterm"}),Object(N.jsx)(fe,{value:"xterm-256color",children:"xterm-256color"})]})})]},"\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a")]}):void 0,"kubernetes"===v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u8ba4\u8bc1"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"use-ssl",label:"\u4f7f\u7528SSL",valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u662f",unCheckedChildren:"\u5426",onChange:function(e,t){L(e)}})}),z?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{name:"client-cert",label:"client-cert",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})}),Object(N.jsx)(Oe.Form.Item,{name:"client-key",label:"client-key",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})}),Object(N.jsx)(Oe.Form.Item,{name:"ca-cert",label:"ca-cert",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:""})})]}):void 0,Object(N.jsx)(Oe.Form.Item,{name:"ignore-cert",label:"\u5ffd\u7565\u8bc1\u4e66",valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u662f",unCheckedChildren:"\u5426",onChange:function(e,t){}})})]},"\u8ba4\u8bc1"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u663e\u793a\u8bbe\u7f6e"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"color-scheme",label:"\u914d\u8272\u65b9\u6848",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"gray-black",children:"\u9ed1\u5e95\u7070\u5b57"}),Object(N.jsx)(fe,{value:"green-black",children:"\u9ed1\u5e95\u7eff\u5b57"}),Object(N.jsx)(fe,{value:"white-black",children:"\u9ed1\u5e95\u767d\u5b57"}),Object(N.jsx)(fe,{value:"black-white",children:"\u767d\u5e95\u9ed1\u5b57"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"font-name",label:"\u5b57\u4f53\u540d\u79f0",children:Object(N.jsx)(Oe.Input,{type:"text",placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u4f53"})}),Object(N.jsx)(Oe.Form.Item,{name:"font-size",label:"\u5b57\u4f53\u5927\u5c0f",children:Object(N.jsx)(Oe.Input,{type:"number",placeholder:"\u4e3a\u7a7a\u65f6\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u4f53\u5927\u5c0f",min:8,max:96})})]},"\u663e\u793a\u8bbe\u7f6e"),Object(N.jsxs)(ve,{header:Object(N.jsx)(ge,{strong:!0,children:"\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a"}),children:[Object(N.jsx)(Oe.Form.Item,{name:"backspace",label:"\u9000\u683c\u952e\u6620\u5c04",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"127",children:"\u5220\u9664\u952e(Ctrl-?)"}),Object(N.jsx)(fe,{value:"8",children:"\u9000\u683c\u952e(Ctrl-H)"})]})}),Object(N.jsx)(Oe.Form.Item,{name:"terminal-type",label:"\u7ec8\u7aef\u7c7b\u578b",initialValue:"",children:Object(N.jsxs)(Oe.Select,{onChange:null,children:[Object(N.jsx)(fe,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(fe,{value:"ansi",children:"ansi"}),Object(N.jsx)(fe,{value:"linux",children:"linux"}),Object(N.jsx)(fe,{value:"vt100",children:"vt100"}),Object(N.jsx)(fe,{value:"vt220",children:"vt220"}),Object(N.jsx)(fe,{value:"xterm",children:"xterm"}),Object(N.jsx)(fe,{value:"xterm-256color",children:"xterm-256color"})]})})]},"\u63a7\u5236\u7ec8\u7aef\u884c\u4e3a")]}):void 0]})})]})}))})},Ce=a(82),Ie=a.n(Ce),Te=a(414),Pe=a(1274),Re=a(1275),Fe=a(674),qe=a(1276),De=a(678),ze=a(222),Ne=a(1277),Le={rdp:"cyan",ssh:"blue",telnet:"geekblue",vnc:"purple",kubernetes:"volcano"},Ve={guacd:"green",native:"orange",terminal:"purple"};function Be(e){var t=sessionStorage.getItem("user");if(E(t))return!1;var a=JSON.parse(t);return"admin"===a.type||a.id===e}function Me(){var e=sessionStorage.getItem("user");return!E(e)&&"admin"===JSON.parse(e).type}function Ke(){var e=sessionStorage.getItem("user");return E(e)?{}:JSON.parse(e)}var Ae,We,Ee=a(665),Ue=te.a.confirm,He=ae.a.Search,Ge=h.a.Content,Je=ne.a.Title,Xe=ne.a.Text,$e=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.inputRefOfIp=s.a.createRef(),e.changeOwnerFormRef=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10,protocol:"",tags:""},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,credentials:[],tags:[],selectedTags:[],model:{},selectedRowKeys:[],delBtnLoading:!1,changeOwnerModalVisible:!1,changeOwnerConfirmLoading:!1,users:[],selected:{},selectedSharers:[],importModalVisible:!1,fileList:[],uploading:!1},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleSearchByIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,ip:t});e.loadTableData(a)},e.handleTagsChange=function(t){e.setState({selectedTags:t});var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,tags:t.join(",")});e.loadTableData(a)},e.handleSearchByProtocol=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,protocol:t});e.loadTableData(a)},e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),a.tags&&(a.tags=a.tags.join(",")),void 0===a.accessGatewayId&&(a.accessGatewayId="-"),!a.id){t.next=17;break}return t.next=6,Y.put("/assets/"+a.id,a);case 6:if(1!==(n=t.sent).code){t.next=14;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=12,e.loadTableData(e.state.queryParams);case 12:t.next=15;break;case 14:z.b.error(n.message,10);case 15:t.next=28;break;case 17:return t.next=19,Y.post("/assets",a);case 19:if(1!==(s=t.sent).code){t.next=27;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=25,e.loadTableData(e.state.queryParams);case 25:t.next=28;break;case 27:z.b.error(s.message,10);case 28:e.setState({modalConfirmLoading:!1});case 29:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/assets/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleSearchByNickname=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/paging?pageIndex=1&pageSize=100&nickname=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:s=n.data.items.map((function(e){return Object(g.a)({key:e.id},e)})),e.setState({users:s});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCancelUpdateAttr=function(){e.setState({attrVisible:!1,selected:{},attributes:{}})},e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadTableData(),e.next=3,Y.get("/tags");case 3:1===(t=e.sent).code&&this.setState({tags:t.data});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/assets/"+t);case 2:if(1!==(a=e.sent).code){e.next=9;break}return z.b.success("\u5220\u9664\u6210\u529f"),e.next=7,this.loadTableData(this.state.queryParams);case 7:e.next=10;break;case 9:z.b.error(a.message,10);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/assets/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;Ue({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u8d44\u4ea7\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"update",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/assets/".concat(t));case 2:if(1===(a=e.sent).code){e.next=6;break}return z.b.error(a.message,10),e.abrupt("return");case 6:return e.next=8,this.showModal("\u66f4\u65b0\u8d44\u4ea7",a.data);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"copy",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/assets/".concat(t));case 2:if(1===(a=e.sent).code){e.next=6;break}return z.b.error(a.message,10),e.abrupt("return");case 6:return a.data.id=void 0,e.next=9,this.showModal("\u590d\u5236\u8d44\u4ea7",a.data);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"connTest",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z.b.info({content:"\u6b63\u5728\u6d4b\u8bd5\u4e2d...",key:t,duration:5}),e.next=3,Y.post("/assets/".concat(t,"/tcping"));case 3:if(1===(a=e.sent).code){e.next=7;break}return z.b.error({content:a.message,key:t,duration:10}),e.abrupt("return");case 7:!0===a.data.active?z.b.success({content:"\u8fde\u901a\u6027\u6d4b\u8bd5\u5b8c\u6210\uff0c\u5f53\u524d\u8d44\u4ea7\u5728\u7ebf\u3002",key:t,duration:3}):z.b.warning({content:"\u8fde\u901a\u6027\u6d4b\u8bd5\u5b8c\u6210\uff0c\u5f53\u524d\u8d44\u4ea7\u79bb\u7ebf\uff0c\u539f\u56e0: ".concat(a.data.message,"\u3002"),key:t,duration:10}),this.loadTableData(this.state.queryParams);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showModal",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r,c,o,l,d=arguments;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:{},n=Y.get("/credentials"),s=Y.get("/tags"),r=[],c=[],e.next=7,n;case 7:return o=e.sent,e.next=10,s;case 10:l=e.sent,1===o.code&&(r=o.data),1===l.code&&(c=l.data),a.tags&&"string"===typeof a.tags?""===a.tags||"-"===a.tags?a.tags=[]:a.tags=a.tags.split(","):a.tags=[],a["use-ssl"]="true"===a["use-ssl"],a["ignore-cert"]="true"===a["ignore-cert"],a["enable-drive"]="true"===a["enable-drive"],a["socks-proxy-enable"]="true"===a["socks-proxy-enable"],a["force-lossless"]="true"===a["force-lossless"],this.setState({modalTitle:t,modalVisible:!0,credentials:r,tags:c,model:a});case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a){var n=t;return n&&n.length>15&&(n=n.substring(0,15)+" ..."),Be(a.owner)?Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){return e.update(a.id)},children:Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:n})}):Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:n})},sorter:!0},{title:"\u534f\u8bae",dataIndex:"protocol",key:"protocol",render:function(e,t){var a="".concat(t.ip+":"+t.port);return Object(N.jsx)(se.a,{title:a,children:Object(N.jsx)(re.a,{color:Le[e],children:e})})}},{title:"\u7f51\u7edc",dataIndex:"network",key:"network",render:function(e,t){return"".concat(t.ip+":"+t.port)}},{title:"\u6807\u7b7e",dataIndex:"tags",key:"tags",render:function(t){if(!E(t))return e.renderTags(t)}},{title:"\u72b6\u6001",dataIndex:"active",key:"active",render:function(e){return e?Object(N.jsx)(se.a,{title:"\u8fd0\u884c\u4e2d",children:Object(N.jsx)(ce.a,{status:"processing",text:"\u8fd0\u884c\u4e2d"})}):Object(N.jsx)(se.a,{title:"\u4e0d\u53ef\u7528",children:Object(N.jsx)(ce.a,{status:"error",text:"\u4e0d\u53ef\u7528"})})}},{title:"\u6240\u6709\u8005",dataIndex:"ownerName",key:"ownerName"},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){var n=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){return e.update(a.id)},children:"\u7f16\u8f91"})},"1"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){return e.copy(a.id)},children:"\u590d\u5236"})},"2"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){return e.connTest(a.id)},children:"\u8fde\u901a\u6027\u6d4b\u8bd5"})},"3"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",disabled:!Be(a.owner),onClick:function(){e.handleSearchByNickname("").then((function(){e.setState({changeOwnerModalVisible:!0,selected:a}),e.changeOwnerFormRef.current.setFieldsValue({owner:a.owner})}))},children:"\u66f4\u6362\u6240\u6709\u8005"})},"4"),Object(N.jsx)(b.a.Divider,{}),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,disabled:!Be(a.owner),onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})},"5")]}),s=a.id,r=a.protocol,c=a.name,i=a.sshMode,o="";return o="ssh"!==r||"native"!==i&&"naive"!==i?"#/access?assetId=".concat(s,"&assetName=").concat(c,"&protocol=").concat(r):"#/term?assetId=".concat(s,"&assetName=").concat(c),Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",href:o,target:"_blank",children:"\u63a5\u5165"}),Object(N.jsx)(m.a,{overlay:n,children:Object(N.jsxs)(O.a,{type:"link",size:"small",children:["\u66f4\u591a ",Object(N.jsx)(Te.a,{})]})})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Ge,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:4,children:Object(N.jsx)(Je,{level:3,children:"\u8d44\u4ea7\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:20,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(He,{ref:this.inputRefOfName,placeholder:"\u8d44\u4ea7\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName,style:{width:200}}),Object(N.jsx)(He,{ref:this.inputRefOfIp,placeholder:"\u8d44\u4ea7IP",allowClear:!0,onSearch:this.handleSearchByIp,style:{width:200}}),Object(N.jsx)(oe.a,{mode:"multiple",allowClear:!0,value:this.state.selectedTags,placeholder:"\u8d44\u4ea7\u6807\u7b7e",onChange:this.handleTagsChange,style:{minWidth:150},children:this.state.tags.map((function(e){if("-"!==e)return Object(N.jsx)(oe.a.Option,{children:e},e)}))}),Object(N.jsxs)(oe.a,{onChange:this.handleSearchByProtocol,value:this.state.queryParams.protocol?this.state.queryParams.protocol:"",style:{width:100},children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u534f\u8bae"}),Object(N.jsx)(oe.a.Option,{value:"rdp",children:"rdp"}),Object(N.jsx)(oe.a.Option,{value:"ssh",children:"ssh"}),Object(N.jsx)(oe.a.Option,{value:"vnc",children:"vnc"}),Object(N.jsx)(oe.a.Option,{value:"telnet",children:"telnet"}),Object(N.jsx)(oe.a.Option,{value:"kubernetes",children:"kubernetes"})]}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.inputRefOfIp.current.setValue(""),e.setState({selectedTags:[]}),e.loadTableData({pageIndex:1,pageSize:10,protocol:"",tags:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5bfc\u5165",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Re.a,{}),onClick:function(){e.setState({importModalVisible:!0})}})}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u8d44\u4ea7",{})}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(Xe,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});Ue({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange},"assets-table"),this.state.modalVisible?Object(N.jsx)(Se,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,credentials:this.state.credentials,tags:this.state.tags,model:this.state.model}):null,this.state.importModalVisible?Object(N.jsx)(te.a,{title:"\u8d44\u4ea7\u5bfc\u5165",visible:!0,onOk:function(){var t=new FormData;t.append("file",e.state.fileList[0]);var a=B();a["Content-Type"]="multipart/form-data",R.a.post(q+"/assets/import",t,{headers:a}).then((function(t){console.log("\u4e0a\u4f20\u6210\u529f",t),e.setState({importModalVisible:!1});var a=t.data;if(1===a.code){var n=a.data,s=n.successCount,r=n.errorCount;0===r?ue.a.success({message:"\u5bfc\u5165\u8d44\u4ea7\u6210\u529f",description:"\u5171\u5bfc\u5165\u6210\u529f"+s+"\u6761\u8d44\u4ea7\u3002"}):ue.a.info({message:"\u5bfc\u5165\u8d44\u4ea7\u5b8c\u6210",description:"\u5171\u5bfc\u5165\u6210\u529f".concat(s,"\u6761\u8d44\u4ea7\uff0c\u5931\u8d25").concat(r,"\u6761\u8d44\u4ea7\u3002")})}else ue.a.error({message:"\u5bfc\u5165\u8d44\u4ea7\u5931\u8d25",description:a.message});e.loadTableData()}))},onCancel:function(){e.setState({importModalVisible:!1})},okButtonProps:{disabled:0===this.state.fileList.length},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Ee.a,{maxCount:1,onRemove:function(t){e.setState((function(e){var a=e.fileList.indexOf(t),n=e.fileList.slice();return n.splice(a,1),{fileList:n}}))},beforeUpload:function(t){return e.setState((function(e){return{fileList:[t]}})),!1},fileList:this.state.fileList,children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Ne.a,{}),children:"\u9009\u62e9csv\u6587\u4ef6"})}),Object(N.jsx)(O.a,{type:"primary",onClick:function(){var e=new Blob(["\ufeffname,ssh,127.0.0.1,22,username,password,privateKey,passphrase,description,tag1|tag2|tag3"],{type:"text/csv;charset=gb2312;"}),t=document.createElement("a");t.download="sample.csv",t.href=URL.createObjectURL(e),t.click()},children:"\u4e0b\u8f7d\u6837\u672c\u6587\u4ef6"})]})}):void 0,Object(N.jsx)(te.a,{title:Object(N.jsxs)(Xe,{children:["\u66f4\u6362\u8d44\u6e90\u300c",Object(N.jsx)("strong",{style:{color:"#1890ff"},children:this.state.selected.name}),"\u300d\u7684\u6240\u6709\u8005"]}),visible:this.state.changeOwnerModalVisible,confirmLoading:this.state.changeOwnerConfirmLoading,onOk:function(){e.setState({changeOwnerConfirmLoading:!0});var t=!1;e.changeOwnerFormRef.current.validateFields().then(function(){var a=Object(o.a)(Object(i.a)().mark((function a(n){var s;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Y.post("/assets/".concat(e.state.selected.id,"/change-owner?owner=").concat(n.owner));case 2:1===(s=a.sent).code?(z.b.success("\u64cd\u4f5c\u6210\u529f"),e.loadTableData()):(z.b.error(s.message,10),t=!0);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){})).finally((function(){e.setState({changeOwnerConfirmLoading:!1,changeOwnerModalVisible:t})}))},onCancel:function(){e.setState({changeOwnerModalVisible:!1})},children:Object(N.jsxs)(je.a,{ref:this.changeOwnerFormRef,children:[Object(N.jsx)(je.a.Item,{name:"owner",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6240\u6709\u8005"}],children:Object(N.jsx)(oe.a,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u6240\u6709\u8005",onSearch:this.handleSearchByNickname,filterOption:!1,children:this.state.users.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.nickname},e.id)}))})}),Object(N.jsx)(he.a,{message:"\u66f4\u6362\u8d44\u4ea7\u6240\u6709\u8005\u4e0d\u4f1a\u5f71\u54cd\u6388\u6743\u51ed\u8bc1\u7684\u6240\u6709\u8005",type:"info",showIcon:!0})]})})]},"page-content")})}},{key:"renderTags",value:function(e){for(var t=[],a=e.split(","),n=0;n<a.length;n++)"-"!==e[n]&&t.push(Object(N.jsx)(re.a,{children:a[n]},a[n]));return t}}]),a}(n.Component),Ye=$e,_e=a(102),Ze=a.n(_e),Qe=a(1263),et=a(1251),tt=a(1289),at=a(677),nt=a(1290),st=a(681),rt=a(1291),ct=a(1292),it=(a(467),a(144)),ot=a.n(it),lt=a(669),dt=a(1278),ut=a(1279),jt=a(1280),ht=a(1281),bt=a(1282),pt=a(1283),mt=a(1284),Ot=a(1285),xt=a(415),ft=a(1286),gt=a(1287),vt=a(1288),yt=(a(1180),a(663)),wt=ne.a.Text,kt=te.a.confirm,St=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).mkdirFormRef=s.a.createRef(),e.renameFormRef=s.a.createRef(),e.state={storageType:void 0,storageId:void 0,currentDirectory:"/",currentDirectoryInput:"/",files:[],loading:!1,currentFileKey:void 0,selectedRowKeys:[],uploading:{},callback:void 0,minHeight:280,upload:!1,download:!1,delete:!1,rename:!1,edit:!1,editorVisible:!1,fileName:"",fileContent:""},e.reSetStorageId=function(t){e.setState({storageId:t},(function(){e.loadFiles("/")}))},e.refresh=Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.loadFiles(e.state.currentDirectory),e.state.callback&&e.state.callback();case 2:case"end":return t.stop()}}),t)}))),e.loadFiles=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r,c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.prev=1,E(a)&&(a="/"),(n=new FormData).append("dir",a),t.next=7,Y.post("/".concat(e.state.storageType,"/").concat(e.state.storageId,"/ls"),n);case 7:if(1===(s=t.sent).code){t.next=11;break}return z.b.error(s.message),t.abrupt("return");case 11:r=s.data,c=r.map((function(e){return Object(g.a)({key:e.path},e)})),"/"!==a&&c.splice(0,0,{key:"..",name:"..",path:"..",isDir:!0,disabled:!0}),e.setState({files:c,currentDirectory:a,currentDirectoryInput:a});case 15:return t.prev=15,e.setState({loading:!1,selectedRowKeys:[]}),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,,15,18]])})));return function(e){return t.apply(this,arguments)}}(),e.handleCurrentDirectoryInputChange=function(t){e.setState({currentDirectoryInput:t.target.value})},e.handleCurrentDirectoryInputPressEnter=function(t){e.loadFiles(t.target.value)},e.handleUploadDir=function(){for(var t=window.document.getElementById("dir-upload").files,a=0,n=0;n<t.length;n++){var s=t[n].webkitRelativePath,r=s.substring(0,s.length-t[n].name.length);e.uploadFile(t[n],e.state.currentDirectory+"/"+r,(function(){++a===t.length&&e.refresh()}))}},e.handleUploadFile=function(){for(var t=window.document.getElementById("file-upload").files,a=0,n=0;n<t.length;n++){var s=t[n];if(!s)return;e.uploadFile(s,e.state.currentDirectory,(function(){++a===t.length&&e.refresh()}))}},e.uploadFile=function(t,a,n){var r=t.name,c=t.size,i="".concat(q,"/").concat(e.state.storageType,"/").concat(e.state.storageId,"/upload?X-Auth-Token=").concat(V(),"&dir=").concat(a),o=r,l=new XMLHttpRequest,d=0,u=0,j=function(e,t){if(e){var a=Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)("div",{children:r}),Object(N.jsxs)("div",{children:[J(c)," / ",J(c)]}),Object(N.jsx)(lt.a,{percent:100})]});ue.a.success({key:o,message:"\u4e0a\u4f20\u6210\u529f",duration:5,description:a,placement:"bottomRight"}),n&&n()}else{var i=Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)("div",{children:r}),Object(N.jsx)(wt,{type:"danger",children:t})]});ue.a.error({key:o,message:"\u4e0a\u4f20\u5931\u8d25",duration:10,description:i,placement:"bottomRight"})}};l.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)("div",{children:r}),Object(N.jsxs)("div",{children:[J(e.loaded),"/",J(c)]}),Object(N.jsx)(lt.a,{percent:99})]});if(e.loaded===e.total)return void ue.a.info({key:o,message:"\u5411\u76ee\u6807\u673a\u5668\u4f20\u8f93\u4e2d...",duration:null,description:t,placement:"bottomRight",onClose:function(){l.abort(),z.b.info('\u60a8\u5df2\u53d6\u6d88\u4e0a\u4f20"'.concat(r,'"'),10)}});if(u=Math.min(Math.floor(100*e.loaded/e.total),99),d===u)return;t=Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)("div",{children:r}),Object(N.jsxs)("div",{children:[J(e.loaded)," / ",J(c)]}),Object(N.jsx)(lt.a,{percent:u})]}),ue.a.info({key:o,message:"\u4e0a\u4f20\u4e2d...",duration:null,description:t,placement:"bottomRight",onClose:function(){l.abort(),z.b.info('\u60a8\u5df2\u53d6\u6d88\u4e0a\u4f20"'.concat(r,'"'),10)}}),d=u}}),!1),l.onreadystatechange=function(e){if(4===l.readyState)if(l.status>=200&&l.status<300){var t,a=e.currentTarget.responseText;try{t=JSON.parse(a)}catch(n){t={}}1!==t.code?j(!1,t.message):j(!0,t.message)}else l.status>=400&&l.status<500&&j(!1,"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef")},l.onerror=function(){j(!1,"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef")},l.open("POST",i,!0);var h=new FormData;h.append("file",t,r),l.send(h)},e.delete=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new FormData).append("file",a),t.next=4,Y.post("/".concat(e.state.storageType,"/").concat(e.state.storageId,"/rm"),n);case 4:1!==(s=t.sent).code&&z.b.error(s.message);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showEditor=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return z.b.loading({key:n,content:"Loading"}),t.next=3,Y.get("".concat(q,"/").concat(e.state.storageType,"/").concat(e.state.storageId,"/download?file=").concat(window.encodeURIComponent(n),"&t=").concat((new Date).getTime()));case 3:s=t.sent,e.setState({currentFileKey:n,fileName:a,fileContent:s+"",editorVisible:!0}),z.b.destroy(n);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.hideEditor=function(){e.setState({editorVisible:!1,fileName:"",fileContent:"",currentFileKey:""})},e.edit=Object(o.a)(Object(i.a)().mark((function t(){var a,n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({confirmLoading:!0}),a="".concat(q,"/").concat(e.state.storageType,"/").concat(e.state.storageId,"/edit"),(n=new FormData).append("file",e.state.currentFileKey),n.append("fileContent",e.state.fileContent),t.next=7,Y.post(a,n);case 7:1!==(s=t.sent).code&&z.b.error(s.message),e.setState({confirmLoading:!1}),e.hideEditor();case 11:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.onRef&&this.props.onRef(this),this.setState({storageId:this.props.storageId,storageType:this.props.storageType,callback:this.props.callback,minHeight:this.props.minHeight,upload:this.props.upload,download:this.props.download,delete:this.props.delete,rename:this.props.rename,edit:this.props.edit},(function(){e.loadFiles(e.state.currentDirectory),console.log(e.state)}))}},{key:"render",value:function(){var e=this,t=[{title:"\u540d\u79f0",dataIndex:"name",key:"name",render:function(e,t){var a;if(t.isDir)a=Object(N.jsx)(dt.a,{});else if(t.isLink)a=Object(N.jsx)(T.a,{});else switch(t.name.split(".").pop().toLowerCase()){case"doc":case"docx":a=Object(N.jsx)(ut.a,{});break;case"xls":case"xlsx":a=Object(N.jsx)(jt.a,{});break;case"bmp":case"jpg":case"jpeg":case"png":case"tif":case"gif":case"pcx":case"tga":case"exif":case"svg":case"psd":case"ai":case"webp":a=Object(N.jsx)(ht.a,{});break;case"md":a=Object(N.jsx)(bt.a,{});break;case"pdf":a=Object(N.jsx)(pt.a,{});break;case"txt":a=Object(N.jsx)(mt.a,{});break;case"zip":case"gz":case"tar":case"tgz":a=Object(N.jsx)(Ot.a,{});break;default:a=Object(N.jsx)(xt.a,{})}return Object(N.jsxs)("span",{className:"dode",children:[a,"\xa0\xa0",t.name]})},sorter:function(e,t){return".."===e.key||".."===t.key?0:e.name.localeCompare(t.name)},sortDirections:["descend","ascend"]},{title:"\u5927\u5c0f",dataIndex:"size",key:"size",render:function(e,t){return t.isDir||t.isLink?Object(N.jsx)("span",{className:"dode"}):Object(N.jsx)("span",{className:"dode",children:J(e)})},sorter:function(e,t){return".."===e.key||".."===t.key?0:e.size-t.size}},{title:"\u4fee\u6539\u65e5\u671f",dataIndex:"modTime",key:"modTime",sorter:function(e,t){return".."===e.key||".."===t.key?0:e.modTime.localeCompare(t.modTime)},sortDirections:["descend","ascend"],render:function(e,t){return Object(N.jsx)("span",{className:"dode",children:e})}},{title:"\u5c5e\u6027",dataIndex:"mode",key:"mode",render:function(e,t){return Object(N.jsx)("span",{className:"dode",children:e})}},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",width:210,render:function(t,a){if(".."!==a.key){var n=!e.state.download,s=!e.state.edit;return(a.isDir||a.isLink)&&(n=!0,s=!0),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(O.a,{type:"link",size:"small",disabled:s,onClick:function(){return e.showEditor(a.name,a.key)},children:"\u7f16\u8f91"}),Object(N.jsx)(O.a,{type:"link",size:"small",disabled:n,onClick:Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:A("".concat(q,"/").concat(e.state.storageType,"/").concat(e.state.storageId,"/download?file=").concat(window.encodeURIComponent(a.key),"&X-Auth-Token=").concat(V(),"&t=").concat((new Date).getTime()));case 1:case"end":return t.stop()}}),t)}))),children:"\u4e0b\u8f7d"}),Object(N.jsx)(O.a,{type:"link",size:"small",disabled:!e.state.rename,onClick:function(){e.setState({renameVisible:!0,currentFileKey:a.key})},children:"\u91cd\u547d\u540d"}),Object(N.jsx)(p.a,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u6587\u4ef6\u5417?",onConfirm:Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.delete(a.key);case 2:return t.next=4,e.refresh();case 4:case"end":return t.stop()}}),t)}))),okText:"\u662f",cancelText:"\u5426",children:Object(N.jsx)(O.a,{type:"link",size:"small",disabled:!e.state.delete,danger:!0,children:"\u5220\u9664"})})]})}}}],a=this.state.selectedRowKeys,n={selectedRowKeys:a,onChange:function(t){e.setState({selectedRowKeys:t})},getCheckboxProps:function(e){return{disabled:e.disabled}}},s=a.length>0;s&&(this.state.delete||(s=!1));var r,c=Object(N.jsxs)("div",{className:"fs-header",children:[Object(N.jsx)("div",{className:"fs-header-left",children:Object(N.jsx)(ae.a,{value:this.state.currentDirectoryInput,onChange:this.handleCurrentDirectoryInputChange,onPressEnter:this.handleCurrentDirectoryInputPressEnter})}),Object(N.jsx)("div",{className:"fs-header-right",children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)("div",{className:"fs-header-right-item",children:Object(N.jsx)(se.a,{title:"\u521b\u5efa\u6587\u4ef6\u5939",children:Object(N.jsx)(O.a,{type:"primary",size:"small",disabled:!this.state.upload,icon:Object(N.jsx)(ft.a,{}),onClick:function(){e.setState({mkdirVisible:!0})},ghost:!0})})}),Object(N.jsx)("div",{className:"fs-header-right-item",children:Object(N.jsxs)(se.a,{title:"\u4e0a\u4f20\u6587\u4ef6",children:[Object(N.jsx)(O.a,{type:"primary",size:"small",icon:Object(N.jsx)(gt.a,{}),disabled:!this.state.upload,onClick:function(){window.document.getElementById("file-upload").click()},ghost:!0}),Object(N.jsx)("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:this.handleUploadFile,multiple:!0})]})}),Object(N.jsx)("div",{className:"fs-header-right-item",children:Object(N.jsxs)(se.a,{title:"\u4e0a\u4f20\u6587\u4ef6\u5939",children:[Object(N.jsx)(O.a,{type:"primary",size:"small",icon:Object(N.jsx)(Ne.a,{}),disabled:!this.state.upload,onClick:function(){window.document.getElementById("dir-upload").click()},ghost:!0}),Object(N.jsx)("input",{type:"file",id:"dir-upload",style:{display:"none"},onChange:this.handleUploadDir,webkitdirectory:"",multiple:!0})]})}),Object(N.jsx)("div",{className:"fs-header-right-item",children:Object(N.jsx)(se.a,{title:"\u5237\u65b0",children:Object(N.jsx)(O.a,{type:"primary",size:"small",icon:Object(N.jsx)(vt.a,{}),onClick:this.refresh,ghost:!0})})}),Object(N.jsx)("div",{className:"fs-header-right-item",children:Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",size:"small",ghost:!0,danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=e.state.selectedRowKeys,a=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(wt,{style:{color:"#1890FF"},strong:!0,children:t.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});kt({icon:Object(N.jsx)(ze.a,{}),content:a,onOk:function(){var a=Object(o.a)(Object(i.a)().mark((function a(){var n;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0;case 1:if(!(n<t.length)){a.next=9;break}if(".."!==t[n]){a.next=4;break}return a.abrupt("continue",6);case 4:return a.next=6,e.delete(t[n]);case 6:n++,a.next=1;break;case 9:e.refresh();case 10:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),onCancel:function(){}})}})})})]})})]});return Object(N.jsxs)("div",{children:[Object(N.jsx)(w.a,{title:c,bordered:!0,size:"small",style:{minHeight:this.state.minHeight},children:Object(N.jsx)(de.a,{columns:t,rowSelection:n,dataSource:this.state.files,size:"small",pagination:!1,loading:this.state.loading,onRow:function(t){return{onDoubleClick:function(a){if(t.isDir||t.isLink)if(".."===t.path){var n=e.state.currentDirectory,s=n.substring(0,n.lastIndexOf("/"));e.loadFiles(s)}else e.loadFiles(t.path)}}}})}),this.state.mkdirVisible?Object(N.jsx)(te.a,{title:"\u521b\u5efa\u6587\u4ef6\u5939",visible:this.state.mkdirVisible,okButtonProps:{form:"mkdir-form",key:"submit",htmlType:"submit"},onOk:function(){e.mkdirFormRef.current.validateFields().then(function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mkdirFormRef.current.resetFields(),n={dir:e.state.currentDirectory+"/"+a.dir},s=pe.a.stringify(n),e.setState({confirmLoading:!0}),t.next=6,Y.post("/".concat(e.state.storageType,"/").concat(e.state.storageId,"/mkdir?").concat(s));case 6:1===(r=t.sent).code?(z.b.success("\u521b\u5efa\u6210\u529f"),e.loadFiles(e.state.currentDirectory)):z.b.error(r.message),e.setState({confirmLoading:!1,mkdirVisible:!1});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){}))},confirmLoading:this.state.confirmLoading,onCancel:function(){e.setState({mkdirVisible:!1})},children:Object(N.jsx)(je.a,{ref:this.mkdirFormRef,id:"mkdir-form",children:Object(N.jsx)(je.a.Item,{name:"dir",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0"}],children:Object(N.jsx)(ae.a,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0"})})})}):void 0,this.state.renameVisible?Object(N.jsx)(te.a,{title:"\u91cd\u547d\u540d",visible:this.state.renameVisible,okButtonProps:{form:"rename-form",key:"submit",htmlType:"submit"},onOk:function(){e.renameFormRef.current.validateFields().then(function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r,c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.renameFormRef.current.resetFields(),t.prev=1,(n=e.state.currentDirectory).endsWith("/")||(n+="/"),(s={oldName:e.state.currentFileKey,newName:n+a.newName}).oldName!==s.newName){t.next=8;break}return z.b.success("\u91cd\u547d\u540d\u6210\u529f"),t.abrupt("return");case 8:return r=pe.a.stringify(s),e.setState({confirmLoading:!0}),t.next=12,Y.post("/".concat(e.state.storageType,"/").concat(e.state.storageId,"/rename?").concat(r));case 12:1===(c=t.sent).code?(z.b.success("\u91cd\u547d\u540d\u6210\u529f"),e.refresh()):z.b.error(c.message);case 14:return t.prev=14,e.setState({confirmLoading:!1,renameVisible:!1}),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,,14,17]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){}))},confirmLoading:this.state.confirmLoading,onCancel:function(){e.setState({renameVisible:!1})},children:Object(N.jsx)(je.a,{id:"rename-form",ref:this.renameFormRef,initialValues:{newName:(r=this.state.currentFileKey,r.substring(r.lastIndexOf("/")+1,r.length))},children:Object(N.jsx)(je.a.Item,{name:"newName",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u7684\u540d\u79f0"}],children:Object(N.jsx)(ae.a,{autoComplete:"off",placeholder:"\u65b0\u7684\u540d\u79f0"})})})}):void 0,Object(N.jsx)(te.a,{title:"\u7f16\u8f91 "+this.state.fileName,className:"modal-no-padding",visible:this.state.editorVisible,destroyOnClose:!0,width:.8*window.innerWidth,centered:!0,okButtonProps:{form:"rename-form",key:"submit",htmlType:"submit"},onOk:this.edit,confirmLoading:this.state.confirmLoading,onCancel:this.hideEditor,children:Object(N.jsx)(yt.a,{language:"javascript",height:.8*window.innerHeight,theme:"vs-dark",value:this.state.fileContent,options:{selectOnLineNumbers:!0},editorDidMount:function(e,t){console.log("editorDidMount",e),e.focus()},onChange:function(t,a){console.log("onChange",t,a),e.setState({fileContent:t})}})})]})}}]),a}(n.Component),Ct=St,It=a(1262),Tt=(a(1225),function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={sessionId:void 0,stats:{uptime:0,load1:0,load5:0,load10:0,memTotal:0,memFree:0,memAvailable:0,memBuffers:0,memCached:0,swapTotal:0,swapFree:0,network:{},fileSystems:[],cpu:{user:0,system:0,nice:0,idle:0,ioWait:0,irq:0,softIrq:0,guest:0}},prevStats:{},interval:void 0},e.getStats=Object(o.a)(Object(i.a)().mark((function t(){var a,n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/sessions/".concat(e.state.sessionId,"/stats"));case 2:if(1===(a=t.sent).code){t.next=5;break}return t.abrupt("return");case 5:n=a.data,e.setState({stats:n,prevStats:e.state.stats});case 7:case"end":return t.stop()}}),t)}))),e.addInterval=function(){var t=setInterval(e.getStats,5e3);e.setState({interval:t})},e.delInterval=function(){e.state.interval&&(clearInterval(e.state.interval),e.setState({interval:void 0}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.onRef(this);var t=this.props.sessionId;this.setState({sessionId:t},(function(){e.getStats()})),this.addInterval()}},{key:"render",value:function(){var e=this,t=parseInt((this.state.stats.uptime/1e3/60/60/24).toString()),a=(100*(this.state.stats.memTotal-this.state.stats.memAvailable)/this.state.stats.memTotal).toFixed(2),n=this.state.stats.network,r=this.state.stats.fileSystems,c=0;return 0!==this.state.stats.swapTotal&&(c=(100*(this.state.stats.swapTotal-this.state.stats.swapFree)/this.state.stats.swapTotal).toFixed(2)),Object(N.jsxs)("div",{children:[Object(N.jsxs)(It.b,{title:"\u7cfb\u7edf\u4fe1\u606f",column:4,children:[Object(N.jsx)(It.b.Item,{label:"\u4e3b\u673a\u540d\u79f0",children:this.state.stats.hostname}),Object(N.jsxs)(It.b.Item,{label:"\u8fd0\u884c\u65f6\u957f",children:[t,"\u5929"]})]}),Object(N.jsx)(v.a,{justify:"center",align:"middle",children:Object(N.jsx)(y.a,{children:Object(N.jsxs)(It.b,{title:"\u8d1f\u8f7d",column:4,children:[Object(N.jsx)(It.b.Item,{label:"Load1",children:Object(N.jsx)("div",{className:"description-content",children:Object(N.jsx)(lt.a,{percent:this.state.stats.load1,steps:20,size:"small"})})}),Object(N.jsx)(It.b.Item,{label:"Load5",children:Object(N.jsx)("div",{className:"description-content",children:Object(N.jsx)(lt.a,{percent:this.state.stats.load5,steps:20,size:"small"})})}),Object(N.jsx)(It.b.Item,{label:"Load10",children:Object(N.jsx)("div",{className:"description-content",children:Object(N.jsx)(lt.a,{percent:this.state.stats.load10,steps:20,size:"small"})})})]})})}),Object(N.jsxs)(It.b,{title:"CPU",column:4,children:[Object(N.jsxs)(It.b.Item,{label:"\u7528\u6237",children:[this.state.stats.cpu.user.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"\u7cfb\u7edf",children:[this.state.stats.cpu.system.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"\u7a7a\u95f2",children:[this.state.stats.cpu.idle.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"IO\u7b49\u5f85",children:[this.state.stats.cpu.ioWait.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"\u786c\u4e2d\u65ad",children:[this.state.stats.cpu.irq.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"\u8f6f\u4e2d\u65ad",children:[this.state.stats.cpu.softIrq.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"nice",children:[this.state.stats.cpu.nice.toFixed(2),"%"]}),Object(N.jsxs)(It.b.Item,{label:"guest",children:[this.state.stats.cpu.guest.toFixed(2),"%"]})]}),Object(N.jsxs)(It.b,{title:"\u5185\u5b58",column:4,children:[Object(N.jsx)(It.b.Item,{label:"\u7269\u7406\u5185\u5b58\u5927\u5c0f",children:J(this.state.stats.memTotal)}),Object(N.jsx)(It.b.Item,{label:"\u5269\u4f59\u5185\u5b58\u5927\u5c0f",children:J(this.state.stats.memFree)}),Object(N.jsx)(It.b.Item,{label:"\u53ef\u7528\u5185\u5b58\u5927\u5c0f",children:J(this.state.stats.memAvailable)}),Object(N.jsx)(It.b.Item,{label:"\u4f7f\u7528\u5360\u6bd4",children:Object(N.jsx)("div",{className:"description-content",children:Object(N.jsx)(lt.a,{percent:a,steps:20,size:"small"})})}),Object(N.jsxs)(It.b.Item,{label:"Buffers/Cached",children:[J(this.state.stats.memBuffers)," / ",J(this.state.stats.memCached)]}),Object(N.jsx)(It.b.Item,{label:"\u4ea4\u6362\u5185\u5b58\u5927\u5c0f",children:J(this.state.stats.swapTotal)}),Object(N.jsx)(It.b.Item,{label:"\u4ea4\u6362\u5185\u5b58\u5269\u4f59",children:J(this.state.stats.swapFree)}),Object(N.jsx)(It.b.Item,{label:"\u4f7f\u7528\u5360\u6bd4",children:Object(N.jsx)("div",{className:"description-content",children:Object(N.jsx)(lt.a,{percent:c,steps:20,size:"small"})})})]}),Object(N.jsx)(It.b,{title:"\u78c1\u76d8",column:4,children:r.map((function(e,t){return Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)(It.b.Item,{label:"\u6302\u8f7d\u8def\u5f84",children:e.mountPoint},"\u6302\u8f7d\u8def\u5f84"+t),Object(N.jsx)(It.b.Item,{label:"\u5df2\u7ecf\u4f7f\u7528",children:J(e.used)},"\u5df2\u7ecf\u4f7f\u7528"+t),Object(N.jsx)(It.b.Item,{label:"\u5269\u4f59\u7a7a\u95f4",children:J(e.free)},"\u5269\u4f59\u7a7a\u95f4"+t),Object(N.jsx)(It.b.Item,{label:"\u4f7f\u7528\u5360\u6bd4",children:Object(N.jsx)("div",{className:"description-content",children:Object(N.jsx)(lt.a,{percent:(100*e.used/(e.used+e.free)).toFixed(2),steps:20,size:"small"})})},"\u4f7f\u7528\u5360\u6bd4"+t)]},"\u78c1\u76d8"+t)}))}),Object(N.jsx)(It.b,{title:"\u7f51\u7edc",column:4,children:Object.keys(n).map((function(t,a){var r=e.state.prevStats.network,c=0,i=0;return void 0!==r[t]&&(c=(n[t].rx-r[t].rx)/5),void 0!==r[t]&&(i=(n[t].tx-r[t].tx)/5),Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)(It.b.Item,{label:"\u7f51\u5361",children:t},"\u7f51\u5361"+a),Object(N.jsx)(It.b.Item,{label:"IPv4",children:n[t].ipv4},"IPv4"+a),Object(N.jsxs)(It.b.Item,{label:"\u63a5\u6536",children:[J(n[t].rx)," \xa0 ",J(c),"/\u79d2"]},"\u63a5\u6536"+a),Object(N.jsxs)(It.b.Item,{label:"\u53d1\u9001",children:[J(n[t].tx)," \xa0 ",J(i),"/\u79d2"]},"\u53d1\u9001"+a)]},"\u7f51\u7edc"+a)}))})]})}}]),a}(n.Component)),Pt=Tt,Rt=a(661),Ft=ae.a.TextArea,qt=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).clipboardFormRef=s.a.createRef(),e.statsRef=void 0,e.error=!1,e.state={session:{},sessionId:"",client:void 0,scale:1,clientState:0,clipboardVisible:!1,clipboardText:"",containerOverflow:"hidden",containerWidth:1024,containerHeight:768,uploadAction:"",uploadHeaders:{},keyboard:{},protocol:"",confirmLoading:!1,uploadVisible:!1,uploadLoading:!1,startTime:new Date,fullScreen:!1,fullScreenBtnText:"\u8fdb\u5165\u5168\u5c4f",sink:void 0,commands:[],showFileSystem:!1,external:!1,fixedSize:!1},e.onTunnelStateChange=function(e){console.log(e),e===Ze.a.Tunnel.State.CLOSED&&console.log("web socket \u5df2\u5173\u95ed")},e.updateSessionStatus=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions/".concat(t,"/connect"));case 2:1!==(a=e.sent).code&&z.b.error(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.getCommands=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/commands");case 2:if(1===(a=t.sent).code){t.next=6;break}return z.b.error(a.message),t.abrupt("return");case 6:e.setState({commands:a.data});case 7:case"end":return t.stop()}}),t)}))),e.onClientStateChange=function(t){switch(e.setState({clientState:t}),t){case 0:z.b.destroy(),z.b.loading("\u6b63\u5728\u521d\u59cb\u5316\u4e2d...",0);break;case 1:z.b.destroy(),z.b.loading("\u6b63\u5728\u52aa\u529b\u8fde\u63a5\u4e2d...",0);break;case 2:z.b.destroy(),z.b.loading("\u6b63\u5728\u7b49\u5f85\u670d\u52a1\u5668\u54cd\u5e94...",0);break;case 3:e.onWindowResize(null),te.a.destroyAll(),z.b.destroy(),z.b.success("\u8fde\u63a5\u6210\u529f"),e.updateSessionStatus(e.state.sessionId).then((function(e){})),"ssh"!==e.state.protocol||e.state.external||e.getCommands();break;case 4:default:break;case 5:e.error||e.showMessage("\u8fde\u63a5\u5df2\u5173\u95ed")}},e.onError=function(t){switch(e.error=!0,console.log("\u901a\u9053\u5f02\u5e38\u3002",t),t.code){case 256:e.showMessage("\u672a\u652f\u6301\u7684\u8bbf\u95ee");break;case 512:e.showMessage("\u8fdc\u7a0b\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u68c0\u67e5\u76ee\u6807\u8bbe\u5907\u80fd\u5426\u6b63\u5e38\u8bbf\u95ee\u3002");break;case 513:e.showMessage("\u670d\u52a1\u5668\u5fd9\u788c");break;case 514:e.showMessage("\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6");break;case 515:e.showMessage("\u8fdc\u7a0b\u670d\u52a1\u5f02\u5e38");break;case 516:e.showMessage("\u8d44\u6e90\u672a\u627e\u5230");break;case 517:e.showMessage("\u8d44\u6e90\u51b2\u7a81");break;case 518:e.showMessage("\u8d44\u6e90\u5df2\u5173\u95ed");break;case 519:e.showMessage("\u8fdc\u7a0b\u670d\u52a1\u672a\u627e\u5230");break;case 520:e.showMessage("\u8fdc\u7a0b\u670d\u52a1\u4e0d\u53ef\u7528");break;case 521:e.showMessage("\u4f1a\u8bdd\u51b2\u7a81");break;case 522:e.showMessage("\u4f1a\u8bdd\u8fde\u63a5\u8d85\u65f6");break;case 523:e.showMessage("\u4f1a\u8bdd\u5df2\u5173\u95ed");break;case 768:e.showMessage("\u7f51\u7edc\u4e0d\u53ef\u8fbe");break;case 769:e.showMessage("\u670d\u52a1\u5668\u5bc6\u7801\u9a8c\u8bc1\u5931\u8d25");break;case 771:e.showMessage("\u5ba2\u6237\u7aef\u88ab\u7981\u6b62");break;case 776:e.showMessage("\u5ba2\u6237\u7aef\u8fde\u63a5\u8d85\u65f6");break;case 781:e.showMessage("\u5ba2\u6237\u7aef\u5f02\u5e38");break;case 783:e.showMessage("\u9519\u8bef\u7684\u8bf7\u6c42\u7c7b\u578b");break;case 800:e.showMessage("\u4f1a\u8bdd\u4e0d\u5b58\u5728");break;case 801:e.showMessage("\u521b\u5efa\u96a7\u9053\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5Guacd\u670d\u52a1\u662f\u5426\u6b63\u5e38\u3002");break;case 802:e.showMessage("\u7ba1\u7406\u5458\u5f3a\u5236\u5173\u95ed\u4e86\u6b64\u4f1a\u8bdd");break;default:t.message?e.showMessage(Rt.a.decode(t.message)):e.showMessage("\u672a\u77e5\u9519\u8bef\u3002")}},e.clientClipboardReceived=function(t,a){var n;if("0"!==e.state.session.copy)if(/^text\//.exec(a)){n=new Ze.a.StringReader(t);var s="";n.ontext=function(e){s+=e},n.onend=Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({clipboardText:s},(function(){})),!navigator.clipboard){t.next=4;break}return t.next=4,navigator.clipboard.writeText(s);case 4:case"end":return t.stop()}}),t)})))}else(n=new Ze.a.BlobReader(t,a)).onend=function(){e.setState({clipboardText:n.getBlob()})}},e.onKeyDown=function(t){if(e.state.client.sendKeyEvent(1,t),65288===t)return!1},e.onKeyUp=function(t){e.state.client.sendKeyEvent(0,t)},e.fullScreen=function(){e.state.fullScreen?(G(),e.setState({fullScreen:!1,fullScreenBtnText:"\u8fdb\u5165\u5168\u5c4f"})):(H(document.documentElement),e.setState({fullScreen:!0,fullScreenBtnText:"\u9000\u51fa\u5168\u5c4f"})),e.focus()},e.onWindowResize=function(t){if(e.state.client&&!e.state.fixedSize){var a=e.state.client.getDisplay(),n=e.state.scale;a.scale(n);var s=window.innerWidth,r=window.innerHeight;e.state.client.sendSize(s/n,r/n),e.setState({containerWidth:s,containerHeight:r}),e.resize(e.state.sessionId,s,r).then((function(e){}))}},e.resize=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a,n){var s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions/".concat(t,"/resize?width=").concat(a,"&height=").concat(n));case 2:1!==(s=e.sent).code&&z.b.error(s.message);case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),e.onWindowFocus=function(t){if(navigator.clipboard&&3===e.state.clientState)try{navigator.clipboard.readText().then((function(t){e.sendClipboard({data:t,type:"text/plain"})}))}catch(t){}},e.focus=function(){e.state.sink&&e.state.sink.focus()},e.sendCombinationKey=function(t){for(var a=0;a<t.length;a++)e.state.client.sendKeyEvent(1,t[a]);for(var n=0;n<t.length;n++)e.state.client.sendKeyEvent(0,t[n])},e.writeCommand=function(t){var a=e.state.client.createPipeStream("text/plain","STDIN"),n=new Ze.a.StringWriter(a);n.sendText(t),n.sendEnd(),e.focus()},e.onRef=function(t){e.statsRef=t},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t,a,n,s,r,c,o,l,d,u,j;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(this.props.location.search),a=t.get("assetId"),document.title=t.get("assetName"),n=t.get("protocol"),s=t.get("width"),r=t.get("height"),c=!1,s&&r?c=!0:(s=window.innerWidth,r=window.innerHeight),o=t.get("shareSessionId"),l=!1,!o||""===o){e.next=19;break}return L(o),l=!0,e.next=15,this.getShareSession(o);case 15:if(d=e.sent){e.next=18;break}return e.abrupt("return");case 18:a=d.assetId;case 19:return e.next=21,this.createSession(a);case 21:if(u=e.sent){e.next=24;break}return e.abrupt("return");case 24:if(j=u.id,!E(j)){e.next=27;break}return e.abrupt("return");case 27:this.setState({session:u,sessionId:j,protocol:n,showFileSystem:"1"===u.fileSystem,external:l,fixedSize:c,containerWidth:s,containerHeight:r}),this.renderDisplay(j,n,s,r),window.addEventListener("resize",this.onWindowResize),window.addEventListener("beforeunload",this.handleUnload),window.onfocus=this.onWindowFocus;case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.state.client&&this.state.client.disconnect(),window.removeEventListener("beforeunload",this.handleUnload)}},{key:"sendClipboard",value:function(e){if("0"!==this.state.session.paste){var t,a=this.state.client.createClipboardStream(e.type);"string"===typeof e.data?((t=new Ze.a.StringWriter(a)).sendText(e.data),t.sendEnd()):((t=new Ze.a.BlobWriter(a)).oncomplete=function(){t.sendEnd()},t.sendBlob(e.data)),this.setState({clipboardText:e.data}),this.state.protocol,e.data&&e.data.length}}},{key:"showMessage",value:function(e){z.b.destroy(),te.a.confirm({title:"\u63d0\u793a",icon:Object(N.jsx)(ze.a,{}),content:e,centered:!0,okText:"\u91cd\u65b0\u8fde\u63a5",cancelText:"\u5173\u95ed\u9875\u9762",onOk:function(){window.location.reload()},onCancel:function(){window.close()}})}},{key:"createSession",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions?assetId=".concat(t,"&mode=guacd"));case 2:if(1===(a=e.sent).code){e.next=6;break}return this.showMessage(a.message),e.abrupt("return",void 0);case 6:return e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getShareSession",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/share-sessions/".concat(t));case 2:if(1===(a=e.sent).code){e.next=6;break}return this.showMessage(a.message),e.abrupt("return",void 0);case 6:return e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderDisplay",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a,n,s){var r,c,o,l,d,u,j,h,b,p,m,O;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=new Ze.a.WebSocketTunnel("".concat(D,"/sessions/").concat(t,"/tunnel"))).onstatechange=this.onTunnelStateChange,(c=new Ze.a.Client(r)).sendClipboard=this.sendClipboard,c.onclipboard=this.clientClipboardReceived,c.onstatechange=this.onClientStateChange,c.onerror=this.onError,r.onerror=this.onError,o=document.getElementById("display"),l=c.getDisplay().getElement(),o.appendChild(l),d=1,u=96,"ssh"!==a&&"telnet"!==a||(u*=2,d=.5),j=V(),h={width:n,height:s,dpi:u,"X-Auth-Token":j},b=pe.a.stringify(h),c.connect(b),window.onunload=function(){c.disconnect()},(p=new Ze.a.Mouse(l)).onmousedown=p.onmouseup=function(e){c.sendMouseState(e)},p.onmousemove=function(e){e.x=e.x/d,e.y=e.y/d,c.sendMouseState(e)},m=new Ze.a.InputSink,o.appendChild(m.getElement()),m.focus(),(O=new Ze.a.Keyboard(m.getElement())).onkeydown=this.onKeyDown,O.onkeyup=this.onKeyUp,this.setState({client:c,scale:d,keyboard:O,sink:m});case 29:case"end":return e.stop()}}),e,this)})));return function(t,a,n,s){return e.apply(this,arguments)}}()},{key:"handleUnload",value:function(e){var t="\u8981\u79bb\u5f00\u7f51\u7ad9\u5417\uff1f";return(e||window.event).returnValue=t,t}},{key:"render",value:function(){var e=this,t=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65507","65513","65535"])},children:"Ctrl+Alt+Delete"}),Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65507","65513","65288"])},children:"Ctrl+Alt+Backspace"}),Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65515","100"])},children:"Windows+D"}),Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65515","101"])},children:"Windows+E"}),Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65515","114"])},children:"Windows+R"}),Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65515","120"])},children:"Windows+X"}),Object(N.jsx)(b.a.Item,{onClick:function(){return e.sendCombinationKey(["65515"])},children:"Windows"})]}),a=this.state.commands.map((function(t){return Object(N.jsx)(se.a,{placement:"left",title:t.content,color:"blue",children:Object(N.jsx)(b.a.Item,{onClick:function(){e.writeCommand(t.content)},children:t.name},"i-"+t.id)},"t-"+t.id)})),n=Object(N.jsx)(b.a,{children:a});return Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{className:"container",style:{overflow:this.state.containerOverflow,width:this.state.containerWidth,height:this.state.containerHeight,margin:"0 auto"},children:Object(N.jsx)("div",{id:"display"})}),Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:50,right:50},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(tt.a,{}),disabled:3!==this.state.clientState,onClick:function(){e.fullScreen()}})})}),"1"===this.state.session.copy||"1"===this.state.session.paste?Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:50,right:100},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(at.a,{}),disabled:3!==this.state.clientState,onClick:function(){e.setState({clipboardVisible:!0})}})})}):void 0,"vnc"===this.state.protocol?Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:100,right:100},children:Object(N.jsx)(m.a,{overlay:t,trigger:["click"],placement:"bottomLeft",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(nt.a,{}),disabled:3!==this.state.clientState})})})})}):void 0,"rdp"===this.state.protocol&&this.state.showFileSystem?Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:100,right:50},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(st.a,{}),disabled:3!==this.state.clientState,onClick:function(){e.setState({fileSystemVisible:!0})}})})})}):void 0,"rdp"===this.state.protocol?Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:100,right:100},children:Object(N.jsx)(m.a,{overlay:t,trigger:["click"],placement:"bottomLeft",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(nt.a,{}),disabled:3!==this.state.clientState})})})})}):void 0,"ssh"===this.state.protocol?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:100,right:50},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(st.a,{}),disabled:3!==this.state.clientState,onClick:function(){e.setState({fileSystemVisible:!0})}})})}),Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:100,right:100},children:Object(N.jsx)(m.a,{overlay:n,trigger:["click"],placement:"bottomLeft",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(rt.a,{}),disabled:3!==this.state.clientState})})})}),Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:150,right:100,zIndex:this.state.enterBtnIndex},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(ct.a,{}),onClick:function(){e.setState({statsVisible:!0}),e.statsRef&&e.statsRef.addInterval()}})})})]}):void 0,Object(N.jsx)(et.a,{title:"\u6587\u4ef6\u7ba1\u7406",placement:"right",width:.8*window.innerWidth,closable:!0,onClose:function(){e.focus(),e.setState({fileSystemVisible:!1})},visible:this.state.fileSystemVisible,children:Object(N.jsx)(Ct,{storageId:this.state.sessionId,storageType:"sessions",upload:"1"===this.state.session.upload,download:"1"===this.state.session.download,delete:"1"===this.state.session.delete,rename:"1"===this.state.session.rename,edit:"1"===this.state.session.edit,minHeight:window.innerHeight-103})}),Object(N.jsx)(et.a,{title:"\u72b6\u6001\u4fe1\u606f",placement:"right",width:.8*window.innerWidth,closable:!0,onClose:function(){e.setState({statsVisible:!1}),e.focus(),e.statsRef&&e.statsRef.delInterval()},visible:this.state.statsVisible,children:Object(N.jsx)(Pt,{sessionId:this.state.sessionId,onRef:this.onRef})}),this.state.clipboardVisible?Object(N.jsx)(te.a,{title:"\u526a\u8d34\u677f",maskClosable:!1,visible:this.state.clipboardVisible,onOk:function(){e.clipboardFormRef.current.validateFields().then((function(t){var a=t.clipboard;e.sendClipboard({data:a,type:"text/plain"}),e.setState({clipboardText:a,clipboardVisible:!1})})).catch((function(e){}))},confirmLoading:this.state.confirmLoading,onCancel:function(){e.focus(),e.setState({clipboardVisible:!1})},children:Object(N.jsx)(je.a,{ref:this.clipboardFormRef,initialValues:{clipboard:this.state.clipboardText},children:Object(N.jsx)(je.a.Item,{name:"clipboard",rules:[{required:!1}],children:Object(N.jsx)(Ft,{id:"clipboard",rows:10})})})}):void 0]})}}]),a}(n.Component),Dt=qt,zt=a(1252),Nt=function(e){var t=e.title,a=e.visible,n=e.handleOk,s=e.handleCancel,r=e.confirmLoading,c=e.model,i=Oe.Form.useForm(),o=Object(me.a)(i,1)[0];return Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){o.validateFields().then((function(e){o.resetFields(),n(e)})).catch((function(e){}))},onCancel:s,confirmLoading:r,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:o},{labelCol:{span:6},wrapperCol:{span:14}}),{},{initialValues:c,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u767b\u5f55\u8d26\u6237",name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u8d26\u6237"}],children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u767b\u5f55\u8d26\u6237"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7528\u6237\u6635\u79f0",name:"nickname",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u6635\u79f0"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u6635\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7528\u6237\u7c7b\u578b",name:"type",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7528\u6237\u89d2\u8272"}],children:Object(N.jsxs)(Oe.Radio.Group,{children:[Object(N.jsx)(Oe.Radio,{value:"user",children:"\u666e\u901a\u7528\u6237"}),Object(N.jsx)(Oe.Radio,{value:"admin",children:"\u7ba1\u7406\u7528\u6237"})]})}),Object(N.jsx)(Oe.Form.Item,{label:"\u90ae\u7bb1\u8d26\u53f7",name:"mail",rules:[{required:!1,type:"email",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u8d26\u53f7"}],children:Object(N.jsx)(Oe.Input,{type:"email",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u8d26\u53f7"})}),t.indexOf("\u65b0\u589e")>-1?Object(N.jsx)(Oe.Form.Item,{label:"\u767b\u5f55\u5bc6\u7801",name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801"}],children:Object(N.jsx)(Oe.Input,{type:"password",autoComplete:"new-password",placeholder:"\u8f93\u5165\u767b\u5f55\u5bc6\u7801"})}):null]}))})},Lt=a(1293),Vt=a(1294),Bt=a(1295),Mt=a(660),Kt=ae.a.Search,At=h.a.Content,Wt=ne.a.Title,Et=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.inputRefOfIp=s.a.createRef(),e.changeOwnerFormRef=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10,protocol:""},loading:!1,tags:[],model:{},selectedRowKeys:[],selectedRows:[],delBtnLoading:!1,changeOwnerModalVisible:!1,changeSharerModalVisible:!1,changeOwnerConfirmLoading:!1,changeSharerConfirmLoading:!1,users:[],selected:{},totalSelectedRows:[],sharer:"",strategies:[],strategyId:void 0,sharers:[]},e.getStrategyByAssetId=function(e,t,a,n){if(void 0===n)for(var s=0;s<t.length;s++)if(t[s].resourceId===a){n=t[s].strategyId;break}if(n)for(var r=0;r<e.length;r++)if(e[r].id===n)return e[r]},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleSearchByIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,ip:t});e.loadTableData(a)},e.handleTagsChange=function(t){console.log(t);var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,tags:t.join(",")});e.loadTableData(a)},e.handleSearchByProtocol=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,protocol:t});e.loadTableData(a)},e.unSelectRow=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r,c,o;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.sharer,s=e.state.userGroupId,t.next=4,Y.post("/resource-sharers/remove-resources",{userGroupId:s,userId:n,resourceType:"asset",resourceIds:[a]});case 4:1===(r=t.sent).code?z.b.success("\u64cd\u4f5c\u6210\u529f",3):z.b.error(r.message,10),c=e.state.selectedRowKeys.filter((function(e){return e!==a})),o=e.state.totalSelectedRows.filter((function(e){return e.id!==a})),e.setState({selectedRowKeys:c,totalSelectedRows:o});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({sharer:this.props.sharer,userGroupId:this.props.userGroupId}),this.init(this.props.sharer,this.props.userGroupId),this.loadTableData();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a){var n,s,r,c,o,l,d,u,j,h,b,p,m,O,x;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={pageIndex:1,pageSize:1e3,sharer:t,userGroupId:a},s=pe.a.stringify(n),r=Y.get("/strategies"),c=Y.get("/resource-sharers"),o=Y.get("/assets/paging?".concat(s)),l=Y.get("/tags"),e.next=8,r;case 8:return d=e.sent,e.next=11,c;case 11:return u=e.sent,e.next=14,o;case 14:return j=e.sent,e.next=17,l;case 17:if(h=e.sent,b=[],1===d.code&&(b=d.data,this.setState({strategies:b})),p=[],1===u.code&&(p=u.data,this.setState({sharers:p})),1===j.code){for(m=j.data.items,O=0;O<m.length;O++)x=m[O].id,m[O].strategy=this.getStrategyByAssetId(b,p,x);this.setState({totalSelectedRows:m})}1===h.code&&this.setState({tags:h.data});case 24:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r,c,o,l;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/assets/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=this.state.sharer,c=n.items.map((function(e){var t=!1;return r===e.owner&&(t=!0),Object(g.a)(Object(g.a)({},e),{},{key:e.id,disabled:t})})),o=this.state.totalSelectedRows,l=o.map((function(e){return e.id})),this.setState({items:c,total:n.total,queryParams:t,loading:!1,selectedRowKeys:l}),e.finish(13);case 20:case"end":return e.stop()}}),e,this,[[4,11,13,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"name",key:"name",render:function(e,t){var a=e;return a&&a.length>15&&(a=a.substring(0,15)+" ..."),Object(N.jsx)(se.a,{placement:"topLeft",title:e,children:a})}},{title:"\u534f\u8bae",dataIndex:"protocol",key:"protocol",render:function(e,t){var a="".concat(t.ip+":"+t.port);return Object(N.jsx)(se.a,{title:a,children:Object(N.jsx)(re.a,{color:Le[e],children:e})})}},{title:"\u6807\u7b7e",dataIndex:"tags",key:"tags",render:function(e){if(!E(e)){for(var t=[],a=e.split(","),n=0;n<a.length;n++)"-"!==e[n]&&t.push(Object(N.jsx)(re.a,{children:a[n]},a[n]));return t}}},{title:"\u72b6\u6001",dataIndex:"active",key:"active",render:function(e){return e?Object(N.jsx)(se.a,{title:"\u8fd0\u884c\u4e2d",children:Object(N.jsx)(ce.a,{status:"processing",text:"\u8fd0\u884c\u4e2d"})}):Object(N.jsx)(se.a,{title:"\u4e0d\u53ef\u7528",children:Object(N.jsx)(ce.a,{status:"error",text:"\u4e0d\u53ef\u7528"})})}},{title:"\u6240\u6709\u8005",dataIndex:"ownerName",key:"ownerName"},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},getCheckboxProps:function(e){return{disabled:e.disabled}}},s=!1;if(a.length>0)for(var r=this.state.totalSelectedRows.map((function(e){return e.id})),c=0;c<a.length;c++){var l=a[c];if(!r.includes(l)){s=!0;break}}var d=function(e){return"1"===e?Object(N.jsx)(re.a,{color:"green",children:"\u5141\u8bb8"}):Object(N.jsx)(re.a,{color:"red",children:"\u7981\u6b62"})};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(v.a,{gutter:16,children:[Object(N.jsxs)(y.a,{span:6,children:[Object(N.jsx)(Wt,{level:3,children:"\u6388\u6743\u7b56\u7565"}),Object(N.jsx)(oe.a,{style:{minWidth:200},onChange:function(t){e.setState({strategyId:t})},children:this.state.strategies.map((function(e){return Object(N.jsx)(oe.a.Option,{children:e.name},e.id)}))})]}),Object(N.jsxs)(y.a,{span:18,children:[Object(N.jsx)(Wt,{level:3,children:"\u5df2\u6388\u6743\u8d44\u4ea7\u5217\u8868"}),Object(N.jsx)("div",{children:this.state.totalSelectedRows.map((function(t){var a="\u300c\u672a\u914d\u7f6e\u7b56\u7565\u300d",n="";return void 0!==t.strategy&&(a=t.strategy.name,n=Object(N.jsxs)("div",{children:[Object(N.jsxs)("p",{children:["\u4e0a\u4f20\uff1a",d(t.strategy.upload)]}),Object(N.jsxs)("p",{children:["\u4e0b\u8f7d\uff1a",d(t.strategy.download)]}),Object(N.jsxs)("p",{children:["\u7f16\u8f91\uff1a",d(t.strategy.edit)]}),Object(N.jsxs)("p",{children:["\u5220\u9664\uff1a",d(t.strategy.delete)]}),Object(N.jsxs)("p",{children:["\u91cd\u547d\u540d\uff1a",d(t.strategy.rename)]}),Object(N.jsxs)("p",{children:["\u590d\u5236\uff1a",d(t.strategy.copy)]}),Object(N.jsxs)("p",{children:["\u7c98\u8d34\uff1a",d(t.strategy.paste)]})]})),Object(N.jsx)(Mt.a,{content:n,title:a,children:Object(N.jsx)(re.a,{color:Le[t.protocol],closable:!0,onClose:function(a){a.preventDefault(),e.unSelectRow(t.id)},children:[t.name,a].join(":")},t.id)})}))})]})]}),Object(N.jsx)(le.a,{}),Object(N.jsxs)(At,{className:"site-layout-background",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:4,children:Object(N.jsx)(Wt,{level:3,children:"\u5168\u90e8\u8d44\u4ea7\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:20,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Kt,{ref:this.inputRefOfName,placeholder:"\u8d44\u4ea7\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName,style:{width:200}}),Object(N.jsx)(Kt,{ref:this.inputRefOfIp,placeholder:"\u8d44\u4ea7IP",allowClear:!0,onSearch:this.handleSearchByIp,style:{width:200}}),Object(N.jsx)(oe.a,{mode:"multiple",allowClear:!0,placeholder:"\u8d44\u4ea7\u6807\u7b7e",onChange:this.handleTagsChange,style:{minWidth:150},children:this.state.tags.map((function(e){if("-"!==e)return Object(N.jsx)(oe.a.Option,{children:e},e)}))}),Object(N.jsxs)(oe.a,{onChange:this.handleSearchByProtocol,value:this.state.queryParams.protocol?this.state.queryParams.protocol:"",style:{width:100},children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u534f\u8bae"}),Object(N.jsx)(oe.a.Option,{value:"rdp",children:"rdp"}),Object(N.jsx)(oe.a.Option,{value:"ssh",children:"ssh"}),Object(N.jsx)(oe.a.Option,{value:"vnc",children:"vnc"}),Object(N.jsx)(oe.a.Option,{value:"telnet",children:"telnet"})]}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.inputRefOfIp.current.setValue(""),e.loadTableData(Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:10,protocol:""}))}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6dfb\u52a0\u6388\u6743",children:Object(N.jsx)(O.a,{type:"primary",disabled:!s,icon:Object(N.jsx)(Fe.a,{}),onClick:Object(o.a)(Object(i.a)().mark((function t(){var a,n,s,r,c,o,l,d,u,j;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.state.totalSelectedRows,n=a.map((function(e){return e.id})),s=e.state.selectedRows,r=[],c=0;case 5:if(!(c<s.length)){t.next=15;break}if(o=s[c],!n.includes(o.id)){t.next=9;break}return t.abrupt("continue",12);case 9:o.strategy=e.getStrategyByAssetId(e.state.strategies,e.state.sharers,o.id,e.state.strategyId),a.push(o),r.push(o.id);case 12:c++,t.next=5;break;case 15:return l=e.state.sharer,d=e.state.userGroupId,u=e.state.strategyId,t.next=20,Y.post("/resource-sharers/add-resources",{userGroupId:d,userId:l,strategyId:u,resourceType:"asset",resourceIds:r});case 20:if(1!==(j=t.sent).code){t.next=28;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({totalSelectedRows:a}),t.next=26,e.loadTableData();case 26:t.next=29;break;case 28:z.b.error(j.message,10);case 29:case"end":return t.stop()}}),t)})))})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading},"assets-table")]},"page-content")]})}}]),a}(n.Component),Ut=Et,Ht=te.a.confirm,Gt=ae.a.Search,Jt=ne.a.Title,Xt=ne.a.Text,$t=h.a.Content,Yt=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfNickname=s.a.createRef(),e.inputRefOfUsername=s.a.createRef(),e.inputRefOfMail=s.a.createRef(),e.changePasswordFormRef=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,model:null,selectedRowKeys:[],delBtnLoading:!1,assetVisible:!1,changePasswordVisible:!1,changePasswordConfirmLoading:!1,selectedRow:{}},e.handleChangPage=function(t,a){var n=e.state.queryParams;n.pageIndex=t,n.pageSize=a,e.setState({queryParams:n}),e.loadTableData(n)},e.handleCancelModal=function(){e.setState({modalVisible:!1,modalTitle:""})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),!a.id){t.next=15;break}return t.next=4,Y.put("/users/"+a.id,a);case 4:if(1!==(n=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(n.message,10);case 13:t.next=26;break;case 15:return t.next=17,Y.post("/users",a);case 17:if(1!==(s=t.sent).code){t.next=25;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=23,e.loadTableData(e.state.queryParams);case 23:t.next=26;break;case 25:z.b.error(s.message,10);case 26:e.setState({modalConfirmLoading:!1});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleSearchByUsername=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,username:t});e.loadTableData(a)},e.handleSearchByNickname=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,nickname:t});e.loadTableData(a)},e.handleSearchByMail=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,mail:t});e.loadTableData(a)},e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/users/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleChangePassword=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({changePasswordConfirmLoading:!0}),(n=new FormData).append("password",a.password),t.next=5,Y.post("/users/".concat(e.state.selectedRow.id,"/change-password"),n);case 5:1===(s=t.sent).code?z.b.success("\u64cd\u4f5c\u6210\u529f",3):z.b.error(s.message,10),e.setState({changePasswordConfirmLoading:!1,changePasswordVisible:!1});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e.changeUserStatus=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n,s){var r,c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.state.items,t.prev=1,r[s].statusLoading=!0,e.setState({items:r}),t.next=6,Y.patch("/users/".concat(a,"/status?status=").concat(n?"enabled":"disabled"));case 6:if(1===(c=t.sent).code){t.next=10;break}return z.b.error(c.message),t.abrupt("return");case 10:e.loadTableData(e.state.queryParams);case 11:return t.prev=11,r[s].statusLoading=!1,e.setState({items:r}),t.finish(11);case 15:case"end":return t.stop()}}),t,null,[[1,,11,15]])})));return function(e,a,n){return t.apply(this,arguments)}}(),e.resetTOTP=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.state.items,t.prev=1,s[n].resetTOTPLoading=!0,e.setState({items:s}),t.next=6,Y.post("/users/".concat(a,"/reset-totp"));case 6:1===(r=t.sent).code?(z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.loadTableData()):z.b.error(r.message,10);case 8:return t.prev=8,s[n].resetTOTPLoading=!1,e.setState({items:s}),t.finish(8);case 12:case"end":return t.stop()}}),t,null,[[1,,8,12]])})));return function(e,a){return t.apply(this,arguments)}}(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/users/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message,10);case 9:return e.prev=9,this.setState({items:n.items,total:n.total,queryParams:t,loading:!1}),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[4,,9,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t,a){var n=this;Ht({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u7528\u6237\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){n.delete(e,a)}})}},{key:"showModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setState({model:t,modalVisible:!0,modalTitle:e})}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a){var n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.items,e.prev=1,n[a].delLoading=!0,this.setState({items:n}),e.next=6,Y.delete("/users/"+t);case 6:1===(s=e.sent).code?(z.b.success("\u64cd\u4f5c\u6210\u529f",3),this.loadTableData(this.state.queryParams)):z.b.error(s.message,10);case 8:return e.prev=8,n[a].delLoading=!1,this.setState({items:n}),e.finish(8);case 12:case"end":return e.stop()}}),e,this,[[1,,8,12]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u767b\u5f55\u8d26\u53f7",dataIndex:"username",key:"username",sorter:!0,render:function(t,a){return Object(N.jsx)(O.a,{type:"link",size:"small",onClick:Object(o.a)(Object(i.a)().mark((function t(){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/".concat(a.id));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message),t.abrupt("return");case 6:e.showModal("\u66f4\u65b0\u7528\u6237",n.data);case 7:case"end":return t.stop()}}),t)}))),children:t})}},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"nickname",key:"nickname",sorter:!0},{title:"\u7528\u6237\u7c7b\u578b",dataIndex:"type",key:"type",render:function(e){return"user"===e?Object(N.jsx)(re.a,{children:"\u666e\u901a\u7528\u6237"}):"admin"===e?Object(N.jsx)(re.a,{color:"blue",children:"\u7ba1\u7406\u7528\u6237"}):e}},{title:"\u90ae\u7bb1",dataIndex:"mail",key:"mail"},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(t,a,n){return Object(N.jsx)(zt.a,{checkedChildren:"\u542f\u7528",unCheckedChildren:"\u505c\u7528",disabled:Ke().id===a.id,loading:a.statusLoading,checked:"disabled"!==t,onChange:function(t){e.changeUserStatus(a.id,t,n)}})}},{title:"\u53cc\u56e0\u7d20\u8ba4\u8bc1",dataIndex:"totpSecret",key:"totpSecret",render:function(e){return"1"===e?Object(N.jsx)(re.a,{icon:Object(N.jsx)(Lt.a,{}),color:"success",children:"\u5df2\u5f00\u542f"}):Object(N.jsx)(re.a,{icon:Object(N.jsx)(Vt.a,{}),color:"warning",children:"\u672a\u5f00\u542f"})}},{title:"\u5728\u7ebf\u72b6\u6001",dataIndex:"online",key:"online",render:function(e){return e?Object(N.jsx)(ce.a,{status:"success",text:"\u5728\u7ebf"}):Object(N.jsx)(ce.a,{status:"default",text:"\u79bb\u7ebf"})}},{title:"\u6388\u6743\u8d44\u4ea7",dataIndex:"sharerAssetCount",key:"sharerAssetCount",render:function(t,a){return Object(N.jsx)(O.a,{type:"link",onClick:Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({assetVisible:!0,sharer:a.id});case 1:case"end":return t.stop()}}),t)}))),children:t})}},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u6765\u6e90",dataIndex:"source",key:"source",render:function(e){if("ldap"===e)return Object(N.jsx)(re.a,{color:"gold",children:"\u57df\u540c\u6b65"})}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){var s=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",disabled:"ldap"===a.source,onClick:function(){e.setState({changePasswordVisible:!0,selectedRow:a})},children:"\u4fee\u6539\u5bc6\u7801"})},"1"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",loading:a.resetTOTPLoading,onClick:function(){Ht({title:"\u60a8\u786e\u5b9a\u8981\u91cd\u7f6e\u6b64\u7528\u6237\u7684\u53cc\u56e0\u7d20\u8ba4\u8bc1\u5417?",content:a.name,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.resetTOTP(a.id,n);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})},children:"\u91cd\u7f6e\u53cc\u56e0\u7d20\u8ba4\u8bc1"})},"2"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){e.setState({assetVisible:!0,sharer:a.id})},children:"\u8d44\u4ea7\u6388\u6743"})},"3"),Object(N.jsx)(b.a.Divider,{}),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,disabled:Ke().id===a.id,loading:a.delLoading,onClick:function(){return e.showDeleteConfirm(a.id,a.name,n)},children:"\u5220\u9664"})},"5")]});return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",disabled:Ke().id===a.id,onClick:Object(o.a)(Object(i.a)().mark((function t(){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/".concat(a.id));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message),t.abrupt("return");case 6:e.showModal("\u66f4\u65b0\u7528\u6237",n.data);case 7:case"end":return t.stop()}}),t)}))),children:"\u7f16\u8f91"}),Object(N.jsx)(m.a,{overlay:s,children:Object(N.jsxs)(O.a,{type:"link",size:"small",children:["\u66f4\u591a ",Object(N.jsx)(Te.a,{})]})})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)($t,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:8,children:Object(N.jsx)(Jt,{level:3,children:"\u7528\u6237\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:16,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Gt,{ref:this.inputRefOfNickname,placeholder:"\u7528\u6237\u6635\u79f0",allowClear:!0,onSearch:this.handleSearchByNickname}),Object(N.jsx)(Gt,{ref:this.inputRefOfUsername,placeholder:"\u767b\u5f55\u8d26\u53f7",allowClear:!0,onSearch:this.handleSearchByUsername}),Object(N.jsx)(Gt,{ref:this.inputRefOfMail,placeholder:"\u90ae\u7bb1",allowClear:!0,onSearch:this.handleSearchByMail}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfUsername.current.setValue(""),e.inputRefOfNickname.current.setValue(""),e.inputRefOfMail.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u7528\u6237",{})}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(Xt,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});Ht({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,rowKey:"id",dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(Nt,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):void 0,Object(N.jsx)(et.a,{title:"\u8d44\u4ea7\u6388\u6743",placement:"right",closable:!0,destroyOnClose:!0,onClose:function(){e.loadTableData(e.state.queryParams),e.setState({assetVisible:!1})},visible:this.state.assetVisible,width:.8*window.innerWidth,children:Object(N.jsx)(Ut,{sharer:this.state.sharer,userGroupId:void 0})}),this.state.changePasswordVisible?Object(N.jsx)(te.a,{title:"\u4fee\u6539\u5bc6\u7801",visible:this.state.changePasswordVisible,confirmLoading:this.state.changePasswordConfirmLoading,maskClosable:!1,onOk:function(){e.changePasswordFormRef.current.validateFields().then((function(t){e.changePasswordFormRef.current.resetFields(),e.handleChangePassword(t)}))},onCancel:function(){e.setState({changePasswordVisible:!1})},children:Object(N.jsx)(je.a,{ref:this.changePasswordFormRef,children:Object(N.jsx)(je.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"}],children:Object(N.jsx)(ae.a,{prefix:Object(N.jsx)(Bt.a,{}),placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})})})}):void 0]})})}}]),a}(n.Component),_t=Yt,Zt=a(1296),Qt=a(398),ea=a(1257),ta=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={client:{},containerOverflow:"hidden",width:0,height:0,rate:1,loading:!1,tip:"",closed:!1},e.onTunnelStateChange=function(t){console.log("onTunnelStateChange",t),t===Ze.a.Tunnel.State.CLOSED&&e.setState({loading:!1,closed:!0})},e.onClientStateChange=function(t){switch(t){case 0:e.setState({loading:!0,tip:"\u6b63\u5728\u521d\u59cb\u5316\u4e2d..."});break;case 1:e.setState({loading:!0,tip:"\u6b63\u5728\u52aa\u529b\u8fde\u63a5\u4e2d..."});break;case 2:e.setState({loading:!0,tip:"\u6b63\u5728\u7b49\u5f85\u670d\u52a1\u5668\u54cd\u5e94..."});break;case 3:e.setState({loading:!1}),e.state.client&&e.state.client.getDisplay().scale(e.state.rate)}},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t,a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.sessionId,a=this.props.rate,n=this.props.protocol,s=this.props.width,r=this.props.height,"ssh"!==n&&"telnet"!==n||(a*=.5,s*=2,r*=2),this.setState({width:s*a,height:r*a,rate:a}),this.renderDisplay(t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.state.client&&this.state.client.disconnect()}},{key:"showMessage",value:function(e){te.a.error({title:"\u63d0\u793a",content:e})}},{key:"renderDisplay",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a){var n,s,r,c,o,l,d;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new Ze.a.WebSocketTunnel("".concat(D,"/sessions/").concat(t,"/tunnel-monitor"))).onstatechange=this.onTunnelStateChange,(s=new Ze.a.Client(n)).onstatechange=this.onClientStateChange,r=document.getElementById("display"),c=s.getDisplay().getElement(),r.appendChild(c),o=V(),l={"X-Auth-Token":o},d=pe.a.stringify(l),s.connect(d),window.onunload=function(){s.disconnect()},this.setState({client:s});case 13:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(N.jsx)(Qt.a,{spinning:this.state.loading,tip:this.state.tip,children:Object(N.jsx)("div",{children:this.state.closed?Object(N.jsx)(ea.a,{title:"\u8fdc\u7a0b\u8fde\u63a5\u5df2\u5173\u95ed"}):Object(N.jsx)("div",{className:"container",style:{overflow:this.state.containerOverflow,width:this.state.width,height:this.state.height},children:Object(N.jsx)("div",{id:"display"})})})})}}]),a}(n.Component),aa=ta,na=a(247),sa=(Ae=function(){function e(t,a){Object(l.a)(this,e),this.type=t,this.content=a}return Object(d.a)(e,[{key:"toString",value:function(){return this.type+this.content}}],[{key:"parse",value:function(t){return new e(parseInt(t.substring(0,1)),t.substring(1,t.length))}}]),e}(),Ae.Closed=0,Ae.Connected=1,Ae.Data=2,Ae.Resize=3,Ae.Ping=4,Ae),ra=sa,ca=a(248),ia=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.sessionId,t=new na.Terminal({fontFamily:'monaco, Consolas, "Lucida Console", monospace',fontSize:14,theme:{background:"#1b1b1b"},rightClickSelectsWord:!0});t.open(document.getElementById("terminal")),t.writeln("\u7b49\u5f85\u7528\u6237\u8f93\u5165\u4e2d...");var a=new ca.FitAddon;t.loadAddon(a),a.fit(),t.focus(),t.onData((function(e){}));var n={"X-Auth-Token":V()},s=pe.a.stringify(n),r=new WebSocket("".concat(D,"/sessions/").concat(e,"/ssh-monitor?").concat(s));r.onmessage=function(e){var a=ra.parse(e.data);switch(a.type){case ra.Connected:t.clear();break;case ra.Data:t.write(a.content);break;case ra.Closed:t.writeln("\x1b[1;3;31m".concat(a.content,"\x1b[0m ")),r.close()}},this.setState({term:t,webSocket:r})}},{key:"componentWillUnmount",value:function(){var e=this.state.webSocket;e&&e.close()}},{key:"render",value:function(){return Object(N.jsx)("div",{children:Object(N.jsx)("div",{id:"terminal",style:{backgroundColor:"#1b1b1b"}})})}}]),a}(n.Component),oa=ia,la=te.a.confirm,da=h.a.Content,ua=ae.a.Search,ja=ne.a.Title,ha=ne.a.Text,ba=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfClientIp=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10,protocol:"",userId:void 0,assetId:void 0},loading:!1,selectedRowKeys:[],delBtnLoading:!1,users:[],assets:[],accessVisible:!1,sessionWidth:1024,sessionHeight:768,sessionProtocol:"",sessionMode:""},e.handleChangPage=function(t,a){var n=e.state.queryParams;n.pageIndex=t,n.pageSize=a,e.setState({queryParams:n}),e.loadTableData(n)},e.handleSearchByClientIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,clientIp:t});e.loadTableData(a)},e.handleChangeByProtocol=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,protocol:t});e.loadTableData(a)},e.handleSearchByNickname=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/paging?pageIndex=1&pageSize=100&nickname=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:e.setState({users:n.data.items});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChangeByUserId=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,userId:t});e.loadTableData(a)},e.handleSearchByAssetName=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/assets/paging?pageIndex=1&pageSize=100&name=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:e.setState({assets:n.data.items});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChangeByAssetId=function(t,a){var n=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,assetId:t});e.loadTableData(n)},e.batchDis=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.post("/sessions/"+e.state.selectedRowKeys.join(",")+"/disconnect");case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.showMonitor=function(t){e.setState({sessionId:t.id,sessionProtocol:t.protocol,sessionMode:t.mode,accessVisible:!0,sessionWidth:t.width,sessionHeight:t.height,sessionTitle:"".concat(t.username,"@").concat(t.ip,":").concat(t.port," ").concat(t.width,"x").concat(t.height)})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData(),this.handleSearchByNickname(""),this.handleSearchByAssetName("")}},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),(t=t||this.state.queryParams).status="connected",a=pe.a.stringify(t),n={items:[],total:0},e.prev=5,e.next=8,Y.get("/sessions/paging?"+a);case 8:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(5);case 14:return e.prev=14,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(14);case 18:case"end":return e.stop()}}),e,this,[[5,12,14,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u6765\u6e90IP",dataIndex:"clientIp",key:"clientIp"},{title:"\u63a5\u5165\u65b9\u5f0f",dataIndex:"mode",key:"mode",render:function(e){return Object(N.jsx)(re.a,{color:Ve[e],children:e})}},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"creatorName",key:"creatorName"},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"assetName",key:"assetName"},{title:"\u8fde\u63a5\u534f\u8bae",dataIndex:"protocol",key:"protocol",render:function(e,t){var a="".concat(t.username,"@").concat(t.ip,":").concat(t.port);return Object(N.jsx)(se.a,{title:a,children:Object(N.jsx)(re.a,{color:Le[e],children:e})})}},{title:"\u63a5\u5165\u65f6\u95f4",dataIndex:"connectedTime",key:"connectedTime",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})}},{title:"\u63a5\u5165\u65f6\u957f",dataIndex:"connectedTime",key:"connectedTime",render:function(e,t){return W(new Date(t.connectedTime),new Date)}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){e.showMonitor(a)},children:"\u76d1\u63a7"}),Object(N.jsx)(O.a,{type:"link",size:"small",onClick:Object(o.a)(Object(i.a)().mark((function t(){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:la({title:"\u60a8\u786e\u5b9a\u8981\u65ad\u5f00\u6b64\u4f1a\u8bdd\u5417?",content:"",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){n(a.id)}}),n=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.post("/sessions/".concat(a,"/disconnect"));case 2:1===(n=t.sent).code?(ue.a.success({message:"\u63d0\u793a",description:"\u65ad\u5f00\u6210\u529f"}),e.loadTableData()):ue.a.success({message:"\u63d0\u793a",description:n.message});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 2:case"end":return t.stop()}}),t)}))),children:"\u65ad\u5f00"})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:a,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0,r=this.state.users.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.nickname},e.id)})),c=this.state.assets.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.name},e.id)}));return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(da,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:8,children:Object(N.jsx)(ja,{level:3,children:"\u5728\u7ebf\u4f1a\u8bdd\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:16,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(ua,{ref:this.inputRefOfClientIp,placeholder:"\u6765\u6e90IP",allowClear:!0,onSearch:this.handleSearchByClientIp}),Object(N.jsx)(oe.a,{style:{width:150},showSearch:!0,value:this.state.queryParams.userId,placeholder:"\u7528\u6237\u6635\u79f0",onSearch:this.handleSearchByNickname,onChange:this.handleChangeByUserId,filterOption:!1,allowClear:!0,children:r}),Object(N.jsx)(oe.a,{style:{width:150},showSearch:!0,value:this.state.queryParams.assetId,placeholder:"\u8d44\u4ea7\u540d\u79f0",onSearch:this.handleSearchByAssetName,onChange:this.handleChangeByAssetId,filterOption:!1,children:c}),Object(N.jsxs)(oe.a,{onChange:this.handleChangeByProtocol,value:this.state.queryParams.protocol?this.state.queryParams.protocol:"",style:{width:100},children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u534f\u8bae"}),Object(N.jsx)(oe.a.Option,{value:"rdp",children:"rdp"}),Object(N.jsx)(oe.a.Option,{value:"ssh",children:"ssh"}),Object(N.jsx)(oe.a.Option,{value:"vnc",children:"vnc"}),Object(N.jsx)(oe.a.Option,{value:"telnet",children:"telnet"}),Object(N.jsx)(oe.a.Option,{value:"kubernetes",children:"kubernetes"})]}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfClientIp.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,protocol:"",userId:void 0,assetId:void 0})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u65ad\u5f00",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(Zt.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u65ad\u5f00\u9009\u4e2d\u7684",Object(N.jsx)(ha,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u4e2a\u4f1a\u8bdd\u5417\uff1f"]});la({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDis()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading}),this.state.accessVisible?Object(N.jsx)(te.a,{className:"modal-no-padding",title:this.state.sessionTitle,maskClosable:!1,visible:this.state.accessVisible,footer:null,width:.8*window.innerWidth,height:.8*window.innerWidth/this.state.sessionWidth*this.state.sessionHeight,onCancel:function(){z.b.destroy(),e.setState({accessVisible:!1})},children:"guacd"===this.state.sessionMode?Object(N.jsx)(aa,{sessionId:this.state.sessionId,width:this.state.sessionWidth,height:this.state.sessionHeight,protocol:this.state.sessionProtocol,rate:.8*window.innerWidth/this.state.sessionWidth}):Object(N.jsx)(oa,{sessionId:this.state.sessionId,width:this.state.sessionWidth,height:this.state.sessionHeight})}):void 0]})})}}]),a}(n.Component),pa=ba,ma=a(1268),Oa=a(1297),xa=a(1298),fa=ne.a.Text,ga=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={playPauseIcon:Object(N.jsx)(Oa.a,{}),playPauseIconTitle:"\u64ad\u653e",recording:void 0,percent:0,max:0,speed:1},e.startSpeedUp=function(){var t=e.state.speed;if(1!==t){var a=e.state.recording;if(a.isPlaying()){var n=100/(t-1),s=a.getDuration(),r=a.getPosition();r>=s?e.stopSpeedUp():a.seek(r+100,(function(){We=setTimeout(e.startSpeedUp,n)}))}}},e.stopSpeedUp=function(){clearTimeout(We)},e.handlePlayPause=function(){var t=e.state.recording;t&&(e.state.percent===e.state.max&&e.setState({percent:0},(function(){t.seek(0,(function(){t.play(),e.startSpeedUp()}))})),t.isPlaying()?(t.pause(),e.stopSpeedUp()):(t.play(),e.startSpeedUp()))},e.handleProgressChange=function(t){var a=e.state.recording;a&&a.seek(t,(function(){console.log("complete")}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.sessionId;this.initPlayer(e)}},{key:"componentWillMount",value:function(){}},{key:"initPlayer",value:function(e){var t=this,a="".concat(q,"/sessions/").concat(e,"/recording?X-Auth-Token=").concat(V()),n=document.getElementById("display"),s=new Ze.a.StaticHTTPTunnel(a),r=new Ze.a.SessionRecording(s),c=r.getDisplay(),i=function(e,t){for(var a=e.toString();a.length<t;)a="0"+a;return a},o=function(e){var t=Math.floor(e/1e3),a=t%60,n=Math.floor(t/60);return i(n,2)+":"+i(a,2)};n.appendChild(c.getElement()),r.connect(),r.onplay=function(){t.setState({playPauseIcon:Object(N.jsx)(xa.a,{}),playPauseIconTitle:"\u6682\u505c"})},r.onpause=function(){t.setState({playPauseIcon:Object(N.jsx)(Oa.a,{}),playPauseIconTitle:"\u64ad\u653e"})},n.onclick=this.handlePlayPause,c.onresize=function(e,t){e&&c.scale(n.offsetWidth/e)},r.onseek=function(e){t.setState({percent:e,position:o(e)})},r.onprogress=function(e){t.setState({max:e,duration:o(e)})},this.setState({recording:r},(function(){t.handlePlayPause()}))}},{key:"render",value:function(){var e=this;return Object(N.jsx)("div",{children:Object(N.jsxs)("div",{id:"player",children:[Object(N.jsx)("div",{id:"display",children:Object(N.jsx)("div",{className:"notification-container",children:Object(N.jsx)("div",{className:"seek-notification"})})}),Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",style:{marginLeft:7,marginRight:7,marginTop:3},gutter:[5,5],children:[Object(N.jsx)(y.a,{flex:"none",children:Object(N.jsx)(Oe.Tooltip,{title:this.state.playPauseIconTitle,children:Object(N.jsx)(O.a,{size:"small",onClick:this.handlePlayPause,icon:this.state.playPauseIcon})})}),Object(N.jsx)(y.a,{flex:"auto",children:Object(N.jsx)(ma.a,{value:this.state.percent,max:this.state.max,tooltipVisible:!1,onChange:this.handleProgressChange})}),Object(N.jsx)(y.a,{flex:"none",children:Object(N.jsxs)(oe.a,{size:"small",defaultValue:"1",value:this.state.speed,onChange:function(t){t=parseInt(t),e.setState({speed:t}),1===t?e.stopSpeedUp():e.startSpeedUp()},children:[Object(N.jsx)(oe.a.Option,{value:1,children:"1x"},"1"),Object(N.jsx)(oe.a.Option,{value:2,children:"2x"},"2"),Object(N.jsx)(oe.a.Option,{value:5,children:"5x"},"5")]})}),Object(N.jsxs)(y.a,{flex:"none",children:[Object(N.jsx)(fa,{children:this.state.position}),"/ ",Object(N.jsx)(fa,{children:this.state.duration})]})]})]})})}}]),a}(n.Component),va=ga,ya=a(258),wa=a(257),ka=a(675),Sa=a(1299),Ca=(a(1226),te.a.confirm),Ia=h.a.Content,Ta=ae.a.Search,Pa=ne.a.Title,Ra=ne.a.Text,Fa=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfClientIp=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10,protocol:"",userId:void 0,assetId:void 0,reviewed:void 0},loading:!1,playbackVisible:!1,playbackSessionId:null,videoPlayerVisible:!1,videoPlayerSource:null,selectedRowKeys:[],delBtnLoading:!1,users:[],assets:[],selectedRow:{}},e.handleChangPage=function(t,a){var n=e.state.queryParams;n.pageIndex=t,n.pageSize=a,e.setState({queryParams:n}),e.loadTableData(n)},e.showPlayback=function(t){e.setState({playbackVisible:!0,selectedRow:t})},e.hidePlayback=function(){e.setState({playbackVisible:!1,playbackSessionId:null})},e.handleSearchByClientIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,clientIp:t});e.loadTableData(a)},e.handleChangeByProtocol=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,protocol:t});e.loadTableData(a)},e.handleChangeByRead=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,reviewed:t});e.loadTableData(a)},e.handleSearchByNickname=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/paging?pageIndex=1&pageSize=1000&nickname=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:e.setState({users:n.data.items});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChangeByUserId=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,userId:t});e.loadTableData(a)},e.handleSearchByAssetName=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/assets/paging?pageIndex=1&pageSize=100&name=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:e.setState({assets:n.data.items});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChangeByAssetId=function(t,a){var n=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,assetId:t});e.loadTableData(n)},e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/sessions/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleAllReviewed=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({reviewedAllBtnLoading:!0}),t.prev=1,t.next=4,Y.post("/sessions/reviewed");case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({reviewedAllBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleReviewed=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({reviewedBtnLoading:!0}),t.prev=1,t.next=4,Y.post("/sessions/".concat(e.state.selectedRowKeys.join(","),"/reviewed"));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({reviewedBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleUnreviewed=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({unreviewedBtnLoading:!0}),t.prev=1,t.next=4,Y.post("/sessions/".concat(e.state.selectedRowKeys.join(","),"/unreviewed"));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({unreviewedBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.del=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.delete("/sessions/".concat(a));case 2:1===(n=t.sent).code?(ue.a.success({message:"\u63d0\u793a",description:"\u5220\u9664\u6210\u529f"}),e.loadTableData()):ue.a.error({message:"\u63d0\u793a",description:n.message});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.clearSession=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({clearBtnLoading:!0}),t.prev=1,t.next=4,Y.post("/sessions/clear");case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({clearBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData(),this.handleSearchByNickname(""),this.handleSearchByAssetName("")}},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=t||this.state.queryParams).status="disconnected",this.setState({queryParams:t,loading:!0}),a=pe.a.stringify(t),n={items:[],total:0},e.prev=5,e.next=8,Y.get("/sessions/paging?"+a);case 8:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(5);case 14:return e.prev=14,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(14);case 18:case"end":return e.stop()}}),e,this,[[5,12,14,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u6765\u6e90IP",dataIndex:"clientIp",key:"clientIp"},{title:"\u63a5\u5165\u65b9\u5f0f",dataIndex:"mode",key:"mode",render:function(e){return Object(N.jsx)(re.a,{color:Ve[e],children:e})}},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"creatorName",key:"creatorName"},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"assetName",key:"assetName"},{title:"\u8fde\u63a5\u534f\u8bae",dataIndex:"protocol",key:"protocol",render:function(e,t){var a="".concat(t.username,"@").concat(t.ip,":").concat(t.port);return Object(N.jsx)(se.a,{title:a,children:Object(N.jsx)(re.a,{color:Le[e],children:e})})}},{title:"\u63a5\u5165\u65f6\u95f4",dataIndex:"connectedTime",key:"connectedTime",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})}},{title:"\u63a5\u5165\u65f6\u957f",dataIndex:"connectedTime",key:"connectedTime",render:function(e,t){return W(new Date(t.connectedTime),new Date(t.disconnectedTime))}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){var n=!0;return a.recording&&"1"===a.recording&&(n=!1),Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",disabled:n,onClick:function(){return e.showPlayback(a)},children:"\u56de\u653e"}),Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){Ca({title:"\u60a8\u786e\u5b9a\u8981\u7981\u6b62\u8be5IP\u8bbf\u95ee\u672c\u7cfb\u7edf\u5417?",content:"",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t,n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={ip:a.clientIp,rule:"reject",priority:99},e.next=3,Y.post("/securities",t);case 3:1===(n=e.sent).code?z.b.success("\u7981\u7528\u6210\u529f"):z.b.error(n.message,10);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})},children:"\u7981\u7528IP"}),Object(N.jsx)(O.a,{type:"link",size:"small",danger:!0,onClick:function(){Ca({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4f1a\u8bdd\u5417?",content:"",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){e.del(a.id)}})},children:"\u5220\u9664"})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0,r=this.state.users.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.nickname},e.id)})),c=this.state.assets.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.name},e.id)}));return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Ia,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:4,children:Object(N.jsx)(Pa,{level:3,children:"\u79bb\u7ebf\u4f1a\u8bdd\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:20,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Ta,{ref:this.inputRefOfClientIp,placeholder:"\u6765\u6e90IP",allowClear:!0,onSearch:this.handleSearchByClientIp}),Object(N.jsx)(oe.a,{style:{width:140},showSearch:!0,value:this.state.queryParams.userId,placeholder:"\u7528\u6237\u6635\u79f0",onSearch:this.handleSearchByNickname,onChange:this.handleChangeByUserId,filterOption:!1,allowClear:!0,children:r}),Object(N.jsx)(oe.a,{style:{width:140},showSearch:!0,value:this.state.queryParams.assetId,placeholder:"\u8d44\u4ea7\u540d\u79f0",onSearch:this.handleSearchByAssetName,onChange:this.handleChangeByAssetId,filterOption:!1,children:c}),Object(N.jsxs)(oe.a,{onChange:this.handleChangeByRead,value:this.state.queryParams.reviewed?this.state.queryParams.reviewed:"",style:{width:100},children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u4f1a\u8bdd"}),Object(N.jsx)(oe.a.Option,{value:"true",children:"\u53ea\u770b\u5df2\u8bfb"}),Object(N.jsx)(oe.a.Option,{value:"false",children:"\u53ea\u770b\u672a\u8bfb"})]}),Object(N.jsxs)(oe.a,{onChange:this.handleChangeByProtocol,value:this.state.queryParams.protocol?this.state.queryParams.protocol:"",style:{width:100},children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u534f\u8bae"}),Object(N.jsx)(oe.a.Option,{value:"rdp",children:"rdp"}),Object(N.jsx)(oe.a.Option,{value:"ssh",children:"ssh"}),Object(N.jsx)(oe.a.Option,{value:"vnc",children:"vnc"}),Object(N.jsx)(oe.a.Option,{value:"telnet",children:"telnet"}),Object(N.jsx)(oe.a.Option,{value:"kubernetes",children:"kubernetes"})]}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfClientIp.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,protocol:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u5168\u90e8\u6807\u4e3a\u5df2\u9605",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(ya.a,{}),loading:this.state.reviewedAllBtnLoading,onClick:this.handleAllReviewed})}),Object(N.jsx)(se.a,{title:"\u6807\u4e3a\u5df2\u9605",children:Object(N.jsx)(O.a,{disabled:!s,icon:Object(N.jsx)(wa.a,{}),loading:this.state.reviewedBtnLoading,onClick:this.handleReviewed})}),Object(N.jsx)(se.a,{title:"\u6807\u4e3a\u672a\u9605",children:Object(N.jsx)(O.a,{disabled:!s,icon:Object(N.jsx)(ka.a,{}),loading:this.state.unreviewedBtnLoading,onClick:this.handleUnreviewed})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(Ra,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});Ca({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})}),Object(N.jsx)(se.a,{title:"\u6e05\u7a7a",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,icon:Object(N.jsx)(Sa.a,{}),loading:this.state.clearBtnLoading,onClick:function(){var t=Object(N.jsx)(Ra,{style:{color:"red"},strong:!0,children:"\u60a8\u786e\u5b9a\u8981\u6e05\u7a7a\u5168\u90e8\u7684\u79bb\u7ebf\u4f1a\u8bdd\u5417\uff1f"});Ca({icon:Object(N.jsx)(ze.a,{}),content:t,okType:"danger",onOk:e.clearSession,onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,rowClassName:function(e,t){return e.reviewed?"":"unreviewed"}}),this.state.playbackVisible?Object(N.jsx)(te.a,{className:"modal-no-padding",title:"\u4f1a\u8bdd\u56de\u653e \u6765\u6e90IP\uff1a".concat(this.state.selectedRow.clientIp," \u7528\u6237\u6635\u79f0\uff1a").concat(this.state.selectedRow.creatorName," \u8d44\u4ea7\u540d\u79f0\uff1a").concat(this.state.selectedRow.assetName," \u7f51\u7edc\uff1a").concat(this.state.selectedRow.username,"@").concat(this.state.selectedRow.ip,":").concat(this.state.selectedRow.port),centered:!0,visible:this.state.playbackVisible,onCancel:this.hidePlayback,width:.8*window.innerWidth,footer:null,destroyOnClose:!0,maskClosable:!1,children:"native"===this.state.selectedRow.mode||"terminal"===this.state.selectedRow.mode?Object(N.jsx)("iframe",{title:"recording",style:{width:"100%",overflow:"visible"},onLoad:function(){},ref:"iframe",src:"./asciinema.html?sessionId="+this.state.selectedRow.id,width:"100%",height:.8*window.innerHeight,frameBorder:"0"}):Object(N.jsx)(va,{sessionId:this.state.selectedRow.id})}):void 0]})})}}]),a}(n.Component),qa=Fa,Da=a(263),za=(a(1227),a(1300)),Na=a.p+"static/media/bg.18a74a7a.jpg",La=ne.a.Title,Va=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).formRef=s.a.createRef(),e.totpInputRef=s.a.createRef(),e.state={inLogin:!1,height:window.innerHeight,width:window.innerWidth,loginAccount:void 0,totpModalVisible:!1,confirmLoading:!1},e.handleSubmit=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({inLogin:!0}),t.prev=1,t.next=4,Y.post("/login",a);case 4:if(0!==(n=t.sent).code){t.next=9;break}return e.setState({loginAccount:a,totpModalVisible:!0}),e.totpInputRef.current.focus(),t.abrupt("return");case 9:if(1===n.code){t.next=11;break}throw new Error(n.message);case 11:sessionStorage.removeItem("current"),sessionStorage.removeItem("openKeys"),L(n.data),window.location.href="/",t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),z.b.error(t.t0.message);case 20:return t.prev=20,e.setState({inLogin:!1}),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[1,17,20,23]])})));return function(e){return t.apply(this,arguments)}}(),e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({confirmLoading:!0}),(n=e.state.loginAccount).totp=a.totp,t.prev=3,t.next=6,Y.post("/loginWithTotp",n);case 6:if(1===(s=t.sent).code){t.next=10;break}return z.b.error(s.message),t.abrupt("return");case 10:sessionStorage.removeItem("current"),sessionStorage.removeItem("openKeys"),L(s.data),window.location.href="/",t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),z.b.error(t.t0.message);case 19:return t.prev=19,e.setState({confirmLoading:!1}),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[3,16,19,22]])})));return function(e){return t.apply(this,arguments)}}(),e.handleCancel=function(){e.setState({totpModalVisible:!1})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",(function(){e.setState({height:window.innerHeight,width:window.innerWidth})}))}},{key:"render",value:function(){var e=this;return Object(N.jsxs)("div",{className:"login-bg",style:{width:this.state.width,height:this.state.height,background:"url(".concat(Na,")")},children:[Object(N.jsxs)(w.a,{className:"login-card",title:null,children:[Object(N.jsx)("div",{style:{textAlign:"center",margin:"15px auto 30px auto",color:"#1890ff"},children:Object(N.jsx)(La,{level:1,children:"Cloud Fort"})}),Object(N.jsxs)(je.a,{onFinish:this.handleSubmit,className:"login-form",children:[Object(N.jsx)(je.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u8d26\u53f7\uff01"}],children:Object(N.jsx)(ae.a,{prefix:Object(N.jsx)(S.a,{}),placeholder:"\u767b\u5f55\u8d26\u53f7"})}),Object(N.jsx)(je.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801\uff01"}],children:Object(N.jsx)(ae.a.Password,{prefix:Object(N.jsx)(Bt.a,{}),placeholder:"\u767b\u5f55\u5bc6\u7801"})}),Object(N.jsx)(je.a.Item,{name:"remember",valuePropName:"checked",initialValue:!1,children:Object(N.jsx)(Da.a,{children:"\u8bb0\u4f4f\u767b\u5f55"})}),Object(N.jsx)(je.a.Item,{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",className:"login-form-button",loading:this.state.inLogin,children:"\u767b\u5f55"})})]})]}),Object(N.jsx)(te.a,{title:"\u53cc\u56e0\u7d20\u8ba4\u8bc1",visible:this.state.totpModalVisible,confirmLoading:this.state.confirmLoading,maskClosable:!1,okButtonProps:{form:"totp-form",key:"submit",htmlType:"submit"},onOk:function(){e.formRef.current.validateFields().then((function(t){e.handleOk(t)}))},onCancel:this.handleCancel,children:Object(N.jsx)(je.a,{id:"totp-form",ref:this.formRef,children:Object(N.jsx)(je.a.Item,{name:"totp",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"}],children:Object(N.jsx)(ae.a,{ref:this.totpInputRef,prefix:Object(N.jsx)(za.a,{}),placeholder:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"})})})})]})}}]),a}(n.Component),Ba=Object(f.f)(Va),Ma=Oe.Input.TextArea,Ka=function(e){var t=e.title,a=e.visible,n=e.handleOk,s=e.handleCancel,r=e.confirmLoading,c=e.model,i=Oe.Form.useForm(),o=Object(me.a)(i,1)[0];return Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){o.validateFields().then((function(e){o.resetFields(),n(e)})).catch((function(e){}))},onCancel:s,confirmLoading:r,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:o},{labelCol:{span:6},wrapperCol:{span:18}}),{},{initialValues:c,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6307\u4ee4\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6307\u4ee4\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8bf7\u8f93\u5165\u6307\u4ee4\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6307\u4ee4\u5185\u5bb9",name:"content",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6307\u4ee4\u5185\u5bb9"}],children:Object(N.jsx)(Ma,{autoSize:{minRows:5,maxRows:10},placeholder:"\u4e00\u884c\u4e00\u4e2a\u6307\u4ee4"})})]}))})},Aa=ae.a.Search,Wa=h.a.Content,Ea=ne.a.Title,Ua=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.inputRefOfIp=s.a.createRef(),e.changeOwnerFormRef=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10,protocol:"ssh"},loading:!1,tags:[],model:{},selectedRowKeys:[],selectedRows:[],delBtnLoading:!1,changeOwnerModalVisible:!1,changeSharerModalVisible:!1,changeOwnerConfirmLoading:!1,changeSharerConfirmLoading:!1,users:[],selected:{},totalSelectedRows:[]},e.checkedAssets=void 0,e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleSearchByIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,ip:t});e.loadTableData(a)},e.handleTagsChange=function(t){console.log(t);var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,tags:t.join(",")});e.loadTableData(a)},e.unSelectRow=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.state.selectedRowKeys.filter((function(e){return e!==a})),s=e.state.totalSelectedRows.filter((function(e){return e.id!==a})),e.setState({selectedRowKeys:n,totalSelectedRows:s}),e.checkedAssets&&e.checkedAssets(s),console.log(s);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkedAssets=this.props.setCheckedAssets,this.loadTableData(),e.next=4,Y.get("/tags");case 4:1===(t=e.sent).code&&this.setState({tags:t.data});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r,c,o,l;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/assets/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=this.state.sharer,c=n.items.map((function(e){var t=!1;return r===e.owner&&(t=!0),Object(g.a)(Object(g.a)({},e),{},{key:e.id,disabled:t})})),o=this.state.totalSelectedRows,l=o.map((function(e){return e.id})),this.setState({items:c,total:n.total,queryParams:t,loading:!1,selectedRowKeys:l}),e.finish(13);case 20:case"end":return e.stop()}}),e,this,[[4,11,13,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"name",key:"name",render:function(e,t){var a=e;return a&&a.length>20&&(a=a.substring(0,20)+" ..."),Object(N.jsx)(se.a,{placement:"topLeft",title:e,children:a})}},{title:"\u8fde\u63a5\u534f\u8bae",dataIndex:"protocol",key:"protocol",render:function(e,t){var a="".concat(t.ip+":"+t.port);return Object(N.jsx)(se.a,{title:a,children:Object(N.jsx)(re.a,{color:Le[e],children:e})})}},{title:"\u6807\u7b7e",dataIndex:"tags",key:"tags",render:function(e){if(!E(e)){for(var t=[],a=e.split(","),n=0;n<a.length;n++)"-"!==e[n]&&t.push(Object(N.jsx)(re.a,{children:a[n]}));return t}}},{title:"\u72b6\u6001",dataIndex:"active",key:"active",render:function(e){return e?Object(N.jsx)(se.a,{title:"\u8fd0\u884c\u4e2d",children:Object(N.jsx)(ce.a,{status:"processing",text:"\u8fd0\u884c\u4e2d"})}):Object(N.jsx)(se.a,{title:"\u4e0d\u53ef\u7528",children:Object(N.jsx)(ce.a,{status:"error",text:"\u4e0d\u53ef\u7528"})})}},{title:"\u6240\u6709\u8005",dataIndex:"ownerName",key:"ownerName"},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})}}],a={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a});for(var n=e.state.totalSelectedRows,s=n.map((function(e){return e.id})),r=0;r<a.length;r++){var c=a[r];s.includes(c.id)||n.push(c)}e.setState({totalSelectedRows:n}),e.checkedAssets&&e.checkedAssets(n),console.log(n)},getCheckboxProps:function(e){return{disabled:e.disabled}}};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Ea,{level:3,children:"\u5df2\u9009\u62e9\u8d44\u4ea7\u5217\u8868"}),Object(N.jsx)("div",{children:this.state.totalSelectedRows.map((function(t){return Object(N.jsx)(re.a,{color:Le[t.protocol],closable:!0,onClose:function(){return e.unSelectRow(t.id)},children:t.name},t.id)}))}),Object(N.jsx)(le.a,{}),Object(N.jsxs)(Wa,{className:"site-layout-background",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:4,children:Object(N.jsx)(Ea,{level:3,children:"\u5168\u90e8\u8d44\u4ea7\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:20,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Aa,{ref:this.inputRefOfName,placeholder:"\u8d44\u4ea7\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName,style:{width:200}}),Object(N.jsx)(Aa,{ref:this.inputRefOfIp,placeholder:"\u8d44\u4ea7IP",allowClear:!0,onSearch:this.handleSearchByIp,style:{width:200}}),Object(N.jsx)(oe.a,{mode:"multiple",allowClear:!0,placeholder:"\u8d44\u4ea7\u6807\u7b7e",onChange:this.handleTagsChange,style:{minWidth:150},children:this.state.tags.map((function(e){if("-"!==e)return Object(N.jsx)(oe.a.Option,{children:e},e)}))}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.inputRefOfIp.current.setValue(""),e.loadTableData(Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:10,protocol:"ssh",name:"",ip:""}))}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:a,dataSource:this.state.items,columns:t,position:"both",size:"middle",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading},"assets-table")]},"page-content")]})}}]),a}(n.Component),Ha=Ua,Ga=te.a.confirm,Ja=h.a.Content,Xa=ne.a.Title,$a=ne.a.Text,Ya=ae.a.Search,_a=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.inputRefOfContent=s.a.createRef(),e.changeOwnerFormRef=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,assetsVisible:!1,assets:[],checkedAssets:[],commandId:"",model:null,selectedRowKeys:[],delBtnLoading:!1,changeOwnerModalVisible:!1,changeOwnerConfirmLoading:!1,users:[],selected:{},indeterminate:!0,checkAllChecked:!1},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleSearchByContent=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,content:t});e.loadTableData(a)},e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.setCheckedAssets=function(t){e.setState({checkedAssets:t})},e.executeCommand=function(t){var a=e.state.checkedAssets;if(0!==a.length){var n=a.map((function(e){return{id:e.id,name:e.name}}));window.location.href="#/batch-command?commandId="+e.state.commandId+"&assets="+JSON.stringify(n)}else z.b.warning("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u8d44\u4ea7")},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),!a.id){t.next=8;break}return t.next=4,Y.put("/commands/"+a.id,a);case 4:1===(n=t.sent).code?(z.b.success("\u66f4\u65b0\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u66f4\u65b0\u5931\u8d25 :( "+n.message,10),t.next=12;break;case 8:return t.next=10,Y.post("/commands",a);case 10:1===(s=t.sent).code?(z.b.success("\u65b0\u589e\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u65b0\u589e\u5931\u8d25 :( "+s.message,10);case 12:e.setState({modalConfirmLoading:!1});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/commands/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleSearchByNickname=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/paging?pageIndex=1&pageSize=100&nickname=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:s=n.data.items.map((function(e){return Object(g.a)({key:e.id},e)})),e.setState({users:s});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/commands/"+t);case 2:1===(a=e.sent).code?(z.b.success("\u5220\u9664\u6210\u529f"),this.loadTableData(this.state.queryParams)):z.b.error(a.message,10);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/commands/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;Ga({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u6307\u4ee4\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"showModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.setState({modalTitle:e,modalVisible:!0,model:t})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u6307\u4ee4\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a){var n=t;return n&&n.length>20&&(n=n.substring(0,20)+" ..."),Be(a.owner)?Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){return e.showModal("\u66f4\u65b0\u6307\u4ee4",a)},children:Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:n})}):Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:n})},sorter:!0},{title:"\u6307\u4ee4\u5185\u5bb9",dataIndex:"content",key:"content",render:function(e,t){var a=e;return a&&a.length>20&&(a=a.substring(0,20)+" ..."),Object(N.jsx)(se.a,{placement:"topLeft",title:e,children:a})}},{title:"\u6240\u6709\u8005",dataIndex:"ownerName",key:"ownerName"},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){var n=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){return e.showModal("\u66f4\u65b0\u6307\u4ee4",a)},children:"\u7f16\u8f91"})},"1"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){e.handleSearchByNickname("").then((function(){e.setState({changeOwnerModalVisible:!0,selected:a}),e.changeOwnerFormRef.current.setFieldsValue({owner:a.owner})}))},children:"\u66f4\u6362\u6240\u6709\u8005"})},"2"),Object(N.jsx)(b.a.Divider,{}),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})},"3")]});return Me()?Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",onClick:Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({assetsVisible:!0,commandId:a.id});case 1:case"end":return t.stop()}}),t)}))),children:"\u6267\u884c"}),Object(N.jsx)(m.a,{overlay:n,children:Object(N.jsxs)(O.a,{type:"link",size:"small",children:["\u66f4\u591a ",Object(N.jsx)(Te.a,{})]})})]}):Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",disabled:!Be(a.owner),onClick:function(){return e.showModal("\u66f4\u65b0\u6307\u4ee4",a)},children:"\u7f16\u8f91"}),Object(N.jsx)(O.a,{type:"link",size:"small",danger:!0,disabled:!Be(a.owner),onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0,r=Me()?"page-content":"page-content-user";return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Ja,{className:["site-layout-background",r],children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(Xa,{level:3,children:"\u6307\u4ee4\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Ya,{ref:this.inputRefOfName,placeholder:"\u6307\u4ee4\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(Ya,{ref:this.inputRefOfContent,placeholder:"\u6307\u4ee4\u5185\u5bb9",allowClear:!0,onSearch:this.handleSearchByContent}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.inputRefOfContent.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:"",content:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u6307\u4ee4",{})}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)($a,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});Ga({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(Ka,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):null,Object(N.jsx)(te.a,{title:"\u9009\u62e9\u8d44\u4ea7",visible:this.state.assetsVisible,width:.8*window.innerWidth,centered:!0,onOk:this.executeCommand,onCancel:function(){e.setState({assetsVisible:!1})},children:Object(N.jsx)(Ha,{setCheckedAssets:this.setCheckedAssets})}),Object(N.jsx)(te.a,{title:Object(N.jsxs)($a,{children:["\u66f4\u6362\u8d44\u6e90\u300c",Object(N.jsx)("strong",{style:{color:"#1890ff"},children:this.state.selected.name}),"\u300d\u7684\u6240\u6709\u8005"]}),visible:this.state.changeOwnerModalVisible,confirmLoading:this.state.changeOwnerConfirmLoading,onOk:function(){e.setState({changeOwnerConfirmLoading:!0});var t=!1;e.changeOwnerFormRef.current.validateFields().then(function(){var a=Object(o.a)(Object(i.a)().mark((function a(n){var s;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Y.post("/commands/".concat(e.state.selected.id,"/change-owner?owner=").concat(n.owner));case 2:1===(s=a.sent).code?(z.b.success("\u64cd\u4f5c\u6210\u529f"),e.loadTableData()):(z.b.error(s.message,10),t=!0);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){})).finally((function(){e.setState({changeOwnerConfirmLoading:!1,changeOwnerModalVisible:t})}))},onCancel:function(){e.setState({changeOwnerModalVisible:!1})},children:Object(N.jsx)(je.a,{ref:this.changeOwnerFormRef,children:Object(N.jsx)(je.a.Item,{name:"owner",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6240\u6709\u8005"}],children:Object(N.jsx)(oe.a,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u6240\u6709\u8005",onSearch:this.handleSearchByNickname,filterOption:!1,children:this.state.users.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.nickname},e.id)}))})})})})]})})}}]),a}(n.Component),Za=_a,Qa=Oe.Input.TextArea,en=[{text:"\u5bc6\u7801",value:"custom"},{text:"\u5bc6\u94a5",value:"private-key"}],tn=function(e){var t=e.title,a=e.visible,s=e.handleOk,r=e.handleCancel,c=e.confirmLoading,i=e.model,o=Oe.Form.useForm(),l=Object(me.a)(o,1)[0];for(var d in null!==i&&void 0!==i||(i={}),E(i.type)&&(i.type="custom"),i)i.hasOwnProperty(d)&&"-"===i[d]&&(i[d]="");var u=Object(n.useState)(i.type),j=Object(me.a)(u,2),h=j[0],b=j[1];return Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){l.validateFields().then((function(e){l.resetFields(),s(e)})).catch((function(e){}))},onCancel:r,confirmLoading:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:l},{labelCol:{span:6},wrapperCol:{span:14}}),{},{initialValues:i,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u51ed\u8bc1\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u51ed\u8bc1\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8bf7\u8f93\u5165\u51ed\u8bc1\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u8d26\u6237\u7c7b\u578b",name:"type",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u8d26\u6237\u7c7b\u578b"}],children:Object(N.jsx)(Oe.Select,{onChange:function(e){b(e),i.type=e},children:en.map((function(e){return Object(N.jsx)(Oe.Select.Option,{value:e.value,children:e.text},e.value)}))})}),"private-key"===h?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",children:Object(N.jsx)(Oe.Input,{placeholder:"\u8f93\u5165\u6388\u6743\u8d26\u6237"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u79c1\u94a5",name:"privateKey",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u79c1\u94a5"}],children:Object(N.jsx)(Qa,{rows:4})}),Object(N.jsx)(Oe.Form.Item,{label:"\u79c1\u94a5\u5bc6\u7801",name:"passphrase",children:Object(N.jsx)(Qa,{rows:1})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",children:Object(N.jsx)(Oe.Input,{placeholder:"\u8f93\u5165\u6388\u6743\u8d26\u6237"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u5bc6\u7801",name:"password",children:Object(N.jsx)(Oe.Input.Password,{placeholder:"\u8f93\u5165\u6388\u6743\u5bc6\u7801"})})]})]}))})},an=te.a.confirm,nn=ae.a.Search,sn=ne.a.Title,rn=ne.a.Text,cn=h.a.Content,on=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.changeOwnerFormRef=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,model:null,selectedRowKeys:[],delBtnLoading:!1,changeOwnerModalVisible:!1,changeOwnerConfirmLoading:!1,users:[],selected:{}},e.handleChangPage=function(t,a){var n=e.state.queryParams;n.pageIndex=t,n.pageSize=a,e.setState({queryParams:n}),e.loadTableData(n)},e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.showModal=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r,c,o,l=arguments;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:null,s=l.length>2?l[2]:void 0,r=e.state.items,c={},!n){t.next=17;break}return r[s].updateBtnLoading=!0,e.setState({items:r}),t.next=9,Y.get("/credentials/"+n);case 9:if(1===(o=t.sent).code){t.next=15;break}return z.b.error(o.message),r[s].updateBtnLoading=!1,e.setState({items:r}),t.abrupt("return");case 15:r[s].updateBtnLoading=!1,c=o.data;case 17:e.setState({modalTitle:a,modalVisible:!0,model:c,items:r});case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),!a.id){t.next=15;break}return t.next=4,Y.put("/credentials/"+a.id,a);case 4:if(1!==(n=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(n.message,10);case 13:t.next=26;break;case 15:return t.next=17,Y.post("/credentials",a);case 17:if(1!==(s=t.sent).code){t.next=25;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=23,e.loadTableData(e.state.queryParams);case 23:t.next=26;break;case 25:z.b.error(s.message,10);case 26:e.setState({modalConfirmLoading:!1});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/credentials/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleSearchByNickname=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/paging?pageIndex=1&pageSize=100&nickname=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:s=n.data.items.map((function(e){return Object(g.a)({key:e.id,disabled:!1},e)})),e.setState({users:s});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleSharersChange=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({selectedSharers:a});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/credentials/"+t);case 2:if(1!==(a=e.sent).code){e.next=9;break}return z.b.success("\u5220\u9664\u6210\u529f"),e.next=7,this.loadTableData(this.state.queryParams);case 7:e.next=10;break;case 9:z.b.error(a.message,10);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/credentials/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;an({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u8bb0\u5f55\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e).then((function(e){}))}})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u51ed\u8bc1\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a,n){var s=t;return s&&s.length>20&&(s=s.substring(0,20)+" ..."),Be(a.owner)?Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].updateBtnLoading,onClick:function(){return e.showModal("\u66f4\u65b0\u51ed\u8bc1",a.id,n)},children:Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:s})}):Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:s})},sorter:!0},{title:"\u51ed\u8bc1\u7c7b\u578b",dataIndex:"type",key:"type",render:function(e,t){return"private-key"===e?Object(N.jsx)(re.a,{color:"green",children:"\u5bc6\u94a5"}):Object(N.jsx)(re.a,{color:"red",children:"\u5bc6\u7801"})}},{title:"\u6388\u6743\u8d26\u6237",dataIndex:"username",key:"username"},{title:"\u6240\u6709\u8005",dataIndex:"ownerName",key:"ownerName"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){var s=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",disabled:!Be(a.owner),onClick:function(){e.handleSearchByNickname("").then((function(){e.setState({changeOwnerModalVisible:!0,selected:a}),e.changeOwnerFormRef.current.setFieldsValue({owner:a.owner})}))},children:"\u66f4\u6362\u6240\u6709\u8005"})},"1"),Object(N.jsx)(b.a.Divider,{}),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,disabled:!Be(a.owner),onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})},"3")]});return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].updateBtnLoading,disabled:!Be(a.owner),onClick:function(){return e.showModal("\u66f4\u65b0\u51ed\u8bc1",a.id,n)},children:"\u7f16\u8f91"}),Object(N.jsx)(m.a,{overlay:s,children:Object(N.jsxs)(O.a,{type:"link",size:"small",children:["\u66f4\u591a ",Object(N.jsx)(Te.a,{})]})})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(cn,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(sn,{level:3,children:"\u6388\u6743\u51ed\u8bc1\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(nn,{ref:this.inputRefOfName,placeholder:"\u51ed\u8bc1\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u51ed\u8bc1")}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(rn,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});an({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,rowKey:"id",dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(tn,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):null,Object(N.jsx)(te.a,{title:Object(N.jsxs)(rn,{children:["\u66f4\u6362\u8d44\u6e90\u300c",Object(N.jsx)("strong",{style:{color:"#1890ff"},children:this.state.selected.name}),"\u300d\u7684\u6240\u6709\u8005"]}),visible:this.state.changeOwnerModalVisible,confirmLoading:this.state.changeOwnerConfirmLoading,onOk:function(){e.setState({changeOwnerConfirmLoading:!0});var t=!1;e.changeOwnerFormRef.current.validateFields().then(function(){var a=Object(o.a)(Object(i.a)().mark((function a(n){var s;return Object(i.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Y.post("/credentials/".concat(e.state.selected.id,"/change-owner?owner=").concat(n.owner));case 2:1===(s=a.sent).code?(z.b.success("\u64cd\u4f5c\u6210\u529f"),e.loadTableData()):(z.b.error(s.message,10),t=!0);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){})).finally((function(){e.setState({changeOwnerConfirmLoading:!1,changeOwnerModalVisible:t})}))},onCancel:function(){e.setState({changeOwnerModalVisible:!1})},children:Object(N.jsx)(je.a,{ref:this.changeOwnerFormRef,children:Object(N.jsx)(je.a.Item,{name:"owner",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6240\u6709\u8005"}],children:Object(N.jsx)(oe.a,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u6240\u6709\u8005",onSearch:this.handleSearchByNickname,filterOption:!1,children:this.state.users.map((function(e){return Object(N.jsx)(oe.a.Option,{value:e.id,children:e.nickname},e.id)}))})})})})]})})}}]),a}(n.Component),ln=on,dn=a.p+"static/media/logo-with-name.e8aacfa0.svg",un=a.p+"static/media/logo.54e800e2.svg",jn=a(1306),hn=a(1307),bn=a(1308),pn=a(1309),mn=a(1310),On=a(1311),xn=a(1312),fn=a(1313),gn=a(1314),vn=a(1302),yn=a(1315),wn=a(1316),kn=a(1301),Sn=a(1317),Cn=a(1318),In=a(1319),Tn=a(1320),Pn=a(1258),Rn=h.a.Content,Fn=w.a.Meta,qn=ne.a.Title,Dn=ne.a.Text,zn={labelCol:{span:4},wrapperCol:{span:10}},Nn={labelCol:{span:4},wrapperCol:{span:10,offset:4}},Ln=te.a.confirm,Vn=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={user:{enableTotp:!1},accessToken:{}},e.passwordFormRef=s.a.createRef(),e.loadInfo=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/account/info");case 2:1===(a=t.sent).code?(e.setState({user:a.data}),sessionStorage.setItem("user",JSON.stringify(a.data))):z.b.error(a.message);case 4:case"end":return t.stop()}}),t)}))),e.loadAccessToken=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/account/access-token");case 2:1===(a=t.sent).code?e.setState({accessToken:a.data}):z.b.error(a.message);case 4:case"end":return t.stop()}}),t)}))),e.genAccessToken=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.post("/account/access-token");case 2:1===(a=t.sent).code?e.loadAccessToken():z.b.error(a.message);case 4:case"end":return t.stop()}}),t)}))),e.onNewPassword2Change=function(t){e.setState(Object(g.a)(Object(g.a)({},e.validateNewPassword(t.target.value)),{},{newPassword2:t.target.value}))},e.validateNewPassword=function(t){return t===e.state.newPassword?{validateStatus:"success",errorMsg:null}:{validateStatus:"error",errorMsg:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"}},e.changePassword=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/account/change-password",t);case 2:1===(a=e.sent).code?(z.b.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u767b\u5f55\u9875\u9762"),window.location.href="/#"):z.b.error(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.confirmTOTP=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.secret=e.state.secret,t.next=3,Y.post("/account/confirm-totp",a);case 3:if(1!==(n=t.sent).code){t.next=11;break}return z.b.success("TOTP\u542f\u7528\u6210\u529f"),t.next=8,e.loadInfo();case 8:e.setState({qr:"",secret:""}),t.next=12;break;case 11:z.b.error(n.message);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.resetTOTP=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/account/reload-totp");case 2:1===(a=t.sent).code?e.setState({qr:a.data.qr,secret:a.data.secret}):z.b.error(a.message);case 4:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadInfo(),this.loadAccessToken()}},{key:"onNewPasswordChange",value:function(e){this.setState({newPassword:e.target.value})}},{key:"render",value:function(){var e=this,t=Me()?"page-content":"page-content-user";return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Rn,{className:["site-layout-background",t],children:[Object(N.jsxs)(v.a,{children:[Object(N.jsxs)(y.a,{span:12,children:[Object(N.jsx)(qn,{level:3,children:"\u4fee\u6539\u5bc6\u7801"}),Object(N.jsxs)(je.a,{ref:this.passwordFormRef,name:"password",onFinish:this.changePassword,children:[Object(N.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},zn),{},{name:"oldPassword",label:"\u539f\u59cb\u5bc6\u7801",rules:[{required:!0,message:"\u539f\u59cb\u5bc6\u7801"}],children:Object(N.jsx)(ae.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u539f\u59cb\u5bc6\u7801",style:{width:240}})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},zn),{},{name:"newPassword",label:"\u65b0\u7684\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u7684\u5bc6\u7801"}],children:Object(N.jsx)(ae.a,{type:"password",placeholder:"\u65b0\u7684\u5bc6\u7801",onChange:function(t){return e.onNewPasswordChange(t)},style:{width:240}})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},zn),{},{name:"newPassword2",label:"\u786e\u8ba4\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u548c\u4e0a\u9762\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4"}],validateStatus:this.state.validateStatus,help:this.state.errorMsg||" ",children:Object(N.jsx)(ae.a,{type:"password",placeholder:"\u8bf7\u548c\u4e0a\u9762\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4",onChange:function(t){return e.onNewPassword2Change(t)},style:{width:240}})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Nn),{},{children:Object(N.jsx)(O.a,{disabled:this.state.errorMsg||!this.state.validateStatus,type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})}))]}),Object(N.jsx)(le.a,{})]}),Object(N.jsxs)(y.a,{span:12,children:[Object(N.jsx)(qn,{level:3,children:"\u6388\u6743\u4fe1\u606f"}),Object(N.jsxs)(It.b,{column:1,children:[Object(N.jsx)(It.b.Item,{label:"\u6388\u6743\u4ee4\u724c",children:Object(N.jsx)(Dn,{strong:!0,copyable:!0,children:this.state.accessToken.token})}),Object(N.jsx)(It.b.Item,{label:"\u751f\u6210\u65f6\u95f4",children:Object(N.jsx)(Dn,{strong:!0,children:this.state.accessToken.created})})]}),Object(N.jsx)(ie.b,{children:Object(N.jsx)(O.a,{type:"primary",onClick:this.genAccessToken,children:"\u91cd\u65b0\u751f\u6210"})})]})]}),Object(N.jsx)(qn,{level:3,children:"\u53cc\u56e0\u7d20\u8ba4\u8bc1"}),Object(N.jsx)(je.a,{hidden:this.state.qr,children:Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},zn),{},{children:this.state.user.enableTotp?Object(N.jsx)(ea.a,{status:"success",title:"\u60a8\u5df2\u6210\u529f\u5f00\u542f\u53cc\u56e0\u7d20\u8ba4\u8bc1!",subTitle:"\u591a\u56e0\u7d20\u8ba4\u8bc1-MFA\u4e8c\u6b21\u8ba4\u8bc1-\u767b\u5f55\u8eab\u4efd\u9274\u522b,\u8bbf\u95ee\u63a7\u5236\u66f4\u5b89\u5168\u3002",extra:[Object(N.jsx)(O.a,{type:"primary",danger:!0,onClick:function(){Ln({title:"\u60a8\u786e\u8ba4\u8981\u89e3\u9664\u53cc\u56e0\u7d20\u8ba4\u8bc1\u5417\uff1f",icon:Object(N.jsx)(ze.a,{}),content:"\u89e3\u9664\u4e4b\u540e\u53ef\u80fd\u5b58\u5728\u7cfb\u7edf\u8d26\u53f7\u88ab\u66b4\u529b\u7834\u89e3\u7684\u98ce\u9669\u3002",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.post("/account/reset-totp");case 2:if(1!==(a=t.sent).code){t.next=9;break}return z.b.success("\u53cc\u56e0\u7d20\u8ba4\u8bc1\u89e3\u9664\u6210\u529f"),t.next=7,e.loadInfo();case 7:t.next=10;break;case 9:z.b.error(a.message);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),onCancel:function(){console.log("Cancel")}})},children:"\u89e3\u9664\u7ed1\u5b9a"},"console"),Object(N.jsx)(O.a,{onClick:this.resetTOTP,children:"\u91cd\u65b0\u7ed1\u5b9a"},"re-bind")]}):Object(N.jsx)(ea.a,{status:"warning",title:"\u60a8\u8fd8\u672a\u5f00\u542f\u53cc\u56e0\u7d20\u8ba4\u8bc1\uff01",subTitle:"\u7cfb\u7edf\u8d26\u53f7\u5b58\u5728\u88ab\u66b4\u529b\u7834\u89e3\u7684\u98ce\u9669\u3002",extra:Object(N.jsx)(O.a,{type:"primary",onClick:this.resetTOTP,children:"\u53bb\u5f00\u542f"},"bind")})}))}),Object(N.jsxs)(je.a,{hidden:!this.state.qr,onFinish:this.confirmTOTP,children:[Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},zn),{},{label:"\u4e8c\u7ef4\u7801",children:Object(N.jsxs)(ie.b,{size:12,children:[Object(N.jsx)(w.a,{hoverable:!0,style:{width:280},cover:Object(N.jsx)(Pn.a,{style:{padding:20},width:280,src:"data:image/png;base64, "+this.state.qr}),children:Object(N.jsx)(Fn,{title:"\u53cc\u56e0\u7d20\u8ba4\u8bc1\u4e8c\u7ef4\u7801",description:"\u6709\u6548\u671f30\u79d2\uff0c\u5728\u626b\u63cf\u540e\u8bf7\u5c3d\u5feb\u8f93\u5165\u3002\u63a8\u8350\u4f7f\u7528Google Authenticator, Authy \u6216\u8005 Microsoft Authenticator\u3002"})}),Object(N.jsx)(O.a,{type:"primary",icon:Object(N.jsx)(vt.a,{}),onClick:this.resetTOTP,children:"\u91cd\u65b0\u52a0\u8f7d"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},zn),{},{name:"totp",label:"TOTP",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"}],children:Object(N.jsx)(ae.a,{placeholder:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Nn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u786e\u8ba4"})}))]})]})})}}]),a}(n.Component),Bn=Vn,Mn=a(15),Kn=a(670),An=h.a.Content,Wn=oe.a.Option,En=Kn.a.TabPane,Un=ne.a.Title,Hn={labelCol:{span:12},wrapperCol:{span:12}},Gn={labelCol:{span:12},wrapperCol:{span:12}},Jn=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={refs:[],properties:{}},e.rdpSettingFormRef=s.a.createRef(),e.sshSettingFormRef=s.a.createRef(),e.vncSettingFormRef=s.a.createRef(),e.guacdSettingFormRef=s.a.createRef(),e.mailSettingFormRef=s.a.createRef(),e.logSettingFormRef=s.a.createRef(),e.otherSettingFormRef=s.a.createRef(),e.changeProperties=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.put("/properties",t);case 2:1===(a=e.sent).code?z.b.success("\u4fee\u6539\u6210\u529f"):z.b.error(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.getProperties=Object(o.a)(Object(i.a)().mark((function t(){var a,n,s,r,c,o;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/properties");case 2:if(1!==(a=t.sent).code){t.next=19;break}n=a.data,t.t0=Object(i.a)().keys(n);case 6:if((t.t1=t.t0()).done){t.next=14;break}if(s=t.t1.value,n.hasOwnProperty(s)){t.next=10;break}return t.abrupt("continue",6);case 10:"-"===n[s]&&(n[s]=""),(s.startsWith("enable")||s.startsWith("disable"))&&(n[s]=n[s].bool()),t.next=6;break;case 14:e.setState({properties:n}),r=Object(Mn.a)(e.state.refs);try{for(r.s();!(c=r.n()).done;)(o=c.value).current&&o.current.setFieldsValue(n)}catch(l){r.e(l)}finally{r.f()}t.next=20;break;case 19:z.b.error(a.message);case 20:case"end":return t.stop()}}),t)}))),e.handleOnTabChange=function(){e.getProperties()},e.handleImport=function(){var t=window.document.getElementById("file-upload").files;if(0!==t.length){var a=new FileReader;a.onload=Object(o.a)(Object(i.a)().mark((function t(){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse(a.result.toString()),e.setState({importBtnLoading:!0}),t.prev=2,t.next=5,Y.post("/backup/import",n);case 5:1===(s=t.sent).code?z.b.success("\u6062\u590d\u6210\u529f",3):z.b.error(s.message,10);case 7:return t.prev=7,e.setState({importBtnLoading:!1}),window.document.getElementById("file-upload").value="",t.finish(7);case 11:case"end":return t.stop()}}),t,null,[[2,,7,11]])}))),a.readAsText(t[0])}},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){String.prototype.bool=function(){return/^true$/i.test(this)},this.setState({refs:[this.rdpSettingFormRef,this.sshSettingFormRef,this.vncSettingFormRef,this.guacdSettingFormRef,this.mailSettingFormRef,this.logSettingFormRef,this.otherSettingFormRef]},this.getProperties)}},{key:"render",value:function(){var e=this;return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(An,{className:"site-layout-background page-content",children:Object(N.jsxs)(Kn.a,{tabPosition:"left",onChange:this.handleOnTabChange,tabBarStyle:{width:150},children:[Object(N.jsx)(En,{tab:"RDP\u914d\u7f6e",children:Object(N.jsxs)(je.a,{ref:this.rdpSettingFormRef,name:"rdp",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(Un,{level:3,children:"RDP\u914d\u7f6e(\u8fdc\u7a0b\u684c\u9762)"}),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-wallpaper",label:"\u542f\u7528\u684c\u9762\u5899\u7eb8",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-theming",label:"\u542f\u7528\u684c\u9762\u4e3b\u9898",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-font-smoothing",label:"\u542f\u7528\u5b57\u4f53\u5e73\u6ed1\uff08ClearType\uff09",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-full-window-drag",label:"\u542f\u7528\u5168\u7a97\u53e3\u62d6\u62fd",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-desktop-composition",label:"\u542f\u7528\u684c\u9762\u5408\u6210\u6548\u679c\uff08Aero\uff09",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-menu-animations",label:"\u542f\u7528\u83dc\u5355\u52a8\u753b",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"disable-bitmap-caching",label:"\u7981\u7528\u4f4d\u56fe\u7f13\u5b58",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"disable-offscreen-caching",label:"\u7981\u7528\u79bb\u5c4f\u7f13\u5b58",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})},"rdp"),Object(N.jsx)(En,{tab:"SSH/TELNET\u914d\u7f6e",children:Object(N.jsxs)(je.a,{ref:this.sshSettingFormRef,name:"ssh",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(Un,{level:3,children:"SSH/TELNET\u914d\u7f6e"}),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"color-scheme",label:"\u914d\u8272\u65b9\u6848",rules:[{required:!0,message:"\u914d\u8272\u65b9\u6848"}],initialValue:"gray-black",children:Object(N.jsxs)(oe.a,{style:{width:120},onChange:null,children:[Object(N.jsx)(Wn,{value:"gray-black",children:"\u9ed1\u5e95\u7070\u5b57"}),Object(N.jsx)(Wn,{value:"green-black",children:"\u9ed1\u5e95\u7eff\u5b57"}),Object(N.jsx)(Wn,{value:"white-black",children:"\u9ed1\u5e95\u767d\u5b57"}),Object(N.jsx)(Wn,{value:"black-white",children:"\u767d\u5e95\u9ed1\u5b57"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"font-name",label:"\u5b57\u4f53\u540d\u79f0",rules:[{required:!0,message:"\u5b57\u4f53\u540d\u79f0"}],children:Object(N.jsx)(ae.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5b57\u4f53\u540d\u79f0"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"font-size",label:"\u5b57\u4f53\u5927\u5c0f",rules:[{required:!0,message:"\u5b57\u4f53\u5927\u5c0f"}],children:Object(N.jsx)(ae.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5b57\u4f53\u5927\u5c0f"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({name:"backspace",label:"\u9000\u683c\u952e\u6620\u5c04"},Hn),{},{initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,children:[Object(N.jsx)(Wn,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(Wn,{value:"127",children:"\u5220\u9664\u952e(Ctrl-?)"}),Object(N.jsx)(Wn,{value:"8",children:"\u9000\u683c\u952e(Ctrl-H)"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({name:"terminal-type",label:"\u7ec8\u7aef\u7c7b\u578b"},Hn),{},{initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,children:[Object(N.jsx)(Wn,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(Wn,{value:"ansi",children:"ansi"}),Object(N.jsx)(Wn,{value:"linux",children:"linux"}),Object(N.jsx)(Wn,{value:"vt100",children:"vt100"}),Object(N.jsx)(Wn,{value:"vt220",children:"vt220"}),Object(N.jsx)(Wn,{value:"xterm",children:"xterm"}),Object(N.jsx)(Wn,{value:"xterm-256color",children:"xterm-256color"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})},"ssh"),Object(N.jsx)(En,{tab:"VNC\u914d\u7f6e",children:Object(N.jsxs)(je.a,{ref:this.vncSettingFormRef,name:"vnc",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(Un,{level:3,children:"VNC\u914d\u7f6e"}),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"color-depth",label:"\u8272\u5f69\u6df1\u5ea6",initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,children:[Object(N.jsx)(Wn,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(Wn,{value:"16",children:"\u4f4e\u8272\uff0816\u4f4d\uff09"}),Object(N.jsx)(Wn,{value:"24",children:"\u771f\u5f69\uff0824\u4f4d\uff09"}),Object(N.jsx)(Wn,{value:"32",children:"\u771f\u5f69\uff0832\u4f4d\uff09"}),Object(N.jsx)(Wn,{value:"8",children:"256\u8272"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"cursor",label:"\u5149\u6807",initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,children:[Object(N.jsx)(Wn,{value:"",children:"\u9ed8\u8ba4"}),Object(N.jsx)(Wn,{value:"local",children:"\u672c\u5730"}),Object(N.jsx)(Wn,{value:"remote",children:"\u8fdc\u7a0b"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"swap-red-blue",label:"\u4ea4\u6362\u7ea2\u84dd\u6210\u5206",valuePropName:"checked",children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{label:"\u76ee\u6807\u4e3b\u673a",tooltip:"\u8fde\u63a5\u5230VNC\u4ee3\u7406\uff08\u4f8b\u5982UltraVNC Repeater\uff09\u65f6\u8981\u8bf7\u6c42\u7684\u76ee\u6807\u4e3b\u673a\u3002",name:"dest-host",children:Object(N.jsx)(ae.a,{placeholder:"\u76ee\u6807\u4e3b\u673a"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{label:"\u76ee\u6807\u7aef\u53e3",tooltip:"\u8fde\u63a5\u5230VNC\u4ee3\u7406\uff08\u4f8b\u5982UltraVNC Repeater\uff09\u65f6\u8981\u8bf7\u6c42\u7684\u76ee\u6807\u7aef\u53e3\u3002",name:"dest-port",children:Object(N.jsx)(ae.a,{type:"number",min:1,max:65535,placeholder:"\u76ee\u6807\u7aef\u53e3"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})},"vnc"),Object(N.jsxs)(En,{tab:"\u5f55\u5c4f\u914d\u7f6e",children:[Object(N.jsx)(Un,{level:3,children:"\u5f55\u5c4f\u914d\u7f6e"}),Object(N.jsxs)(je.a,{ref:this.guacdSettingFormRef,name:"guacd",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"enable-recording",label:"\u5f00\u542f\u5f55\u5c4f",valuePropName:"checked",rules:[{required:!0}],children:Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed",onChange:function(t){e.setState({properties:Object(g.a)(Object(g.a)({},e.state.properties),{},{"enable-recording":t})})}})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"session-saved-limit",label:"\u4f1a\u8bdd\u5f55\u5c4f\u4fdd\u5b58\u65f6\u957f",initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,disabled:!this.state.properties["enable-recording"],children:[Object(N.jsx)(Wn,{value:"",children:"\u6c38\u4e45"}),Object(N.jsx)(Wn,{value:"30",children:"30\u5929"}),Object(N.jsx)(Wn,{value:"60",children:"60\u5929"}),Object(N.jsx)(Wn,{value:"180",children:"180\u5929"}),Object(N.jsx)(Wn,{value:"360",children:"360\u5929"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})]},"guacd"),Object(N.jsxs)(En,{tab:"\u90ae\u7bb1\u914d\u7f6e",children:[Object(N.jsx)(Un,{level:3,children:"\u90ae\u7bb1\u914d\u7f6e"}),Object(N.jsx)(he.a,{message:"\u914d\u7f6e\u90ae\u7bb1\u540e\uff0c\u6dfb\u52a0\u7528\u6237\u5c06\u5411\u5bf9\u65b9\u7684\u90ae\u7bb1\u53d1\u9001\u8d26\u53f7\u5bc6\u7801\u3002",type:"info",style:{marginBottom:10}}),Object(N.jsxs)(je.a,{ref:this.mailSettingFormRef,name:"mail",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"mail-host",label:"\u90ae\u4ef6\u670d\u52a1\u5668\u5730\u5740",rules:[{required:!1,message:"\u90ae\u4ef6\u670d\u52a1\u5668\u5730\u5740"}],children:Object(N.jsx)(ae.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u90ae\u4ef6\u670d\u52a1\u5668\u5730\u5740"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"mail-port",label:"\u90ae\u4ef6\u670d\u52a1\u5668\u7aef\u53e3",rules:[{required:!1,message:"\u90ae\u4ef6\u670d\u52a1\u5668\u7aef\u53e3",min:1,max:65535}],children:Object(N.jsx)(ae.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u90ae\u4ef6\u670d\u52a1\u5668\u7aef\u53e3"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"mail-username",label:"\u90ae\u7bb1\u8d26\u53f7",rules:[{required:!1,type:"email",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u8d26\u53f7"}],children:Object(N.jsx)(ae.a,{type:"email",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u8d26\u53f7"})})),Object(N.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"mail-password",label:"\u90ae\u7bb1\u5bc6\u7801",rules:[{required:!1,message:"\u90ae\u7bb1\u5bc6\u7801"}],children:Object(N.jsx)(ae.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u5bc6\u7801"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})]},"mail"),Object(N.jsxs)(En,{tab:"\u65e5\u5fd7\u914d\u7f6e",children:[Object(N.jsx)(Un,{level:3,children:"\u65e5\u5fd7\u914d\u7f6e"}),Object(N.jsxs)(je.a,{ref:this.logSettingFormRef,name:"log",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"login-log-saved-limit",label:"\u767b\u5f55\u65e5\u5fd7\u4fdd\u7559\u65f6\u957f",initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,children:[Object(N.jsx)(Wn,{value:"",children:"\u6c38\u4e45"}),Object(N.jsx)(Wn,{value:"30",children:"30\u5929"}),Object(N.jsx)(Wn,{value:"60",children:"60\u5929"}),Object(N.jsx)(Wn,{value:"180",children:"180\u5929"}),Object(N.jsx)(Wn,{value:"360",children:"360\u5929"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"cron-log-saved-limit",label:"\u8ba1\u5212\u4efb\u52a1\u65e5\u5fd7\u4fdd\u7559\u65f6\u957f",initialValue:"",children:Object(N.jsxs)(oe.a,{onChange:null,children:[Object(N.jsx)(Wn,{value:"",children:"\u6c38\u4e45"}),Object(N.jsx)(Wn,{value:"30",children:"30\u5929"}),Object(N.jsx)(Wn,{value:"60",children:"60\u5929"}),Object(N.jsx)(Wn,{value:"180",children:"180\u5929"}),Object(N.jsx)(Wn,{value:"360",children:"360\u5929"})]})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})]},"log"),Object(N.jsxs)(En,{tab:"\u5176\u4ed6\u914d\u7f6e",children:[Object(N.jsx)(Un,{level:3,children:"\u5176\u4ed6\u914d\u7f6e"}),Object(N.jsxs)(je.a,{ref:this.otherSettingFormRef,name:"other",onFinish:this.changeProperties,layout:"vertical",children:[Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Hn),{},{name:"user-default-storage-size",label:"\u7528\u6237\u7a7a\u95f4\u9ed8\u8ba4\u5927\u5c0f",tooltip:"\u65e0\u9650\u5236\u8bf7\u586b\u5199-1",children:Object(N.jsx)(ae.a,{type:"number",min:-1,suffix:"MB"})})),Object(N.jsx)(je.a.Item,Object(g.a)(Object(g.a)({},Gn),{},{children:Object(N.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})}))]})]},"other"),Object(N.jsxs)(En,{tab:"\u5907\u4efd\u4e0e\u6062\u590d",children:[Object(N.jsx)(Un,{level:3,children:"\u5907\u4efd\u4e0e\u6062\u590d"}),Object(N.jsxs)(ie.b,{direction:"vertical",children:[Object(N.jsx)(he.a,{message:"\u6062\u590d\u6570\u636e\u65f6\uff0c\u5982\u5b58\u5728\u767b\u5f55\u8d26\u53f7\u76f8\u540c\u7684\u7528\u6237\u65f6\uff0c\u4f1a\u4fdd\u7559\u539f\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\uff0c\u6b64\u5916\u7531\u4e8e\u767b\u5f55\u5bc6\u7801\u52a0\u5bc6\u4e4b\u540e\u4e0d\u53ef\u9006\uff0c\u6062\u590d\u7684\u8d26\u6237\u5bc6\u7801\u5c06\u968f\u673a\u4ea7\u751f\u3002",type:"info"}),Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(O.a,{type:"primary",onClick:function(){A("".concat(q,"/backup/export?X-Auth-Token=").concat(V(),"&t=").concat((new Date).getTime()))},children:"\u5bfc\u51fa\u5907\u4efd"}),Object(N.jsx)(O.a,{type:"dashed",loading:this.state.importBtnLoading,onClick:function(){window.document.getElementById("file-upload").click()},children:"\u6062\u590d\u5907\u4efd"}),Object(N.jsx)("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:this.handleImport})]})]})]},"backup")]})})})}}]),a}(n.Component),Xn=Jn,$n=a(1269),Yn=(a(619),a(1228),function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={term:void 0,webSocket:void 0,fitAddon:void 0},e.componentDidMount=Object(o.a)(Object(i.a)().mark((function t(){var a,n,s,r,c,o,l,d,u,j;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.command,n=e.props.assetId,t.next=4,e.createSession(n);case 4:if(s=t.sent,!E(s)){t.next=7;break}return t.abrupt("return");case 7:(r=new na.Terminal({fontFamily:'monaco, Consolas, "Lucida Console", monospace',fontSize:14,theme:{background:"#1b1b1b"},rightClickSelectsWord:!0})).open(e.refs.terminal),c=new ca.FitAddon,r.loadAddon(c),c.fit(),r.focus(),r.writeln("Trying to connect to the server ..."),r.onData((function(t){var a=e.state.webSocket;void 0!==a&&a.send(new ra(ra.Data,t).toString())})),o=V(),l={cols:r.cols,rows:r.rows,sessionId:s,"X-Auth-Token":o},d=pe.a.stringify(l),u=new WebSocket("".concat(D,"/sessions/").concat(s,"/ssh?").concat(d)),e.props.appendWebsocket({id:n,ws:u}),u.onopen=function(t){e.onWindowResize()},u.onerror=function(e){r.writeln("Failed to connect to server.")},u.onclose=function(e){r.writeln("Connection is closed.")},j=!1,u.onmessage=function(t){var n=ra.parse(t.data);switch(n.type){case ra.Connected:r.clear(),e.updateSessionStatus(s);break;case ra.Data:r.write(n.content);break;case ra.Closed:r.writeln("\x1b[1;3;31m".concat(n.content,"\x1b[0m ")),u.close()}if(!j){if(""!==a){var c=e.state.webSocket;void 0!==c&&c.readyState===WebSocket.OPEN&&c.send(new ra(ra.Data,a+String.fromCharCode(13)).toString())}j=!0}},e.setState({term:r,fitAddon:c,webSocket:u}),window.addEventListener("resize",e.onWindowResize);case 27:case"end":return t.stop()}}),t)}))),e.updateSessionStatus=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions/".concat(t,"/connect"));case 2:1!==(a=e.sent).code&&z.b.error(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.onWindowResize=function(t){var a=e.state.term,n=e.state.fitAddon,s=e.state.webSocket;e.setState({width:window.innerWidth,height:window.innerHeight},(function(){if(s&&s.readyState===WebSocket.OPEN){n.fit(),e.focus();var t={cols:a.cols,rows:a.rows};s.send(new ra(ra.Resize,window.btoa(JSON.stringify(t))).toString())}}))},e.focus=function(){var t=e.state.term;t&&t.focus()},e}return Object(d.a)(a,[{key:"componentWillUnmount",value:function(){var e=this.state.webSocket;e&&e.close()}},{key:"createSession",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions?assetId=".concat(t,"&mode=native"));case 2:if(1===(a=e.sent).code){e.next=6;break}return this.showMessage(a.message),e.abrupt("return",null);case 6:return e.abrupt("return",a.data.id);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(N.jsx)("div",{children:Object(N.jsx)("div",{style:{width:(window.innerWidth-254)/2,height:456},children:Object(N.jsx)("div",{ref:"terminal",id:"terminal",style:{backgroundColor:"#1b1b1b"}})})})}}]),a}(n.Component)),_n=Yn,Zn=(a(1229),ae.a.Search),Qn=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).commandRef=s.a.createRef(),e.state={webSockets:[],assets:[],active:void 0,loading:!0},e.init=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/commands/".concat(a));case 2:if(1===(s=t.sent).code){t.next=7;break}return z.b.error(s.message,10),e.setState({loading:!1}),t.abrupt("return");case 7:r=s.data.content,e.setState({loading:!1,command:r,assets:n});case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.onPaneChange=function(t){e.setState({activeKey:t})},e.appendWebsocket=function(t){e.state.webSockets.push(t)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=new URLSearchParams(this.props.location.search),t=JSON.parse(e.get("assets")),a=e.get("commandId");this.init(a,t)}},{key:"render",value:function(){var e=this;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Qt.a,{spinning:this.state.loading,tip:"\u6b63\u5728\u83b7\u53d6\u6307\u4ee4\u5185\u5bb9...",children:[Object(N.jsx)("div",{className:"page-search",children:Object(N.jsx)(Zn,{ref:this.commandRef,placeholder:"\u8bf7\u8f93\u5165\u6307\u4ee4",onSearch:function(t){for(var a=0;a<e.state.webSockets.length;a++){var n=e.state.webSockets[a].ws;n.readyState===WebSocket.OPEN&&n.send(new ra(ra.Data,t+String.fromCharCode(13)).toString())}e.commandRef.current.setValue("")},enterButton:"\u6267\u884c"})}),Object(N.jsx)("div",{className:"page-card",children:Object(N.jsx)($n.b,{grid:{gutter:16,column:2},dataSource:this.state.assets,renderItem:function(t){return Object(N.jsx)($n.b.Item,{children:Object(N.jsx)(w.a,{title:t.name,className:["console-card",e.state.active===t.id?"command-active":""],onClick:function(){e.state.active===t.id?e.setState({active:void 0}):e.setState({active:t.id})},children:Object(N.jsx)(_n,{assetId:t.id,command:e.state.command,appendWebsocket:e.appendWebsocket})})})}})})]})})}}]),a}(n.Component),es=Qn,ts=function(e){var t=e.title,a=e.visible,n=e.handleOk,s=e.handleCancel,r=e.confirmLoading,c=e.model,l=e.users,d=Oe.Form.useForm(),u=Object(me.a)(d,1)[0];return Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,destroyOnClose:!0,onOk:function(){u.validateFields().then(function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:e.sent&&u.resetFields();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onCancel:s,confirmLoading:r,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:u},{labelCol:{span:6},wrapperCol:{span:14}}),{},{initialValues:c,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u7ec4\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u7ec4\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7528\u6237\u7ec4\u6210\u5458",name:"members",children:Object(N.jsx)(Oe.Select,{mode:"multiple",allowClear:!0,placeholder:"\u7528\u6237\u7ec4\u6210\u5458",filterOption:!1,children:l.map((function(e){return Object(N.jsx)(Oe.Select.Option,{value:e.id,children:e.nickname},e.id)}))})})]}))})},as=te.a.confirm,ns=ae.a.Search,ss=ne.a.Title,rs=ne.a.Text,cs=h.a.Content,is=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,model:void 0,selectedRowKeys:[],delBtnLoading:!1,users:[]},e.handleChangPage=function(t,a){var n=e.state.queryParams;n.pageIndex=t,n.pageSize=a,e.setState({queryParams:n}),e.loadTableData(n)},e.showModal=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n,s){var r,c,o;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.state.items,c={},!n){t.next=15;break}return r[s].updateBtnLoading=!0,e.setState({items:r}),t.next=7,Y.get("/user-groups/"+n);case 7:if(1===(o=t.sent).code){t.next=13;break}return z.b.error(o.message),r[s].updateBtnLoading=!1,e.setState({items:r}),t.abrupt("return");case 13:r[s].updateBtnLoading=!1,c=o.data;case 15:return t.next=17,e.handleSearchByNickname("");case 17:e.setState({model:c,modalVisible:!0,modalTitle:a});case 18:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e.handleCancelModal=function(){e.setState({modalVisible:!1,modalTitle:"",model:void 0})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),t.prev=1,!a.id){t.next=18;break}return t.next=5,Y.put("/user-groups/"+a.id,a);case 5:if(1!==(n=t.sent).code){t.next=14;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=11,e.loadTableData(e.state.queryParams);case 11:case 26:return t.abrupt("return",!0);case 14:return z.b.error(n.message,10),t.abrupt("return",!1);case 16:t.next=31;break;case 18:return t.next=20,Y.post("/user-groups",a);case 20:if(1!==(s=t.sent).code){t.next=29;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({modalVisible:!1}),t.next=26,e.loadTableData(e.state.queryParams);case 29:return z.b.error(s.message,10),t.abrupt("return",!1);case 31:return t.prev=31,e.setState({modalConfirmLoading:!1}),t.finish(31);case 34:case"end":return t.stop()}}),t,null,[[1,,31,34]])})));return function(e){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/user-groups/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleSearchByNickname=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/users/paging?pageIndex=1&pageSize=1000&nickname=".concat(a));case 2:if(1===(n=t.sent).code){t.next=6;break}return z.b.error(n.message,10),t.abrupt("return");case 6:e.setState({users:n.data.items});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleAssetCancel=function(){e.loadTableData(),e.setState({assetVisible:!1})},e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/user-groups/"+t);case 2:if(1!==(a=e.sent).code){e.next=9;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.next=7,this.loadTableData(this.state.queryParams);case 7:e.next=10;break;case 9:z.b.error(a.message,10);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/user-groups/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message,10),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,this.setState({items:n.items,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[4,11,13,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;as({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u7528\u6237\u7ec4\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u540d\u79f0",dataIndex:"name",sorter:!0,render:function(t,a,n){return Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].updateBtnLoading,onClick:function(){return e.showModal("\u66f4\u65b0\u7528\u6237\u7ec4",a.id,n)},children:t})}},{title:"\u6388\u6743\u8d44\u4ea7",dataIndex:"assetCount",key:"assetCount",render:function(t,a){return Object(N.jsx)(O.a,{type:"link",onClick:Object(o.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({assetVisible:!0,userGroupId:a.id});case 1:case"end":return t.stop()}}),t)}))),children:t})}},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].updateBtnLoading,onClick:function(){return e.showModal("\u66f4\u65b0\u7528\u6237\u7ec4",a.id,n)},children:"\u7f16\u8f91"}),Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){e.setState({assetVisible:!0,userGroupId:a.id})},children:"\u8d44\u4ea7\u6388\u6743"}),Object(N.jsx)(O.a,{type:"link",size:"small",danger:!0,onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(cs,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:8,children:Object(N.jsx)(ss,{level:3,children:"\u7528\u6237\u7ec4\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:16,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(ns,{ref:this.inputRefOfName,placeholder:"\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u7528\u6237\u7ec4")}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(rs,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});as({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,rowKey:"id",dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(ts,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model,users:this.state.users}):void 0,Object(N.jsx)(et.a,{title:"\u8d44\u4ea7\u6388\u6743",placement:"right",closable:!0,destroyOnClose:!0,onClose:function(){e.loadTableData(e.state.queryParams),e.setState({assetVisible:!1})},visible:this.state.assetVisible,width:.8*window.innerWidth,children:Object(N.jsx)(Ut,{userGroupId:this.state.userGroupId})})]})})}}]),a}(n.Component),os=is,ls=te.a.confirm,ds=h.a.Content,us=ae.a.Search,js=ne.a.Title,hs=ne.a.Text,bs=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfClientIp=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10,userId:void 0},loading:!1,selectedRowKeys:[],delBtnLoading:!1,users:[]},e.handleChangPage=function(t,a){var n=e.state.queryParams;n.pageIndex=t,n.pageSize=a,e.setState({queryParams:n}),e.loadTableData(n)},e.handleSearchByClientIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,clientIp:t});e.loadTableData(a)},e.handleSearchByUsername=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,username:t});e.loadTableData(a)},e.handleChangeByState=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,state:t});e.loadTableData(a)},e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/login-logs/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.clearLoginLogs=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({clearBtnLoading:!0}),t.prev=1,t.next=4,Y.post("/login-logs/clear");case 4:1===(a=t.sent).code?(z.b.success("\u64cd\u4f5c\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u767b\u5f55\u9875\u9762\u3002",3),e.setState({selectedRowKeys:[]}),setTimeout((function(){window.location.reload()}),3e3)):z.b.error(a.message,10);case 6:return t.prev=6,e.setState({clearBtnLoading:!1}),t.finish(6);case 9:case"end":return t.stop()}}),t,null,[[1,,6,9]])}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||this.state.queryParams,this.setState({queryParams:t,loading:!0}),a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/login-logs/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u767b\u5f55\u8d26\u53f7",dataIndex:"username",key:"username"},{title:"\u767b\u5f55IP",dataIndex:"clientIp",key:"clientIp"},{title:"\u767b\u5f55\u72b6\u6001",dataIndex:"state",key:"state",render:function(e){return"0"===e?Object(N.jsx)(re.a,{color:"error",children:"\u5931\u8d25"}):Object(N.jsx)(re.a,{color:"success",children:"\u6210\u529f"})}},{title:"\u5931\u8d25\u539f\u56e0",dataIndex:"reason",key:"reason"},{title:"\u6d4f\u89c8\u5668",dataIndex:"clientUserAgent",key:"clientUserAgent",render:function(e,t){return E(e)?"\u672a\u77e5":Object(N.jsx)(se.a,{placement:"topLeft",title:e,children:e.split(" ")[0]})}},{title:"\u767b\u5f55\u65f6\u95f4",dataIndex:"loginTime",key:"loginTime",render:function(e,t){return function(e,t){var a=new Date(e),n={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[s]:("00"+n[s]).substr((""+n[s]).length)));return t}(e,"yyyy-MM-dd hh:mm:ss")}},{title:"\u6ce8\u9500\u65f6\u95f4",dataIndex:"logoutTime",key:"logoutTime",render:function(e,t){return E(e)||"0001-01-01 00:00:00"===e?"":e}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){return Object(N.jsx)("div",{children:Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){ls({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u6761\u767b\u5f55\u65e5\u5fd7\u5417?",content:"\u5220\u9664\u7528\u6237\u672a\u6ce8\u9500\u7684\u767b\u5f55\u65e5\u5fd7\u5c06\u4f1a\u5f3a\u5236\u7528\u6237\u4e0b\u7ebf",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){t(a.id)}});var t=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.delete("/login-logs/".concat(a));case 2:1===(n=t.sent).code?(ue.a.success({message:"\u63d0\u793a",description:"\u5220\u9664\u6210\u529f"}),e.loadTableData()):ue.a.error({message:"\u63d0\u793a",description:n.message});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},children:"\u5220\u9664"})})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(ds,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:8,children:Object(N.jsx)(js,{level:3,children:"\u767b\u5f55\u65e5\u5fd7\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:16,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(us,{ref:this.inputRefOfClientIp,placeholder:"\u767b\u5f55\u8d26\u53f7",allowClear:!0,onSearch:this.handleSearchByUsername}),Object(N.jsx)(us,{ref:this.inputRefOfClientIp,placeholder:"\u767b\u5f55IP",allowClear:!0,onSearch:this.handleSearchByClientIp}),Object(N.jsxs)(oe.a,{style:{width:100},placeholder:"\u7528\u6237\u6635\u79f0",onChange:this.handleChangeByState,defaultValue:"",children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u72b6\u6001"}),Object(N.jsx)(oe.a.Option,{value:"1",children:"\u53ea\u770b\u6210\u529f"}),Object(N.jsx)(oe.a.Option,{value:"0",children:"\u53ea\u770b\u5931\u8d25"})]}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfClientIp.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,protocol:"",userId:void 0,assetId:void 0})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"dashed",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(hs,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});ls({icon:Object(N.jsx)(ze.a,{}),title:t,content:"\u5220\u9664\u7528\u6237\u672a\u6ce8\u9500\u7684\u767b\u5f55\u65e5\u5fd7\u5c06\u4f1a\u5f3a\u5236\u7528\u6237\u4e0b\u7ebf",onOk:function(){e.batchDelete()},onCancel:function(){}})}})}),Object(N.jsx)(se.a,{title:"\u6e05\u7a7a",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,icon:Object(N.jsx)(Sa.a,{}),loading:this.state.clearBtnLoading,onClick:function(){var t=Object(N.jsx)(hs,{style:{color:"red"},strong:!0,children:"\u60a8\u786e\u5b9a\u8981\u6e05\u7a7a\u5168\u90e8\u7684\u767b\u5f55\u65e5\u5fd7\u5417\uff1f"});ls({icon:Object(N.jsx)(ze.a,{}),title:t,content:"\u5220\u9664\u7528\u6237\u672a\u6ce8\u9500\u7684\u767b\u5f55\u65e5\u5fd7\u5c06\u4f1a\u5f3a\u5236\u7528\u6237\u4e0b\u7ebf\uff0c\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\u4e5f\u4f1a\u9000\u51fa\u767b\u5f55\u3002",okType:"danger",onOk:e.clearLoginLogs,onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading})]})})}}]),a}(n.Component),ps=bs,ms=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).statsRef=void 0,e.state={width:window.innerWidth,height:window.innerHeight,term:void 0,webSocket:void 0,fitAddon:void 0,sessionId:void 0,session:{},enterBtnIndex:1001,commands:[]},e.componentDidMount=Object(o.a)(Object(i.a)().mark((function t(){var a,n,s,r,c,l,d,u,j,h,b,p;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new URLSearchParams(e.props.location.search),n=a.get("assetId"),document.title=a.get("assetName"),t.next=5,e.createSession(n);case 5:if(s=t.sent){t.next=8;break}return t.abrupt("return");case 8:if(r=s.id,!E(r)){t.next=11;break}return t.abrupt("return");case 11:c=new na.Terminal({fontFamily:'monaco, Consolas, "Lucida Console", monospace',fontSize:15,theme:{background:"#1b1b1b"},rightClickSelectsWord:!0}),l=document.getElementById("terminal"),c.open(l),d=new ca.FitAddon,c.loadAddon(d),d.fit(),c.focus(),c.writeln("Trying to connect to the server ..."),c.onSelectionChange(Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=c.getSelection(),e.setState({selection:a}),!navigator.clipboard){t.next=5;break}return t.next=5,navigator.clipboard.writeText(a);case 5:case"end":return t.stop()}}),t)})))),c.attachCustomKeyEventHandler((function(t){return(!t.ctrlKey||"c"!==t.key||!e.state.selection)&&!(t.ctrlKey&&"v"===t.key)})),document.body.oncopy=function(t){return t.preventDefault(),"0"!==e.state.session.copy&&(t.clipboardData?t.clipboardData.setData("text",""):window.clipboardData.setData("text",""))},document.body.onpaste=function(t){return t.preventDefault(),"0"!==e.state.session.paste},c.onData((function(t){var a=e.state.webSocket;void 0!==a&&a.send(new ra(ra.Data,t).toString())})),u=V(),j={cols:c.cols,rows:c.rows,"X-Auth-Token":u},h=pe.a.stringify(j),(b=new WebSocket("".concat(D,"/sessions/").concat(r,"/ssh?").concat(h))).onopen=function(e){p=setInterval((function(){b.send(new ra(ra.Ping,"").toString())}),1e3)},b.onerror=function(e){c.writeln("Failed to connect to server.")},b.onclose=function(e){c.writeln("Connection is closed."),p&&clearInterval(p)},b.onmessage=function(t){var a=ra.parse(t.data);switch(a.type){case ra.Connected:c.clear(),e.updateSessionStatus(r),e.getCommands();break;case ra.Data:c.write(a.content);break;case ra.Closed:c.writeln("\x1b[1;3;31m".concat(a.content,"\x1b[0m ")),b.close()}},e.setState({term:c,webSocket:b,fitAddon:d,sessionId:r,session:s}),window.addEventListener("resize",e.onWindowResize),window.addEventListener("beforeunload",e.handleUnload),window.onunload=function(){b.close()};case 36:case"end":return t.stop()}}),t)}))),e.getCommands=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/commands");case 2:if(1===(a=t.sent).code){t.next=6;break}return z.b.error(a.message),t.abrupt("return");case 6:e.setState({commands:a.data});case 7:case"end":return t.stop()}}),t)}))),e.updateSessionStatus=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions/".concat(t,"/connect"));case 2:1!==(a=e.sent).code&&z.b.error(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.onWindowResize=function(t){var a=e.state.term,n=e.state.fitAddon,s=e.state.webSocket;e.setState({width:window.innerWidth,height:window.innerHeight},(function(){if(s&&s.readyState===WebSocket.OPEN){n.fit(),e.focus();var t={cols:a.cols,rows:a.rows};s.send(new ra(ra.Resize,window.btoa(JSON.stringify(t))).toString())}}))},e.writeCommand=function(t){var a=e.state.webSocket;void 0!==a&&a.send(new ra(ra.Data,t)),e.focus()},e.focus=function(){var t=e.state.term;t&&t.focus()},e.onRef=function(t){e.statsRef=t},e}return Object(d.a)(a,[{key:"componentWillUnmount",value:function(){var e=this.state.webSocket;e&&e.close(),window.removeEventListener("beforeunload",this.handleUnload)}},{key:"showMessage",value:function(e){z.b.destroy(),te.a.confirm({title:"\u63d0\u793a",icon:Object(N.jsx)(ze.a,{}),content:e,centered:!0,okText:"\u91cd\u65b0\u8fde\u63a5",cancelText:"\u5173\u95ed\u9875\u9762",onOk:function(){window.location.reload()},onCancel:function(){window.close()}})}},{key:"createSession",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/sessions?assetId=".concat(t,"&mode=native"));case 2:if(1===(a=e.sent).code){e.next=6;break}return this.showMessage(a.message),e.abrupt("return",void 0);case 6:return e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"terminalSize",value:function(){return{cols:Math.floor(this.state.width/7.5),rows:Math.floor(window.innerHeight/17)}}},{key:"handleUnload",value:function(e){var t="\u8981\u79bb\u5f00\u7f51\u7ad9\u5417\uff1f";return(e||window.event).returnValue=t,t}},{key:"render",value:function(){var e=this,t=this.state.commands.map((function(t){return Object(N.jsx)(se.a,{placement:"left",title:t.content,color:"blue",children:Object(N.jsx)(b.a.Item,{onClick:function(){e.writeCommand(t.content)},children:t.name},"i-"+t.id)},"t-"+t.id)})),a=Object(N.jsx)(b.a,{children:t});return Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{id:"terminal",style:{height:this.state.height,width:this.state.width,backgroundColor:"#1b1b1b"}}),Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:50,right:50,zIndex:this.state.enterBtnIndex},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(st.a,{}),onClick:function(){e.setState({fileSystemVisible:!0,enterBtnIndex:999})}})})}),Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:50,right:100,zIndex:this.state.enterBtnIndex},children:Object(N.jsx)(m.a,{overlay:a,trigger:["click"],placement:"bottomLeft",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(rt.a,{})})})})}),Object(N.jsx)(ot.a,{children:Object(N.jsx)(Qe.a,{style:{position:"absolute",top:100,right:100,zIndex:this.state.enterBtnIndex},children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(ct.a,{}),onClick:function(){e.setState({statsVisible:!0,enterBtnIndex:999}),e.statsRef&&e.statsRef.addInterval()}})})}),Object(N.jsx)(et.a,{title:"\u4f1a\u8bdd\u8be6\u60c5",placement:"right",width:.8*window.innerWidth,closable:!0,onClose:function(){e.setState({fileSystemVisible:!1,enterBtnIndex:1001}),e.focus()},visible:this.state.fileSystemVisible,children:Object(N.jsx)(Ct,{storageId:this.state.sessionId,storageType:"sessions",upload:"1"===this.state.session.upload,download:"1"===this.state.session.download,delete:"1"===this.state.session.delete,rename:"1"===this.state.session.rename,edit:"1"===this.state.session.edit,minHeight:window.innerHeight-103})}),Object(N.jsx)(et.a,{title:"\u72b6\u6001\u4fe1\u606f",placement:"right",width:.8*window.innerWidth,closable:!0,onClose:function(){e.setState({statsVisible:!1,enterBtnIndex:1001}),e.focus(),e.statsRef&&e.statsRef.delInterval()},visible:this.state.statsVisible,children:Object(N.jsx)(Pt,{sessionId:this.state.sessionId,onRef:this.onRef})})]})}}]),a}(n.Component),Os=ms,xs=a(256),fs=function(e){var t=e.title,a=e.visible,s=e.handleOk,r=e.handleCancel,c=e.confirmLoading,l=e.model,d=Oe.Form.useForm(),u=Object(me.a)(d,1)[0];void 0===l.func&&(l.func="shell-job"),void 0===l.mode&&(l.mode="all");var j=Object(n.useState)(l.func),h=Object(me.a)(j,2),b=h[0],p=h[1],m=Object(n.useState)(l.mode),O=Object(me.a)(m,2),x=O[0],f=O[1],v=Object(n.useState)([]),y=Object(me.a)(v,2),w=y[0],k=y[1];Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,Y.get("/assets?protocol=ssh");case 3:1===(t=e.sent).code?k(t.data):z.b.error(t.message,10),T(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var S=Object(n.useState)(!1),C=Object(me.a)(S,2),I=C[0],T=C[1];return Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){u.validateFields().then((function(e){u.resetFields(),s(e)})).catch((function(e){}))},onCancel:r,confirmLoading:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:u},{labelCol:{span:6},wrapperCol:{span:14}}),{},{initialValues:l,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4efb\u52a1\u7c7b\u578b",name:"func",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4efb\u52a1\u7c7b\u578b"}],children:Object(N.jsxs)(Oe.Select,{onChange:function(e){p(e)},children:[Object(N.jsx)(Oe.Select.Option,{value:"shell-job",children:"Shell\u811a\u672c"}),Object(N.jsx)(Oe.Select.Option,{value:"check-asset-status-job",children:"\u8d44\u4ea7\u72b6\u6001\u68c0\u6d4b"})]})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4efb\u52a1\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d\u79f0"})}),"shell-job"===b?Object(N.jsx)(Oe.Form.Item,{label:"Shell\u811a\u672c",name:"shell",rules:[{required:!0,message:"\u8bf7\u8f93\u5165Shell\u811a\u672c"}],children:Object(N.jsx)(xs.a,{autoSize:{minRows:5,maxRows:10},placeholder:"\u5728\u6b64\u5904\u586b\u5199Shell\u811a\u672c\u5185\u5bb9"})}):void 0,Object(N.jsx)(Oe.Form.Item,{label:"cron\u8868\u8fbe\u5f0f",name:"cron",rules:[{required:!0,message:"\u8bf7\u8f93\u5165cron\u8868\u8fbe\u5f0f"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8bf7\u8f93\u5165cron\u8868\u8fbe\u5f0f"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u8d44\u4ea7\u9009\u62e9",name:"mode",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d44\u4ea7"}],children:Object(N.jsxs)(Oe.Radio.Group,{onChange:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(t.target.value);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(N.jsx)(Oe.Radio,{value:"all",children:"\u5168\u90e8\u8d44\u4ea7"}),Object(N.jsx)(Oe.Radio,{value:"custom",children:"\u81ea\u5b9a\u4e49"})]})}),"custom"===x?Object(N.jsx)(Oe.Spin,{tip:"\u52a0\u8f7d\u4e2d...",spinning:I,children:Object(N.jsx)(Oe.Form.Item,{label:"\u5df2\u9009\u62e9\u8d44\u4ea7",name:"resourceIds",rules:[{required:!0}],children:Object(N.jsx)(Oe.Select,{mode:"multiple",allowClear:!0,placeholder:"\u8bf7\u9009\u62e9\u8d44\u4ea7",children:w.map((function(e){return Object(N.jsx)(Oe.Select.Option,{children:e.name},e.id)}))})})}):void 0]}))})},gs=(a(1230),te.a.confirm),vs=h.a.Content,ys=ne.a.Title,ws=ne.a.Text,ks=ae.a.Search,Ss=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,selectedRow:void 0,selectedRowKeys:[],logPending:!1,logs:[]},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),console.log(a),"shell-job"===a.func&&(console.log(a.shell,JSON.stringify({shell:a.shell})),a.metadata=JSON.stringify({shell:a.shell}),a.shell=void 0),"custom"===a.mode&&(n=a.resourceIds,a.resourceIds=n.join(",")),!a.id){t.next=11;break}return t.next=7,Y.put("/jobs/"+a.id,a);case 7:1===(s=t.sent).code?(z.b.success("\u66f4\u65b0\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u66f4\u65b0\u5931\u8d25 :( "+s.message,10),t.next=15;break;case 11:return t.next=13,Y.post("/jobs",a);case 13:1===(r=t.sent).code?(z.b.success("\u65b0\u589e\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u65b0\u589e\u5931\u8d25 :( "+r.message,10);case 15:e.setState({modalConfirmLoading:!1});case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/jobs/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/jobs/"+t);case 2:1===(a=e.sent).code?(z.b.success("\u5220\u9664\u6210\u529f"),this.loadTableData(this.state.queryParams)):z.b.error(a.message,10);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/jobs/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;gs({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4efb\u52a1\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"showModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"shell-job"===t.func&&(t.shell=JSON.parse(t.metadata).shell),"custom"===t.mode&&(t.resourceIds=t.resourceIds.split(",")),this.setState({modalTitle:e,modalVisible:!0,model:t})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u4efb\u52a1\u540d\u79f0",dataIndex:"name",key:"name",render:function(e,t){var a=e;return a&&a.length>20&&(a=a.substring(0,20)+" ..."),Object(N.jsx)(se.a,{placement:"topLeft",title:e,children:a})},sorter:!0},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(t,a){return Object(N.jsx)(zt.a,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed",checked:"running"===t,onChange:function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){var s,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n?"running":"not-running",t.next=3,Y.post("/jobs/".concat(a.id,"/change-status?status=").concat(s));case 3:if(1!==(r=t.sent).code){t.next=10;break}return z.b.success("\u64cd\u4f5c\u6210\u529f"),t.next=8,e.loadTableData();case 8:t.next=11;break;case 10:z.b.error(r.message);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})}},{title:"\u4efb\u52a1\u7c7b\u578b",dataIndex:"func",key:"func",render:function(e,t){switch(e){case"check-asset-status-job":return Object(N.jsx)(re.a,{color:"green",children:"\u8d44\u4ea7\u72b6\u6001\u68c0\u6d4b"});case"shell-job":return Object(N.jsx)(re.a,{color:"volcano",children:"Shell\u811a\u672c"});default:return""}}},{title:"cron\u8868\u8fbe\u5f0f",dataIndex:"cron",key:"cron"},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u6700\u540e\u6267\u884c\u65e5\u671f",dataIndex:"updated",key:"updated",render:function(e,t){return"0001-01-01 00:00:00"===e?"":Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){var s=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:function(){return e.showModal("\u66f4\u65b0\u8ba1\u5212\u4efb\u52a1",a)},children:"\u7f16\u8f91"})},"0"),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",onClick:Object(o.a)(Object(i.a)().mark((function t(){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({logVisible:!0,logPending:!0}),t.next=3,Y.get("/jobs/".concat(a.id,"/logs"));case 3:1===(n=t.sent).code&&e.setState({logPending:!1,logs:n.data,selectedRow:a});case 5:case"end":return t.stop()}}),t)}))),children:"\u65e5\u5fd7"})},"2"),Object(N.jsx)(b.a.Divider,{}),Object(N.jsx)(b.a.Item,{children:Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})},"3")]});return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].execLoading,onClick:Object(o.a)(Object(i.a)().mark((function t(){var s,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.items)[n].execLoading=!0,e.setState({items:s}),t.next=5,Y.post("/jobs/".concat(a.id,"/exec"));case 5:if(1!==(r=t.sent).code){t.next=12;break}return z.b.success("\u6267\u884c\u6210\u529f"),t.next=10,e.loadTableData();case 10:t.next=15;break;case 12:z.b.error(r.message),s[n].execLoading=!1,e.setState({items:s});case 15:case"end":return t.stop()}}),t)}))),children:"\u6267\u884c"}),Object(N.jsx)(m.a,{overlay:s,children:Object(N.jsxs)(O.a,{type:"link",size:"small",children:["\u66f4\u591a ",Object(N.jsx)(Te.a,{})]})})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(vs,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(ys,{level:3,children:"\u4efb\u52a1\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(ks,{ref:this.inputRefOfName,placeholder:"\u4efb\u52a1\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:"",content:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u8ba1\u5212\u4efb\u52a1",{})}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(ws,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});gs({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(fs,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):void 0,this.state.logVisible?Object(N.jsx)(te.a,{className:"modal-no-padding",width:.8*window.innerWidth,title:"\u65e5\u5fd7",visible:!0,maskClosable:!1,onOk:Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.delete("/jobs/".concat(e.state.selectedRow.id,"/logs"));case 2:1===(a=t.sent).code?(e.setState({logVisible:!1,selectedRow:void 0}),z.b.success("\u65e5\u5fd7\u6e05\u7a7a\u6210\u529f")):z.b.error(a.message,10);case 4:case"end":return t.stop()}}),t)}))),onCancel:function(){e.setState({logVisible:!1,selectedRow:void 0})},okText:"\u6e05\u7a7a",okType:"danger",cancelText:"\u53d6\u6d88",children:Object(N.jsx)(Qt.a,{tip:"\u52a0\u8f7d\u4e2d...",spinning:this.state.logPending,children:Object(N.jsx)("pre",{className:"cron-log",children:this.state.logs.map((function(e){return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(le.a,{orientation:"left",style:{color:"white"},children:e.timestamp}),e.message]})}))})})}):void 0]})})}}]),a}(n.Component),Cs=Ss,Is=a(181),Ts={labelCol:{span:6},wrapperCol:{span:14}},Ps=function(e){var t=e.title,a=e.visible,n=e.handleOk,s=e.handleCancel,r=e.confirmLoading,c=e.model,l=Oe.Form.useForm(),d=Object(me.a)(l,1)[0];return void 0===c.priority&&(c.priority=1),Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){d.validateFields().then((function(e){d.resetFields(),n(e)})).catch((function(e){}))},onCancel:s,confirmLoading:r,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:d},Ts),{},{initialValues:c,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"IP\u5730\u5740",name:"ip",rules:[{required:!0,message:"\u8bf7\u8f93\u5165IP\u5730\u5740"}],children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u652f\u6301\u5355\u4e2aIP\uff0cCIDR\u6216\u4f7f\u7528-\u8fde\u63a5\u7684\u4e24\u4e2aIP"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u89c4\u5219",name:"rule",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u89c4\u5219"}],children:Object(N.jsxs)(Oe.Radio.Group,{onChange:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(N.jsx)(Oe.Radio,{value:"allow",children:"\u5141\u8bb8"}),Object(N.jsx)(Oe.Radio,{value:"reject",children:"\u62d2\u7edd"})]})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4f18\u5148\u7ea7",name:"priority",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4f18\u5148\u7ea7"}],tooltip:"\u6570\u5b57\u8d8a\u5c0f\u4ee3\u8868\u4f18\u5148\u7ea7\u8d8a\u9ad8",children:Object(N.jsx)(Oe.InputNumber,{min:1,max:100})})]}))})},Rs=te.a.confirm,Fs=h.a.Content,qs=ne.a.Title,Ds=ne.a.Text,zs=ae.a.Search,Ns=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,selectedRow:void 0,selectedRowKeys:[]},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),!a.id){t.next=8;break}return t.next=4,Y.put("/securities/"+a.id,a);case 4:1===(n=t.sent).code?(z.b.success("\u66f4\u65b0\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u66f4\u65b0\u5931\u8d25 :( "+n.message,10),t.next=12;break;case 8:return t.next=10,Y.post("/securities",a);case 10:1===(s=t.sent).code?(z.b.success("\u65b0\u589e\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u65b0\u589e\u5931\u8d25 :( "+s.message,10);case 12:e.setState({modalConfirmLoading:!1});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/securities/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/securities/"+t);case 2:1===(a=e.sent).code?(z.b.success("\u5220\u9664\u6210\u529f"),this.loadTableData(this.state.queryParams)):z.b.error(a.message,10);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/securities/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;Rs({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4efb\u52a1\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"showModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.setState({modalTitle:e,modalVisible:!0,model:t})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"IP",dataIndex:"ip",key:"ip",sorter:!0},{title:"\u89c4\u5219",dataIndex:"rule",key:"rule",render:function(e){return"allow"===e?Object(N.jsx)(re.a,{color:"green",children:"\u5141\u8bb8"}):Object(N.jsx)(re.a,{color:"red",children:"\u7981\u6b62"})}},{title:"\u4f18\u5148\u7ea7",dataIndex:"priority",key:"priority",sorter:!0},{title:"\u6765\u6e90",dataIndex:"source",key:"source"},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].execLoading,onClick:function(){return e.showModal("\u66f4\u65b0",a)},children:"\u7f16\u8f91"}),Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Fs,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(qs,{level:3,children:"IP\u8bbf\u95ee\u89c4\u5219\u5217\u8868"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(zs,{ref:this.inputRefOfName,placeholder:"IP",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:"",content:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u5b89\u5168\u8bbf\u95ee\u89c4\u5219",{})}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(Ds,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});Rs({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(Ps,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):void 0]})})}}]),a}(n.Component),Ls=Ns,Vs=a(676),Bs=a(1303),Ms=a(1304),Ks={labelCol:{span:6},wrapperCol:{span:14}},As=function(e){var t=e.title,a=e.visible,n=e.handleOk,s=e.handleCancel,r=e.confirmLoading,c=e.model,i=Oe.Form.useForm(),o=Object(me.a)(i,1)[0];return c||(c={isShare:!1}),Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){o.validateFields().then((function(e){o.resetFields(),n(e)})).catch((function(e){}))},onCancel:s,confirmLoading:r,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:o},Ks),{},{initialValues:c,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u7f51\u76d8\u7684\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u662f\u5426\u5171\u4eab",name:"isShare",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u5171\u4eab"}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u662f",unCheckedChildren:"\u5426"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u5927\u5c0f\u9650\u5236",name:"limitSize",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5927\u5c0f\u9650\u5236"}],tooltip:"\u65e0\u9650\u5236\u8bf7\u586b\u5199-1",children:Object(N.jsx)(Oe.Input,{type:"number",min:-1,suffix:"MB"})})]}))})},Ws=h.a.Content,Es=ne.a.Title,Us=ae.a.Search,Hs=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.storageRef=void 0,e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,selectedRow:void 0,fileSystemVisible:!1,storageId:void 0},e.onRef=function(t){e.storageRef=t},e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),!a.id){t.next=9;break}return a.limitSize=1024*parseInt(a.limitSize)*1024,t.next=5,Y.put("/storages/"+a.id,a);case 5:1===(n=t.sent).code?(z.b.success("\u66f4\u65b0\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u66f4\u65b0\u5931\u8d25 :( "+n.message,10),t.next=14;break;case 9:return a.limitSize=1024*parseInt(a.limitSize)*1024,t.next=12,Y.post("/storages",a);case 12:1===(s=t.sent).code?(z.b.success("\u65b0\u589e\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u65b0\u589e\u5931\u8d25 :( "+s.message,10);case 14:e.setState({modalConfirmLoading:!1});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/storages/"+t);case 2:1===(a=e.sent).code?(z.b.success("\u5220\u9664\u6210\u529f"),this.loadTableData(this.state.queryParams)):z.b.error(a.message,10);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/storages/paging?".concat(a));case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,this.setState({items:n.items,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[4,11,13,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.setState({modalTitle:e,modalVisible:!0,model:t})}},{key:"render",value:function(){var e=this;return Object(N.jsxs)("div",{children:[Object(N.jsx)(Ws,{className:"site-layout-background page-content",children:Object(N.jsx)("div",{children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(Es,{level:3,children:"\u78c1\u76d8\u7a7a\u95f4"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(Us,{ref:this.inputRefOfName,placeholder:"\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:"",content:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u78c1\u76d8\u7a7a\u95f4")}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})})]})},2)]})})}),Object(N.jsx)("div",{style:{margin:"0 16px"},children:Object(N.jsx)($n.b,{loading:this.state.loading,grid:{gutter:16,column:4},dataSource:this.state.items,renderItem:function(t){var a;return a=t.isDefault?Object(N.jsx)(De.a,{className:"disabled-icon"},"delete"):Object(N.jsx)(p.a,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u7a7a\u95f4\u5417?",onConfirm:function(){e.delete(t.id)},okText:"\u662f",cancelText:"\u5426",children:Object(N.jsx)(De.a,{},"delete")}),Object(N.jsx)($n.b.Item,{children:Object(N.jsx)(w.a,{title:t.name,hoverable:!0,actions:[Object(N.jsx)(st.a,{onClick:function(){e.setState({fileSystemVisible:!0,storageId:t.id}),e.storageRef&&e.storageRef.reSetStorageId(t.id)}},"file"),Object(N.jsx)(Vs.a,{onClick:function(){var a=K(t);a.limitSize>0&&(a.limitSize=a.limitSize/1024/1024),e.showModal("\u4fee\u6539\u78c1\u76d8\u7a7a\u95f4",a)}},"edit"),a],children:Object(N.jsxs)(It.b,{title:"",column:1,children:[Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(kn.a,{})," \u662f\u5426\u5171\u4eab"]}),children:Object(N.jsx)("strong",{children:t.isShare?"\u662f":"\u5426"})}),Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(vn.a,{})," \u662f\u5426\u9ed8\u8ba4"]}),children:Object(N.jsx)("strong",{children:t.isDefault?"\u662f":"\u5426"})}),Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(Bs.a,{})," \u5927\u5c0f\u9650\u5236"]}),children:Object(N.jsx)("strong",{children:t.limitSize<0?"\u65e0\u9650\u5236":J(t.limitSize)})}),Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(Ms.a,{})," \u5df2\u7528\u5927\u5c0f"]}),children:Object(N.jsx)("strong",{children:J(t.usedSize)})}),Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(S.a,{})," \u6240\u5c5e\u7528\u6237"]}),children:Object(N.jsx)("strong",{children:t.ownerName})})]})})})}})}),Object(N.jsx)(et.a,{title:"\u6587\u4ef6\u7ba1\u7406",placement:"right",width:.8*window.innerWidth,closable:!0,maskClosable:!0,onClose:function(){e.setState({fileSystemVisible:!1}),e.loadTableData(e.state.queryParams)},visible:this.state.fileSystemVisible,children:Object(N.jsx)(Ct,{storageId:this.state.storageId,storageType:"storages",onRef:this.onRef,upload:!0,download:!0,delete:!0,rename:!0,edit:!0,minHeight:window.innerHeight-103})}),this.state.modalVisible?Object(N.jsx)(As,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:function(){e.setState({modalTitle:"",modalVisible:!1})},confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):void 0]})}}]),a}(n.Component),Gs=Hs,Js=h.a.Content,Xs=ne.a.Title,$s=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={storage:{}},e.getDefaultStorage=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.get("/account/storage");case 2:if(1===(a=t.sent).code){t.next=6;break}return z.b.error(a.message),t.abrupt("return");case 6:e.setState({storage:a.data});case 7:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.getDefaultStorage()}},{key:"render",value:function(){var e=this.state.storage,t=Me()?"page-content":"page-content-user";return Object(N.jsx)("div",{children:Object(N.jsxs)(Js,{className:["site-layout-background",t],children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:16,children:Object(N.jsx)(Xs,{level:3,children:"\u6211\u7684\u6587\u4ef6"})},1),Object(N.jsx)(y.a,{span:8,style:{textAlign:"right"},children:Object(N.jsxs)(It.b,{title:"",column:2,children:[Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(Bs.a,{})," \u5927\u5c0f\u9650\u5236"]}),children:Object(N.jsx)("strong",{children:e.limitSize<0?"\u65e0\u9650\u5236":J(e.limitSize)})}),Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(Ms.a,{})," \u5df2\u7528\u5927\u5c0f"]}),children:Object(N.jsx)("strong",{children:J(e.usedSize)})})]})},2)]})}),Object(N.jsx)(Ct,{storageId:Ke().id,storageType:"storages",callback:this.getDefaultStorage,upload:!0,download:!0,delete:!0,rename:!0,edit:!0,minHeight:window.innerHeight-203})]},"page-content")})}}]),a}(n.Component),Ys=$s,_s={labelCol:{span:6},wrapperCol:{span:14}},Zs=function(e){var t=e.title,a=e.visible,n=e.handleOk,s=e.handleCancel,r=e.confirmLoading,c=e.model,i=Oe.Form.useForm(),o=Object(me.a)(i,1)[0];return void 0===c&&(c={upload:!1,download:!1,delete:!1,rename:!1,edit:!1,copy:!1,paste:!1}),Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){o.validateFields().then((function(e){o.resetFields(),n(e)}))},onCancel:s,confirmLoading:r,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:o},_s),{},{initialValues:c,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{autoComplete:"off",placeholder:"\u6388\u6743\u7b56\u7565\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4e0a\u4f20",name:"upload",rules:[{required:!0}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4e0b\u8f7d",name:"download",rules:[{required:!0}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7f16\u8f91",name:"edit",rules:[{required:!0}],valuePropName:"checked",tooltip:"\u7f16\u8f91\u9700\u8981\u5148\u5f00\u542f\u4e0b\u8f7d",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u5220\u9664",name:"delete",rules:[{required:!0}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u91cd\u547d\u540d",name:"rename",rules:[{required:!0}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u590d\u5236",name:"copy",rules:[{required:!0}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7c98\u8d34",name:"paste",rules:[{required:!0}],valuePropName:"checked",children:Object(N.jsx)(Oe.Switch,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})})]}))})},Qs=te.a.confirm,er=h.a.Content,tr=ne.a.Title,ar=ne.a.Text,nr=ae.a.Search,sr=["upload","download","delete","rename","edit","copy","paste"],rr=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,selectedRow:void 0,selectedRowKeys:[]},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s,r,c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({modalConfirmLoading:!0}),n=0;case 2:if(!(n<sr.length)){t.next=10;break}if(s=sr[n],a.hasOwnProperty(s)){t.next=6;break}return t.abrupt("continue",7);case 6:!0===a[s]?a[s]="1":a[s]="0";case 7:n++,t.next=2;break;case 10:if(!a.id){t.next=17;break}return t.next=13,Y.put("/strategies/"+a.id,a);case 13:1===(r=t.sent).code?(z.b.success("\u66f4\u65b0\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u66f4\u65b0\u5931\u8d25 :( "+r.message,10),t.next=21;break;case 17:return t.next=19,Y.post("/strategies",a);case 19:1===(c=t.sent).code?(z.b.success("\u65b0\u589e\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u65b0\u589e\u5931\u8d25 :( "+c.message,10);case 21:e.setState({modalConfirmLoading:!1});case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/strategies/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/strategies/"+t);case 2:1===(a=e.sent).code?(z.b.success("\u5220\u9664\u6210\u529f"),this.loadTableData(this.state.queryParams)):z.b.error(a.message,10);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/strategies/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;Qs({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4efb\u52a1\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"showModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=t;if(a){a=K(t);for(var n=0;n<sr.length;n++){var s=sr[n];a.hasOwnProperty(s)&&(a[s]="1"===a[s])}}this.setState({modalTitle:e,modalVisible:!0,model:a})}},{key:"render",value:function(){var e=this,t=function(e){return"1"===e?Object(N.jsx)(re.a,{color:"green",children:"\u5f00\u542f"}):Object(N.jsx)(re.a,{color:"red",children:"\u5173\u95ed"})},a=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u540d\u79f0",dataIndex:"name",key:"name",sorter:!0},{title:"\u4e0a\u4f20",dataIndex:"upload",key:"upload",render:function(e){return t(e)}},{title:"\u4e0b\u8f7d",dataIndex:"download",key:"download",render:function(e){return t(e)}},{title:"\u7f16\u8f91",dataIndex:"edit",key:"edit",render:function(e){return t(e)}},{title:"\u5220\u9664",dataIndex:"delete",key:"delete",render:function(e){return t(e)}},{title:"\u91cd\u547d\u540d",dataIndex:"rename",key:"rename",render:function(e){return t(e)}},{title:"\u590d\u5236",dataIndex:"copy",key:"copy",render:function(e){return t(e)}},{title:"\u7c98\u8d34",dataIndex:"paste",key:"paste",render:function(e){return t(e)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created",key:"created"},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].execLoading,onClick:function(){return e.showModal("\u66f4\u65b0\u6388\u6743\u7b56\u7565",a)},children:"\u7f16\u8f91"}),Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})]})}}],n=this.state.selectedRowKeys,s={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},r=n.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(er,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(tr,{level:3,children:"\u6388\u6743\u7b56\u7565"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(nr,{ref:this.inputRefOfName,placeholder:"\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:"",content:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u6388\u6743\u7b56\u7565")}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!r,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(ar,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});Qs({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:s,dataSource:this.state.items,columns:a,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(Zs,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):void 0]})})}}]),a}(n.Component),cr=rr,ir={labelCol:{span:6},wrapperCol:{span:14}},or=Oe.Input.TextArea,lr=function(e){var t=e.title,a=e.visible,s=e.handleOk,r=e.handleCancel,c=e.confirmLoading,i=e.model,o=Oe.Form.useForm(),l=Object(me.a)(o,1)[0];void 0===i.accountType&&(i.accountType="password"),void 0===i.port&&(i.port=22);var d=Object(n.useState)(i.accountType),u=Object(me.a)(d,2),j=u[0],h=u[1];return Object(N.jsx)(Oe.Modal,{title:t,visible:a,maskClosable:!1,onOk:function(){l.validateFields().then((function(e){l.resetFields(),s(e)}))},onCancel:r,confirmLoading:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(N.jsxs)(Oe.Form,Object(g.a)(Object(g.a)({form:l},ir),{},{initialValues:i,children:[Object(N.jsx)(Oe.Form.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(Oe.Input,{hidden:!0})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7f51\u5173\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7f51\u5173\u540d\u79f0"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u7f51\u5173\u540d\u79f0"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u4e3b\u673a",name:"ip",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7f51\u5173\u7684\u4e3b\u673a\u540d\u79f0\u6216\u8005IP\u5730\u5740"}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u7f51\u5173\u7684\u4e3b\u673a\u540d\u79f0\u6216\u8005IP\u5730\u5740"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u7aef\u53e3\u53f7",name:"port",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7aef\u53e3"}],children:Object(N.jsx)(Oe.InputNumber,{min:1,max:65535,placeholder:"TCP\u7aef\u53e3"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u8d26\u6237\u7c7b\u578b",name:"accountType",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u8d26\u6237\u7c7b\u578b"}],children:Object(N.jsxs)(Oe.Select,{onChange:function(e){h(e)},children:[Object(N.jsx)(Oe.Select.Option,{value:"password",children:"\u5bc6\u7801"},"password"),Object(N.jsx)(Oe.Select.Option,{value:"private-key",children:"\u5bc6\u94a5"},"private-key")]})}),"password"===j?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",rules:[{required:!0}],children:Object(N.jsx)(Oe.Input,{placeholder:"root"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u5bc6\u7801",name:"password",rules:[{required:!0}],children:Object(N.jsx)(Oe.Input.Password,{placeholder:"password"})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Oe.Form.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",rules:[{required:!0}],children:Object(N.jsx)(Oe.Input,{placeholder:"\u8f93\u5165\u6388\u6743\u8d26\u6237"})}),Object(N.jsx)(Oe.Form.Item,{label:"\u79c1\u94a5",name:"privateKey",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u79c1\u94a5"}],children:Object(N.jsx)(or,{rows:4})}),Object(N.jsx)(Oe.Form.Item,{label:"\u79c1\u94a5\u5bc6\u7801",name:"passphrase",children:Object(N.jsx)(or,{rows:1})})]})]}))})},dr=te.a.confirm,ur=h.a.Content,jr=ne.a.Title,hr=ne.a.Text,br=ae.a.Search,pr=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.inputRefOfIp=s.a.createRef(),e.state={items:[],total:0,queryParams:{pageIndex:1,pageSize:10},loading:!1,modalVisible:!1,modalTitle:"",modalConfirmLoading:!1,selectedRow:void 0,selectedRowKeys:[]},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleSearchByIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,ip:t});e.loadTableData(a)},e.handleCancelModal=function(t){e.setState({modalTitle:"",modalVisible:!1})},e.handleOk=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({modalConfirmLoading:!0}),t.prev=1,!a.id){t.next=9;break}return t.next=5,Y.put("/access-gateways/"+a.id,a);case 5:1===(n=t.sent).code?(z.b.success("\u66f4\u65b0\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u66f4\u65b0\u5931\u8d25 :( "+n.message,10),t.next=13;break;case 9:return t.next=11,Y.post("/access-gateways",a);case 11:1===(s=t.sent).code?(z.b.success("\u65b0\u589e\u6210\u529f"),e.setState({modalVisible:!1}),e.loadTableData(e.state.queryParams)):z.b.error("\u65b0\u589e\u5931\u8d25 :( "+s.message,10);case 13:return t.prev=13,e.setState({modalConfirmLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])})));return function(e){return t.apply(this,arguments)}}(),e.batchDelete=Object(o.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({delBtnLoading:!0}),t.prev=1,t.next=4,Y.delete("/access-gateways/"+e.state.selectedRowKeys.join(","));case 4:if(1!==(a=t.sent).code){t.next=12;break}return z.b.success("\u64cd\u4f5c\u6210\u529f",3),e.setState({selectedRowKeys:[]}),t.next=10,e.loadTableData(e.state.queryParams);case 10:t.next=13;break;case 12:z.b.error(a.message,10);case 13:return t.prev=13,e.setState({delBtnLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,,13,16]])}))),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadTableData()}},{key:"delete",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.delete("/access-gateways/"+t);case 2:1===(a=e.sent).code?(z.b.success("\u5220\u9664\u6210\u529f"),this.loadTableData(this.state.queryParams)):z.b.error(a.message,10);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/access-gateways/paging?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showDeleteConfirm",value:function(e,t){var a=this;dr({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4efb\u52a1\u5417?",content:t,okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.delete(e)}})}},{key:"update",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/access-gateways/".concat(t));case 2:if(1===(a=e.sent).code){e.next=6;break}return z.b.error(a.message,10),e.abrupt("return");case 6:return e.next=8,this.showModal("\u66f4\u65b0\u63a5\u5165\u7f51\u5173",a.data);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reconnect",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a){var n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.items,e.prev=1,n[a].reconnectLoading=!0,this.setState({items:n}),z.b.info({content:"\u6b63\u5728\u91cd\u8fde\u4e2d...",key:t,duration:5}),e.next=7,Y.post("/access-gateways/".concat(t,"/reconnect"));case 7:if(1===(s=e.sent).code){e.next=11;break}return z.b.error({content:s.message,key:t,duration:10}),e.abrupt("return");case 11:z.b.success({content:"\u91cd\u8fde\u5b8c\u6210\u3002",key:t,duration:3}),this.loadTableData(this.state.queryParams);case 13:return e.prev=13,n[a].reconnectLoading=!1,this.setState({items:n}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[1,,13,17]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"showModal",value:function(e,t){this.setState({modalTitle:e,modalVisible:!0,model:t})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",render:function(e,t,a){return a+1}},{title:"\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a){var n=t;return n&&n.length>20&&(n=n.substring(0,20)+" ..."),Be(a.owner)?Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){return e.update(a.id)},children:Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:n})}):Object(N.jsx)(se.a,{placement:"topLeft",title:t,children:n})},sorter:!0},{title:"IP",dataIndex:"ip",key:"ip",sorter:!0},{title:"\u7aef\u53e3",dataIndex:"port",key:"port"},{title:"\u8d26\u6237\u7c7b\u578b",dataIndex:"accountType",key:"accountType",render:function(e){return"private-key"===e?Object(N.jsx)(re.a,{color:"green",children:"\u5bc6\u94a5"}):Object(N.jsx)(re.a,{color:"red",children:"\u5bc6\u7801"})}},{title:"\u6388\u6743\u8d26\u6237",dataIndex:"username",key:"username"},{title:"\u72b6\u6001",dataIndex:"connected",key:"connected",render:function(e,t){return e?Object(N.jsx)(se.a,{title:"\u8fde\u63a5\u6210\u529f",children:Object(N.jsx)(ce.a,{status:"success",text:"\u5df2\u8fde\u63a5"})}):Object(N.jsx)(se.a,{title:t.message,children:Object(N.jsx)(ce.a,{status:"error",text:"\u5df2\u65ad\u5f00"})})}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created",key:"created",render:function(e,t){return Object(N.jsx)(se.a,{title:e,children:Ie()(e).fromNow()})},sorter:!0},{title:"\u64cd\u4f5c",key:"action",render:function(t,a,n){return Object(N.jsxs)("div",{children:[Object(N.jsx)(O.a,{type:"link",size:"small",onClick:function(){return e.update(a.id)},children:"\u7f16\u8f91"}),Object(N.jsx)(O.a,{type:"link",size:"small",loading:e.state.items[n].reconnectLoading,onClick:function(){return e.reconnect(a.id,n)},children:"\u91cd\u8fde"}),Object(N.jsx)(O.a,{type:"text",size:"small",danger:!0,onClick:function(){return e.showDeleteConfirm(a.id,a.name)},children:"\u5220\u9664"})]})}}],a=this.state.selectedRowKeys,n={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t})}},s=a.length>0;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(ur,{className:"site-layout-background page-content",children:[Object(N.jsx)("div",{style:{marginBottom:20},children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(jr,{level:3,children:"\u63a5\u5165\u7f51\u5173"})},1),Object(N.jsx)(y.a,{span:12,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(br,{ref:this.inputRefOfName,placeholder:"\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName}),Object(N.jsx)(br,{ref:this.inputRefOfIp,placeholder:"IP",allowClear:!0,onSearch:this.handleSearchByIp}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.inputRefOfIp.current.setValue(""),e.loadTableData({pageIndex:1,pageSize:10,name:"",ip:"",content:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u65b0\u589e",children:Object(N.jsx)(O.a,{type:"dashed",icon:Object(N.jsx)(Fe.a,{}),onClick:function(){return e.showModal("\u65b0\u589e\u63a5\u5165\u7f51\u5173",{})}})}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})}),Object(N.jsx)(se.a,{title:"\u6279\u91cf\u5220\u9664",children:Object(N.jsx)(O.a,{type:"primary",danger:!0,disabled:!s,icon:Object(N.jsx)(De.a,{}),loading:this.state.delBtnLoading,onClick:function(){var t=Object(N.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",Object(N.jsx)(hr,{style:{color:"#1890FF"},strong:!0,children:e.state.selectedRowKeys.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});dr({icon:Object(N.jsx)(ze.a,{}),content:t,onOk:function(){e.batchDelete()},onCancel:function(){}})}})})]})},2)]})}),Object(N.jsx)(de.a,{rowSelection:n,dataSource:this.state.items,columns:t,position:"both",pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")}},loading:this.state.loading,onChange:this.handleTableChange}),this.state.modalVisible?Object(N.jsx)(lr,{visible:this.state.modalVisible,title:this.state.modalTitle,handleOk:this.handleOk,handleCancel:this.handleCancelModal,confirmLoading:this.state.modalConfirmLoading,model:this.state.model}):void 0]})})}}]),a}(n.Component),mr=pr,Or=a(251),xr=a(1305),fr=h.a.Content,gr=ne.a.Title,vr=ae.a.Search,yr=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).inputRefOfName=s.a.createRef(),e.inputRefOfIp=s.a.createRef(),e.state={items:[],tags:[],queryParams:{pageIndex:1,pageSize:8,protocol:"",tags:""},loading:!1},e.handleSearchByName=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,name:t});e.loadTableData(a)},e.handleSearchByIp=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,ip:t});e.loadTableData(a)},e.handleTagsChange=function(t){e.setState({selectedTags:t});var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,tags:t.join(",")});e.loadTableData(a)},e.handleSearchByProtocol=function(t){var a=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{pageIndex:1,pageSize:e.state.queryParams.pageSize,protocol:t});e.loadTableData(a)},e.handleChangPage=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a,n){var s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=e.state.queryParams).pageIndex=a,s.pageSize=n,e.setState({queryParams:s}),t.next=6,e.loadTableData(s);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleTableChange=function(t,a,n){var s=Object(g.a)(Object(g.a)({},e.state.queryParams),{},{order:n.order,field:n.field});e.loadTableData(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadTableData(),e.next=3,Y.get("/tags");case 3:1===(t=e.sent).code&&this.setState({tags:t.data});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadTableData",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var a,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t=t||this.state.queryParams,a=pe.a.stringify(t),n={items:[],total:0},e.prev=4,e.next=7,Y.get("/account/assets?"+a);case 7:1===(s=e.sent).code?n=s.data:z.b.error(s.message),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.prev=13,r=n.items.map((function(e){return Object(g.a)({key:e.id},e)})),this.setState({items:r,total:n.total,queryParams:t,loading:!1}),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[4,11,13,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"renderTags",value:function(e){for(var t=[],a=e.split(","),n=0;n<a.length;n++)"-"!==e[n]&&t.push(Object(N.jsx)(re.a,{children:a[n]},a[n]));return t}},{key:"render",value:function(){var e=this;return Object(N.jsxs)("div",{style:{marginTop:20},children:[Object(N.jsx)(fr,{style:{background:"white",padding:24},children:Object(N.jsx)("div",{children:Object(N.jsxs)(v.a,{justify:"space-around",align:"middle",gutter:24,children:[Object(N.jsx)(y.a,{span:4,children:Object(N.jsx)(gr,{level:3,children:"\u6211\u7684\u8d44\u4ea7"})},1),Object(N.jsx)(y.a,{span:20,style:{textAlign:"right"},children:Object(N.jsxs)(ie.b,{children:[Object(N.jsx)(vr,{ref:this.inputRefOfName,placeholder:"\u8d44\u4ea7\u540d\u79f0",allowClear:!0,onSearch:this.handleSearchByName,style:{width:200}}),Object(N.jsx)(oe.a,{mode:"multiple",allowClear:!0,value:this.state.selectedTags,placeholder:"\u8d44\u4ea7\u6807\u7b7e",onChange:this.handleTagsChange,style:{minWidth:150},children:this.state.tags.map((function(e){if("-"!==e)return Object(N.jsx)(oe.a.Option,{children:e},e)}))}),Object(N.jsxs)(oe.a,{onChange:this.handleSearchByProtocol,value:this.state.queryParams.protocol?this.state.queryParams.protocol:"",style:{width:100},children:[Object(N.jsx)(oe.a.Option,{value:"",children:"\u5168\u90e8\u534f\u8bae"}),Object(N.jsx)(oe.a.Option,{value:"rdp",children:"rdp"}),Object(N.jsx)(oe.a.Option,{value:"ssh",children:"ssh"}),Object(N.jsx)(oe.a.Option,{value:"vnc",children:"vnc"}),Object(N.jsx)(oe.a.Option,{value:"telnet",children:"telnet"}),Object(N.jsx)(oe.a.Option,{value:"kubernetes",children:"kubernetes"})]}),Object(N.jsx)(se.a,{title:"\u91cd\u7f6e\u67e5\u8be2",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(Pe.a,{}),onClick:function(){e.inputRefOfName.current.setValue(""),e.inputRefOfIp.current.setValue(""),e.setState({selectedTags:[]}),e.loadTableData({pageIndex:1,pageSize:10,protocol:"",tags:""})}})}),Object(N.jsx)(le.a,{type:"vertical"}),Object(N.jsx)(se.a,{title:"\u5237\u65b0\u5217\u8868",children:Object(N.jsx)(O.a,{icon:Object(N.jsx)(qe.a,{}),onClick:function(){e.loadTableData(e.state.queryParams)}})})]})},2)]})})}),Object(N.jsx)("div",{style:{marginTop:20},children:Object(N.jsx)($n.b,{loading:this.state.loading,grid:{gutter:16,column:4},dataSource:this.state.items,pagination:{showSizeChanger:!0,current:this.state.queryParams.pageIndex,pageSize:this.state.queryParams.pageSize,onChange:this.handleChangPage,onShowSizeChange:this.handleChangPage,total:this.state.total,showTotal:function(e){return"\u603b\u8ba1 ".concat(e," \u6761")},pageSizeOptions:[8,16,32,64,128]},renderItem:function(t){var a=t.id,n=t.protocol,s=t.name,r=t.sshMode,c="";return c="ssh"===n&&"native"===r?"#/term?assetId=".concat(a,"&assetName=").concat(s):"#/access?assetId=".concat(a,"&assetName=").concat(s,"&protocol=").concat(n),Object(N.jsx)($n.b.Item,{children:Object(N.jsx)("a",{target:"_blank",href:c,rel:"noreferrer noopener",children:Object(N.jsx)(w.a,{title:t.name,hoverable:!0,extra:t.active?Object(N.jsx)(re.a,{icon:Object(N.jsx)(Or.a,{}),color:"success",children:"\u8fd0\u884c\u4e2d"}):Object(N.jsx)(re.a,{icon:Object(N.jsx)(ze.a,{}),color:"error",children:"\u4e0d\u53ef\u7528"}),actions:[],children:Object(N.jsxs)(It.b,{title:"",column:1,children:[Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(rt.a,{})," \u8d44\u4ea7\u534f\u8bae"]}),children:Object(N.jsx)("strong",{children:t.protocol})}),Object(N.jsx)(It.b.Item,{label:Object(N.jsxs)("div",{children:[Object(N.jsx)(xr.a,{})," \u6807\u7b7e"]}),children:Object(N.jsx)("strong",{children:e.renderTags(t.tags)})})]})})})})}})})]})}}]),a}(n.Component),wr=yr,kr=h.a.Footer,Sr=h.a.Content,Cr=h.a.Sider,Ir=b.a.SubMenu,Tr=function(e){Object(u.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={collapsed:!1,current:sessionStorage.getItem("current"),openKeys:sessionStorage.getItem("openKeys")?JSON.parse(sessionStorage.getItem("openKeys")):[],user:{nickname:"\u672a\u5b9a\u4e49"},package:U(),triggerMenu:!0,logo:dn,logoWidth:140},e.onCollapse=function(){var t=!e.state.collapsed;t?e.setState({logo:un,logoWidth:46,collapsed:t}):e.setState({logo:dn,logoWidth:140,collapsed:t})},e.updateUser=function(t){e.setState({user:t})},e.setCurrent=function(t){e.setState({current:t}),sessionStorage.setItem("current",t)},e.subMenuChange=function(t){e.setState({openKeys:t}),sessionStorage.setItem("openKeys",JSON.stringify(t))},e.confirm=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.post("/account/logout");case 2:1!==(t=e.sent).code?z.b.error(t.message):(z.b.success("\u9000\u51fa\u767b\u5f55\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u767b\u5f55\u9875\u9762\u3002"),window.location.reload());case 4:case"end":return e.stop()}}),e)}))),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=window.location.hash.replace("#/","");E(e)&&(e="dashboard"),this.setCurrent(e),this.getInfo()}},{key:"getInfo",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/account/info");case 2:1===(t=e.sent).code?(sessionStorage.setItem("user",JSON.stringify(t.data)),this.setState({user:t.data,triggerMenu:!0})):z.b.error(t.message);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(N.jsxs)(b.a,{children:[Object(N.jsx)(b.a.Item,{children:Object(N.jsxs)(x.b,{to:"/info",children:[Object(N.jsx)(jn.a,{})," \u4e2a\u4eba\u4e2d\u5fc3"]})}),Object(N.jsx)(b.a.Divider,{}),Object(N.jsx)(b.a.Item,{children:Object(N.jsxs)(p.a,{title:"\u60a8\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417?",onConfirm:this.confirm,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",placement:"left",children:[Object(N.jsx)(hn.a,{})," \u9000\u51fa\u767b\u5f55"]},"login-btn-pop")})]});return Object(N.jsxs)(f.c,{children:[Object(N.jsx)(f.a,{path:"/access",component:Dt}),Object(N.jsx)(f.a,{path:"/term",component:Os}),Object(N.jsx)(f.a,{path:"/login",children:Object(N.jsx)(Ba,{updateUser:this.updateUser})}),Object(N.jsx)(f.a,{path:"/",children:Object(N.jsx)(h.a,{className:"layout",style:{minHeight:"100vh"},children:Me()?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(Cr,{collapsible:!0,collapsed:this.state.collapsed,trigger:null,children:[Object(N.jsx)("div",{className:"logo",children:Object(N.jsx)("img",{src:this.state.logo,alt:"logo",width:this.state.logoWidth})}),Object(N.jsxs)(b.a,{onClick:function(t){return e.setCurrent(t.key)},selectedKeys:[this.state.current],onOpenChange:this.subMenuChange,defaultOpenKeys:this.state.openKeys,theme:"dark",mode:"inline",defaultSelectedKeys:["dashboard"],inlineCollapsed:this.state.collapsed,style:{lineHeight:"64px"},children:[Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(bn.a,{}),children:Object(N.jsx)(x.b,{to:"/",children:"\u63a7\u5236\u9762\u677f"})},"dashboard"),Object(N.jsxs)(Ir,{title:"\u8d44\u6e90\u7ba1\u7406",icon:Object(N.jsx)(pn.a,{}),children:[Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(C.a,{}),children:Object(N.jsx)(x.b,{to:"/asset",children:"\u8d44\u4ea7\u5217\u8868"})},"asset"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(I.a,{}),children:Object(N.jsx)(x.b,{to:"/credential",children:"\u6388\u6743\u51ed\u8bc1"})},"credential"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(rt.a,{}),children:Object(N.jsx)(x.b,{to:"/dynamic-command",children:"\u52a8\u6001\u6307\u4ee4"})},"dynamic-command"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(mn.a,{}),children:Object(N.jsx)(x.b,{to:"/access-gateway",children:"\u63a5\u5165\u7f51\u5173"})},"access-gateway")]},"resource"),Object(N.jsxs)(Ir,{title:"\u4f1a\u8bdd\u5ba1\u8ba1",icon:Object(N.jsx)(On.a,{}),children:[Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(T.a,{}),children:Object(N.jsx)(x.b,{to:"/online-session",children:"\u5728\u7ebf\u4f1a\u8bdd"})},"online-session"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(Zt.a,{}),children:Object(N.jsx)(x.b,{to:"/offline-session",children:"\u5386\u53f2\u4f1a\u8bdd"})},"offline-session")]},"audit"),Object(N.jsxs)(Ir,{title:"\u7cfb\u7edf\u8fd0\u7ef4",icon:Object(N.jsx)(xn.a,{}),children:[Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(fn.a,{}),children:Object(N.jsx)(x.b,{to:"/login-log",children:"\u767b\u5f55\u65e5\u5fd7"})},"login-log"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(gn.a,{}),children:Object(N.jsx)(x.b,{to:"/job",children:"\u8ba1\u5212\u4efb\u52a1"})},"job"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(vn.a,{}),children:Object(N.jsx)(x.b,{to:"/access-security",children:"\u8bbf\u95ee\u5b89\u5168"})},"access-security"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(yn.a,{}),children:Object(N.jsx)(x.b,{to:"/storage",children:"\u78c1\u76d8\u7a7a\u95f4"})},"storage")]},"ops"),Object(N.jsxs)(Ir,{title:"\u7528\u6237\u7ba1\u7406",icon:Object(N.jsx)(wn.a,{}),children:[Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(S.a,{}),children:Object(N.jsx)(x.b,{to:"/user",children:"\u7528\u6237\u7ba1\u7406"})},"user"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(kn.a,{}),children:Object(N.jsx)(x.b,{to:"/user-group",children:"\u7528\u6237\u7ec4\u7ba1\u7406"})},"user-group"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(Lt.a,{}),children:Object(N.jsx)(x.b,{to:"/strategy",children:"\u6388\u6743\u7b56\u7565"})},"strategy")]},"user-manage"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(st.a,{}),children:Object(N.jsx)(x.b,{to:"/my-file",children:"\u6211\u7684\u6587\u4ef6"})},"my-file"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(jn.a,{}),children:Object(N.jsx)(x.b,{to:"/info",children:"\u4e2a\u4eba\u4e2d\u5fc3"})},"info"),Object(N.jsx)(b.a.Item,{icon:Object(N.jsx)(Sn.a,{}),children:Object(N.jsx)(x.b,{to:"/setting",children:"\u7cfb\u7edf\u8bbe\u7f6e"})},"setting")]})]}),Object(N.jsxs)(h.a,{className:"site-layout",children:[Object(N.jsx)(Is.c,{className:"site-layout-background",style:{padding:0,height:60,zIndex:20},children:Object(N.jsxs)("div",{className:"layout-header",children:[Object(N.jsx)("div",{className:"layout-header-left",children:s.a.createElement(this.state.collapsed?Cn.a:In.a,{className:"trigger",onClick:this.onCollapse})}),Object(N.jsx)("div",{className:"layout-header-right",children:Object(N.jsx)(m.a,{overlay:t,children:Object(N.jsxs)("div",{className:"nickname layout-header-right-item",children:[Ke().nickname," \xa0",Object(N.jsx)(Te.a,{})]})})})]})}),Object(N.jsx)(f.a,{path:"/",exact:!0,component:ee}),Object(N.jsx)(f.a,{path:"/user",component:_t}),Object(N.jsx)(f.a,{path:"/user-group",component:os}),Object(N.jsx)(f.a,{path:"/asset",component:Ye}),Object(N.jsx)(f.a,{path:"/credential",component:ln}),Object(N.jsx)(f.a,{path:"/dynamic-command",component:Za}),Object(N.jsx)(f.a,{path:"/batch-command",component:es}),Object(N.jsx)(f.a,{path:"/online-session",component:pa}),Object(N.jsx)(f.a,{path:"/offline-session",component:qa}),Object(N.jsx)(f.a,{path:"/login-log",component:ps}),Object(N.jsx)(f.a,{path:"/info",component:Bn}),Object(N.jsx)(f.a,{path:"/setting",component:Xn}),Object(N.jsx)(f.a,{path:"/job",component:Cs}),Object(N.jsx)(f.a,{path:"/access-security",component:Ls}),Object(N.jsx)(f.a,{path:"/access-gateway",component:mr}),Object(N.jsx)(f.a,{path:"/my-file",component:Ys}),Object(N.jsx)(f.a,{path:"/storage",component:Gs}),Object(N.jsx)(f.a,{path:"/strategy",component:cr}),Object(N.jsxs)(kr,{style:{textAlign:"center"},children:["Cloud Fort \xa92021 Version:",this.state.package.version]})]})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Is.c,{style:{padding:0},children:Object(N.jsxs)("div",{className:"km-header",children:[Object(N.jsxs)("div",{style:{flex:"1 1 0%"},children:[Object(N.jsx)(x.b,{to:"/",children:Object(N.jsx)("img",{src:this.state.logo,alt:"logo",width:120})}),Object(N.jsx)(x.b,{to:"/my-file",children:Object(N.jsx)(O.a,{type:"text",style:{color:"white"},icon:Object(N.jsx)(st.a,{}),children:"\u6587\u4ef6"})}),Object(N.jsx)(x.b,{to:"/dynamic-command",children:Object(N.jsx)(O.a,{type:"text",style:{color:"white"},icon:Object(N.jsx)(rt.a,{}),children:"\u6307\u4ee4"})})]}),Object(N.jsx)("div",{className:"km-header-right",children:Object(N.jsx)(m.a,{overlay:t,children:Object(N.jsx)("span",{className:"km-header-right-item",children:Ke().nickname})})})]})}),Object(N.jsx)(Sr,{className:"km-container",children:Object(N.jsxs)(h.a,{children:[Object(N.jsx)(f.a,{path:"/",exact:!0,component:wr}),Object(N.jsxs)(Sr,{className:"kd-content",children:[Object(N.jsx)(f.a,{path:"/info",component:Bn}),Object(N.jsx)(f.a,{path:"/my-file",component:Ys}),Object(N.jsx)(f.a,{path:"/dynamic-command",component:Za})]})]})}),Object(N.jsxs)(kr,{style:{textAlign:"center"},children:["Cloud Fort \xa92021 Version:",this.state.package.version]})]})})})]})}}]),a}(n.Component),Pr=Tr;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Rr=a(668),Fr=a(38),qr=a(662),Dr=a.n(qr);a(1231);Ie.a.extend(Dr.a),Ie.a.locale("zh-cn"),c.a.render(Object(N.jsx)(Fr.a,{locale:Rr.a,children:Object(N.jsx)(x.a,{children:Object(N.jsx)(Pr,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},467:function(e,t,a){},700:function(e,t,a){},702:function(e,t,a){},726:function(e){e.exports=JSON.parse('{"name":"cloud-fort","version":"1.2.7","private":true,"dependencies":{"@ant-design/charts":"^1.2.13","@ant-design/icons":"^4.6.4","antd":"^4.16.13","axios":"^0.21.4","dayjs":"^1.10.4","guacamole-common-js":"^1.4.0-a","js-base64":"^3.7.2","qs":"^6.9.4","react":"^16.14.0","react-dom":"^16.14.0","react-draggable":"^4.4.3","react-monaco-editor":"0.40.0","react-router":"^5.2.0","react-router-dom":"^5.2.0","react-scripts":"^4.0.0","xterm":"^4.9.0","xterm-addon-fit":"^0.4.0","xterm-addon-web-links":"^0.4.0"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"],"homepage":"."}')},727:function(e,t,a){},823:function(e,t){}},[[1232,1,2]]]);